<html>
    <head>
    </head>
    <body>
        <div class="large-9 columns" id="app-details-left">
            <div id="gallery">
                <ul>
                    <li class="text-center">
                        <a data-lightbox="880492" data-title="The base AutoSwap app" href="https://challengepost-s3-challengepost.netdna-ssl.com/photos/production/software_photos/000/880/492/datas/original.png">
                            <img alt="Agoric in MetaMask in Agoric &ndash; screenshot 1" class="software_photo_image image-replacement" onerror="this.onerror=null;this.src='https://devpost-challengepost.netdna-ssl.com/assets/defaults/thumbnail-placeholder-42bcab8d8178b413922ae2877d8b0868.gif';" src="//challengepost-s3-challengepost.netdna-ssl.com/photos/production/software_photos/000/880/492/datas/gallery.jpg">
                        </a>
                        <span class="expand-tag">
                            <i class="fas fa-expand">
                            </i>
                        </span>
                        <p>
                            <i>
                                The base AutoSwap app
                            </i>
                        </p>
                    </li>
                    <li class="text-center">
                        <a data-lightbox="880498" data-title="The MetaMask initial sign-in prompt, asks to install a plugin." href="https://challengepost-s3-challengepost.netdna-ssl.com/photos/production/software_photos/000/880/498/datas/original.png">
                            <img alt="Agoric in MetaMask in Agoric &ndash; screenshot 2" class="software_photo_image image-replacement" onerror="this.onerror=null;this.src='https://devpost-challengepost.netdna-ssl.com/assets/defaults/thumbnail-placeholder-42bcab8d8178b413922ae2877d8b0868.gif';" src="//challengepost-s3-challengepost.netdna-ssl.com/photos/production/software_photos/000/880/498/datas/gallery.jpg">
                        </a>
                        <span class="expand-tag">
                            <i class="fas fa-expand">
                            </i>
                        </span>
                        <p>
                            <i>
                                The MetaMask initial sign-in prompt, asks to install a plugin.
                            </i>
                        </p>
                    </li>
                    <li class="text-center">
                        <a data-lightbox="880500" data-title="The plugin then requests its own permissions." href="https://challengepost-s3-challengepost.netdna-ssl.com/photos/production/software_photos/000/880/500/datas/original.png">
                            <img alt="Agoric in MetaMask in Agoric &ndash; screenshot 3" class="software_photo_image image-replacement" onerror="this.onerror=null;this.src='https://devpost-challengepost.netdna-ssl.com/assets/defaults/thumbnail-placeholder-42bcab8d8178b413922ae2877d8b0868.gif';" src="//challengepost-s3-challengepost.netdna-ssl.com/photos/production/software_photos/000/880/500/datas/gallery.jpg">
                        </a>
                        <span class="expand-tag">
                            <i class="fas fa-expand">
                            </i>
                        </span>
                        <p>
                            <i>
                                The plugin then requests its own permissions.
                            </i>
                        </p>
                    </li>
                    <li class="text-center">
                        <a data-lightbox="880503" data-title="The AutoSwap app can then be used" href="https://challengepost-s3-challengepost.netdna-ssl.com/photos/production/software_photos/000/880/503/datas/original.png">
                            <img alt="Agoric in MetaMask in Agoric &ndash; screenshot 4" class="software_photo_image image-replacement" onerror="this.onerror=null;this.src='https://devpost-challengepost.netdna-ssl.com/assets/defaults/thumbnail-placeholder-42bcab8d8178b413922ae2877d8b0868.gif';" src="//challengepost-s3-challengepost.netdna-ssl.com/photos/production/software_photos/000/880/503/datas/gallery.jpg">
                        </a>
                        <span class="expand-tag">
                            <i class="fas fa-expand">
                            </i>
                        </span>
                        <p>
                            <i>
                                The AutoSwap app can then be used
                            </i>
                        </p>
                    </li>
                    <li class="text-center">
                        <a data-lightbox="880506" data-title="Currencies selected" href="https://challengepost-s3-challengepost.netdna-ssl.com/photos/production/software_photos/000/880/506/datas/original.png">
                            <img alt="Agoric in MetaMask in Agoric &ndash; screenshot 5" class="software_photo_image image-replacement" onerror="this.onerror=null;this.src='https://devpost-challengepost.netdna-ssl.com/assets/defaults/thumbnail-placeholder-42bcab8d8178b413922ae2877d8b0868.gif';" src="//challengepost-s3-challengepost.netdna-ssl.com/photos/production/software_photos/000/880/506/datas/gallery.jpg">
                        </a>
                        <span class="expand-tag">
                            <i class="fas fa-expand">
                            </i>
                        </span>
                        <p>
                            <i>
                                Currencies selected
                            </i>
                        </p>
                    </li>
                    <li class="text-center">
                        <a data-lightbox="880507" data-title="The Plugin is able to provide a rudimentary confirmation to the user. This is very human readable thanks to Agoric's Zoe." href="https://challengepost-s3-challengepost.netdna-ssl.com/photos/production/software_photos/000/880/507/datas/original.png">
                            <img alt="Agoric in MetaMask in Agoric &ndash; screenshot 6" class="software_photo_image image-replacement" onerror="this.onerror=null;this.src='https://devpost-challengepost.netdna-ssl.com/assets/defaults/thumbnail-placeholder-42bcab8d8178b413922ae2877d8b0868.gif';" src="//challengepost-s3-challengepost.netdna-ssl.com/photos/production/software_photos/000/880/507/datas/gallery.jpg">
                        </a>
                        <span class="expand-tag">
                            <i class="fas fa-expand">
                            </i>
                        </span>
                        <p>
                            <i>
                                The Plugin is able to provide a rudimentary confirmation to the user. This is very human readable thanks to Agoric's Zoe.
                            </i>
                        </p>
                    </li>
                    <li class="text-center">
                        <a data-lightbox="880508" data-title="The confirmation can then be confirmed via the Wallet app, also a MetaMask dapp." href="https://challengepost-s3-challengepost.netdna-ssl.com/photos/production/software_photos/000/880/508/datas/original.png">
                            <img alt="Agoric in MetaMask in Agoric &ndash; screenshot 7" class="software_photo_image image-replacement" onerror="this.onerror=null;this.src='https://devpost-challengepost.netdna-ssl.com/assets/defaults/thumbnail-placeholder-42bcab8d8178b413922ae2877d8b0868.gif';" src="//challengepost-s3-challengepost.netdna-ssl.com/photos/production/software_photos/000/880/508/datas/gallery.jpg">
                        </a>
                        <span class="expand-tag">
                            <i class="fas fa-expand">
                            </i>
                        </span>
                        <p>
                            <i>
                                The confirmation can then be confirmed via the Wallet app, also a MetaMask dapp.
                            </i>
                        </p>
                    </li>
                    <li class="text-center">
                        <a data-lightbox="880752" data-title="The Agoric assets visible in MetaMask's internal wallet." href="https://challengepost-s3-challengepost.netdna-ssl.com/photos/production/software_photos/000/880/752/datas/original.png">
                            <img alt="Agoric in MetaMask in Agoric &ndash; screenshot 8" class="software_photo_image image-replacement" onerror="this.onerror=null;this.src='https://devpost-challengepost.netdna-ssl.com/assets/defaults/thumbnail-placeholder-42bcab8d8178b413922ae2877d8b0868.gif';" src="//challengepost-s3-challengepost.netdna-ssl.com/photos/production/software_photos/000/880/752/datas/gallery.jpg">
                        </a>
                        <span class="expand-tag">
                            <i class="fas fa-expand">
                            </i>
                        </span>
                        <p>
                            <i>
                                The Agoric assets visible in MetaMask's internal wallet.
                            </i>
                        </p>
                    </li>
                </ul>
            </div>
            <div>
                <h2>
                    Inspiration
                </h2>
                <p>
                    The MetaMask and Agoric teams are both working in the blockchain ecosystem.  We have a strong relationship given past projects based on a shared common interest in robust, programmable security models.  MetaMask's
                    <code>
                        lava-moat
                    </code>
                    is a tool that uses Agoric's SecureJS to secure the dependency graph of a Javascript application (such as the MetaMask wallet).
                </p>
                <p>
                    We got together during this hackathon to create this core integration of Agoric's SecureJS blockchain platform with the MetaMask wallet to enable developers to create seamless, secure Dapps.
                </p>
                <h2>
                    What it does
                </h2>
                <p>
                    An Agoric blockchain user first browses an enabled Dapp website.  The Dapp can use MetaMask to fetch wallet balances and exchange digital assets connected to the Agoric Cosmos zone by:
                </p>
                <ol>
                    <li>
                        Using the Dapp's logic to construct an offer
                    </li>
                    <li>
                        Prompting to approve the transaction by a secure browser popup which clearly explains the enforced constructed terms
                    </li>
                    <li>
                        If approved, executing the exchange via Zoe, Agoric's offer safety server
                    </li>
                </ol>
                <h2>
                    How we built it
                </h2>
                <p>
                    We built a plugin for the new, plugin-enabled Metamask browser extension.  The plugin provides a secure, in-process bridge from the running Dapp browser code and a locally-installed Agoric blockchain client.
                </p>
                <p>
                    We modified the Agoric sample autoswap (i.e. uniswap-like) Dapp and the Agoric sample wallet to use the MetaMask plugin's newly-provided in-browser APIs to fetch balances, conduct the exchange and query transactions.
                </p>
                <p>
                    All code written was in Javascript.
                </p>
                <h2>
                    Challenges we ran into
                </h2>
                <p>
                    The Metamask plugin system is in beta, and the Agoric chain is currently in testnet.  Both are currently moving targets.
                </p>
                <p>
                    We had stretch goals of using generic RPC mechanisms to communicate with the Agoric chain, but instead hand-wrote each bridge function.  This caused several bugs that were hard to find and fix, which should have been systematically easier.
                </p>
                <h2>
                    Accomplishments that we're proud of
                </h2>
                <ul>
                    <li>
                        This is the first time MetaMask has been able to run a blockchain other than Ethereum.
                    </li>
                    <li>
                        This is Agoric's first non-internal wallet integration.
                    </li>
                    <li>
                        We're able to have some of the most comprehensible blockchain transactions ever on MetaMask, thanks to Agoric's Zoe.
                    </li>
                </ul>
                <h2>
                    What we learned
                </h2>
                <p>
                    JavaScript across the stack definitely made this easier.
                </p>
                <p>
                    Agoric re-learned some Ethereum lessons about isolating wallet functionality from data access on their RPC servers.
                </p>
                <p>
                    We learned a lot about each other's projects and how they work.
                </p>
                <h2>
                    What's next for Agoric in MetaMask in Agoric
                </h2>
                <p>
                    Probably a total rewrite. The plugin system, along with much of Agoric's blockchain, are fairly early in development, but this early experiment has really helped us frame our future efforts around how to secure and optimize for this kind of interaction.
                </p>
            </div>
            <div class="" id="built-with">
                <h2>
                    Built With
                </h2>
                <ul class="no-bullet inline-list">
                    <li>
                        <span class="cp-tag recognized-tag">
                            <a href="https://devpost.com/software/built-with/javascript">
                                javascript
                            </a>
                        </span>
                    </li>
                </ul>
            </div>
            <nav class="app-links section">
                <h2>
                    Try it out
                </h2>
                <ul class="no-bullet" data-role="software-urls">
                    <li>
                        <a href="https://github.com/danfinlay/metamask-agoric-plugin" rel="nofollow" target="_blank" title="https://github.com/danfinlay/metamask-agoric-plugin">
                            <i class="ss-icon ss-link">
                            </i>
                            <span>
                                github.com
                            </span>
                        </a>
                    </li>
                </ul>
            </nav>
        </div>
    </body>
</html>
