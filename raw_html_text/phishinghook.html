<html>
    <head>
    </head>
    <body>
        <div class="large-9 columns" id="app-details-left">
            <div id="gallery">
                <ul>
                    <li class="text-center">
                        <a data-lightbox="586263" data-title="Demo Screenshot" href="https://challengepost-s3-challengepost.netdna-ssl.com/photos/production/software_photos/000/586/263/datas/original.png">
                            <img alt="PhishingLine &ndash; screenshot 1" class="software_photo_image image-replacement" onerror="this.onerror=null;this.src='https://devpost-challengepost.netdna-ssl.com/assets/defaults/thumbnail-placeholder-42bcab8d8178b413922ae2877d8b0868.gif';" src="//challengepost-s3-challengepost.netdna-ssl.com/photos/production/software_photos/000/586/263/datas/gallery.jpg">
                        </a>
                        <span class="expand-tag">
                            <i class="fas fa-expand">
                            </i>
                        </span>
                        <p>
                            <i>
                                Demo Screenshot
                            </i>
                        </p>
                    </li>
                </ul>
            </div>
            <div>
                <p>
                    PLEASE NOTE: Due to issues with Domain.com's DNS propagation being rather slow, I'm having to run it the demo on a high port of an existing domain. If it propagates in time, phishingline.net should go up
                </p>
                <h2>
                    Inspiration
                </h2>
                <p>
                    The theme of this hackathon was "Open Data". While searching for ideas, I found a data source called CertStream, which parses the Certificate Transparency Logs to create a WebSocket feed of newly registered domains.
                </p>
                <p>
                    As someone who's quite into security, the idea of distilling the data provided by CertStream into something that could be applied for security purposes seemed interesting. After some consideration, I settled on looking for new phishing domains - they tend to follow some common patterns, which turned out to be amenable to automatic recognition
                </p>
                <h2>
                    What it does
                </h2>
                <p>
                    PhishingLine reads incoming certificate registrations from CertStream, and scans the domains the certificate is valid for. The scans comprise of a set of simple heuristics, which are used to calculate a score for the domain - the higher the score, the more likely the domain is to be a phishing domain.
                </p>
                <p>
                    I made use of the following matching techniques:
                </p>
                <ul>
                    <li>
                        Substring Matching - Phishing domains typically use a lot of common substrings, which can easily be matched.
                    </li>
                    <li>
                        TLD Matching - Certain TLDs are commonly abused in phishing domains and other malicious activities. A domain under such a TLD can be viewed with more suspicion.
                    </li>
                    <li>
                        Character Count Matching - Phishing domains often contain many "-"s and deeply nested subdomains, so if there are enough present, score proportional to the number of "-" and "." characters in the domain.
                    </li>
                    <li>
                        Levenshtein Distance Matching - Some phishing domains contain near-matches to some keywords - e.g. "pavpal". Therefore, we can match on certain keywords if the Levenshtein distance to parts of the domain is small.
                    </li>
                    <li>
                        Free Certificate Authority Matching - Free CAs are commonly used in phishing sites in order to help present an image of legitimacy. As such, if such a CA is in use, this will incur a small score.
                    </li>
                </ul>
                <p>
                    PhishingLine then presents the 10 most recent domains, 10 highest scoring domains and a map of the 50 most recent domains which resolve to an IP address. There are also endpoints available to provide JSON of the domains, useful for scraping and automatic parsing (e.g. into a DNS blacklist)
                </p>
                <h2>
                    How I built it
                </h2>
                <p>
                    I begun by developing a simplified, command-line version of PhishingLine - this allowed me to implement the stream reading functionality and some basic scanning early on, without worrying about moving the data to the frontend.
                </p>
                <p>
                    Next came some improvements on the matching heuristics, followed by the implementation of a basic frontend, written in Python with Flask. However, this used a frankly terrible means of getting the data from the stream parser to the web page - so the obvious next step was to move to a SQLite database.
                </p>
                <p>
                    Beyond that, some gradual functional and UI improvements later, and PhishingLine reached its current state.
                </p>
                <h2>
                    Challenges I ran into
                </h2>
                <p>
                    There were a few key challenges which I ran into:
                </p>
                <p>
                    Firstly, I attempted to scan content, rather than domains. This caused issues, as there are quite a lot of new domains coming in on CertStream per second, and any exceptions while fetching content needs to be handled, etc, etc. - In the end, it turned out to be an unsuitable approach for a lot of  reasons, while domain scanning proved sufficient.
                </p>
                <p>
                    The next major challenge was in implementing the map - I tried rendering it server-side, first trying to use BaseMap (Which failed due to the fact that - in spite of far too much effort - it simply wouldn't install) and then Cartopy (Which wouldn't produce a suitable map, again in spite of too much effort). Then it was suggested I try Leaflet. Half an hour later it worked. After several hours of build systems/graph libraries hating me.
                </p>
                <p>
                    Wonderful.
                </p>
                <h2>
                    Accomplishments that I'm proud of
                </h2>
                <p>
                    Went from idea to a somewhat-working result fairly quickly, before I stalled out trying to get a map to render.
                </p>
                <p>
                    Did something interesting with an open data source
                </p>
                <p>
                    Staying awake... x.x
                </p>
                <h2>
                    What I learned
                </h2>
                <p>
                    Practised working with Flask, Bootstrap, etc.
                </p>
                <p>
                    Learnt about processing a novel data source.
                </p>
                <p>
                    Practised using SQLite
                </p>
                <h2>
                    What's next for PhishingLine
                </h2>
                <p>
                    Not a lot, immediately. The first thing would be to move the background worker to some sort of slightly less shitty setup - at the moment I'm just forking it off in a thread when the main
                    <code>
                        app.py
                    </code>
                    loads, which is less than ideal...
                </p>
                <p>
                    An interesting line of experimentation might be to try applying some sort of machine learning for scoring and detection, rather than manual hard-coded heuristics.
                </p>
            </div>
            <div class="" id="built-with">
                <h2>
                    Built With
                </h2>
                <ul class="no-bullet inline-list">
                    <li>
                        <span class="cp-tag recognized-tag">
                            <a href="https://devpost.com/software/built-with/flask">
                                flask
                            </a>
                        </span>
                    </li>
                    <li>
                        <span class="cp-tag recognized-tag">
                            <a href="https://devpost.com/software/built-with/nginx">
                                nginx
                            </a>
                        </span>
                    </li>
                    <li>
                        <span class="cp-tag recognized-tag">
                            <a href="https://devpost.com/software/built-with/python">
                                python
                            </a>
                        </span>
                    </li>
                    <li>
                        <span class="cp-tag recognized-tag">
                            <a href="https://devpost.com/software/built-with/websockets">
                                websockets
                            </a>
                        </span>
                    </li>
                    <li>
                        <span class="cp-tag">
                            wsgi
                        </span>
                    </li>
                </ul>
            </div>
            <nav class="app-links section">
                <h2>
                    Try it out
                </h2>
                <ul class="no-bullet" data-role="software-urls">
                    <li>
                        <a href="https://github.com/benjcksn/rhack" rel="nofollow" target="_blank" title="https://github.com/benjcksn/rhack">
                            <i class="ss-icon ss-link">
                            </i>
                            <span>
                                github.com
                            </span>
                        </a>
                    </li>
                    <li>
                        <a href="http://jcksn.me:5000/" rel="nofollow" target="_blank" title="http://jcksn.me:5000/">
                            <i class="ss-icon ss-link">
                            </i>
                            <span>
                                jcksn.me
                            </span>
                        </a>
                    </li>
                </ul>
            </nav>
        </div>
    </body>
</html>
