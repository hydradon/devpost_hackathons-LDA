<html>
    <head>
    </head>
    <body>
        <div class="large-9 columns" id="app-details-left">
            <div id="gallery">
                <ul>
                    <li>
                        <div class="flex-video">
                            <iframe allowfullscreen="allowfullscreen" allowscriptaccess="always" class="video-embed" frameborder="0" height="371" mode="transparent" src="https://www.youtube.com/embed/ka4uoIkv0tA?enablejsapi=1&amp;hl=en_US&amp;rel=0&amp;start=&amp;version=3&amp;wmode=transparent" type="text/html" webkitallowfullscreen="true" width="660" wmode="transparent">
                            </iframe>
                        </div>
                    </li>
                    <li class="text-center">
                        <a data-lightbox="844221" data-title="Code" href="https://challengepost-s3-challengepost.netdna-ssl.com/photos/production/software_photos/000/844/221/datas/original.JPG">
                            <img alt="SpeedTorch &ndash; screenshot 1" class="software_photo_image image-replacement" onerror="this.onerror=null;this.src='https://devpost-challengepost.netdna-ssl.com/assets/defaults/thumbnail-placeholder-42bcab8d8178b413922ae2877d8b0868.gif';" src="//challengepost-s3-challengepost.netdna-ssl.com/photos/production/software_photos/000/844/221/datas/gallery.jpg">
                        </a>
                        <span class="expand-tag">
                            <i class="fas fa-expand">
                            </i>
                        </span>
                        <p>
                            <i>
                                Code
                            </i>
                        </p>
                    </li>
                    <li class="text-center">
                        <a data-lightbox="844223" data-title="Code" href="https://challengepost-s3-challengepost.netdna-ssl.com/photos/production/software_photos/000/844/223/datas/original.JPG">
                            <img alt="SpeedTorch &ndash; screenshot 2" class="software_photo_image image-replacement" onerror="this.onerror=null;this.src='https://devpost-challengepost.netdna-ssl.com/assets/defaults/thumbnail-placeholder-42bcab8d8178b413922ae2877d8b0868.gif';" src="//challengepost-s3-challengepost.netdna-ssl.com/photos/production/software_photos/000/844/223/datas/gallery.jpg">
                        </a>
                        <span class="expand-tag">
                            <i class="fas fa-expand">
                            </i>
                        </span>
                        <p>
                            <i>
                                Code
                            </i>
                        </p>
                    </li>
                    <li class="text-center">
                        <a data-lightbox="844224" data-title="Code1" href="https://challengepost-s3-challengepost.netdna-ssl.com/photos/production/software_photos/000/844/224/datas/original.JPG">
                            <img alt="SpeedTorch &ndash; screenshot 3" class="software_photo_image image-replacement" onerror="this.onerror=null;this.src='https://devpost-challengepost.netdna-ssl.com/assets/defaults/thumbnail-placeholder-42bcab8d8178b413922ae2877d8b0868.gif';" src="//challengepost-s3-challengepost.netdna-ssl.com/photos/production/software_photos/000/844/224/datas/gallery.jpg">
                        </a>
                        <span class="expand-tag">
                            <i class="fas fa-expand">
                            </i>
                        </span>
                        <p>
                            <i>
                                Code1
                            </i>
                        </p>
                    </li>
                    <li class="text-center">
                        <a data-lightbox="844225" data-title="StackOverflow post that started it all" href="https://challengepost-s3-challengepost.netdna-ssl.com/photos/production/software_photos/000/844/225/datas/original.JPG">
                            <img alt="SpeedTorch &ndash; screenshot 4" class="software_photo_image image-replacement" onerror="this.onerror=null;this.src='https://devpost-challengepost.netdna-ssl.com/assets/defaults/thumbnail-placeholder-42bcab8d8178b413922ae2877d8b0868.gif';" src="//challengepost-s3-challengepost.netdna-ssl.com/photos/production/software_photos/000/844/225/datas/gallery.jpg">
                        </a>
                        <span class="expand-tag">
                            <i class="fas fa-expand">
                            </i>
                        </span>
                        <p>
                            <i>
                                StackOverflow post that started it all
                            </i>
                        </p>
                    </li>
                    <li class="text-center">
                        <a data-lightbox="844226" data-title="TSNE" href="https://challengepost-s3-challengepost.netdna-ssl.com/photos/production/software_photos/000/844/226/datas/original.JPG">
                            <img alt="SpeedTorch &ndash; screenshot 5" class="software_photo_image image-replacement" onerror="this.onerror=null;this.src='https://devpost-challengepost.netdna-ssl.com/assets/defaults/thumbnail-placeholder-42bcab8d8178b413922ae2877d8b0868.gif';" src="//challengepost-s3-challengepost.netdna-ssl.com/photos/production/software_photos/000/844/226/datas/gallery.jpg">
                        </a>
                        <span class="expand-tag">
                            <i class="fas fa-expand">
                            </i>
                        </span>
                        <p>
                            <i>
                                TSNE
                            </i>
                        </p>
                    </li>
                    <li class="text-center">
                        <a data-lightbox="844227" data-title="Recommendations" href="https://challengepost-s3-challengepost.netdna-ssl.com/photos/production/software_photos/000/844/227/datas/original.JPG">
                            <img alt="SpeedTorch &ndash; screenshot 6" class="software_photo_image image-replacement" onerror="this.onerror=null;this.src='https://devpost-challengepost.netdna-ssl.com/assets/defaults/thumbnail-placeholder-42bcab8d8178b413922ae2877d8b0868.gif';" src="//challengepost-s3-challengepost.netdna-ssl.com/photos/production/software_photos/000/844/227/datas/gallery.jpg">
                        </a>
                        <span class="expand-tag">
                            <i class="fas fa-expand">
                            </i>
                        </span>
                        <p>
                            <i>
                                Recommendations
                            </i>
                        </p>
                    </li>
                    <li class="text-center">
                        <a data-lightbox="844228" data-title="code" href="https://challengepost-s3-challengepost.netdna-ssl.com/photos/production/software_photos/000/844/228/datas/original.JPG">
                            <img alt="SpeedTorch &ndash; screenshot 7" class="software_photo_image image-replacement" onerror="this.onerror=null;this.src='https://devpost-challengepost.netdna-ssl.com/assets/defaults/thumbnail-placeholder-42bcab8d8178b413922ae2877d8b0868.gif';" src="//challengepost-s3-challengepost.netdna-ssl.com/photos/production/software_photos/000/844/228/datas/gallery.jpg">
                        </a>
                        <span class="expand-tag">
                            <i class="fas fa-expand">
                            </i>
                        </span>
                        <p>
                            <i>
                                code
                            </i>
                        </p>
                    </li>
                    <li class="text-center">
                        <a data-gif-player="true" href="https://challengepost-s3-challengepost.netdna-ssl.com/photos/production/software_photos/000/844/229/datas/original.gif">
                            <img alt="SpeedTorch &ndash; screenshot 8" class="software_photo_image image-replacement" onerror="this.onerror=null;this.src='https://devpost-challengepost.netdna-ssl.com/assets/defaults/thumbnail-placeholder-42bcab8d8178b413922ae2877d8b0868.gif';" src="//challengepost-s3-challengepost.netdna-ssl.com/photos/production/software_photos/000/844/229/datas/gallery.jpg">
                        </a>
                        <span class="gif-tag">
                            GIF
                        </span>
                        <a class="gif-play">
                            <i class="fas fa-play">
                            </i>
                        </a>
                        <p>
                            <i>
                                Sonic
                            </i>
                        </p>
                    </li>
                    <li class="text-center">
                        <a data-lightbox="844255" data-title="Logo" href="https://challengepost-s3-challengepost.netdna-ssl.com/photos/production/software_photos/000/844/255/datas/original.png">
                            <img alt="SpeedTorch &ndash; screenshot 9" class="software_photo_image image-replacement" onerror="this.onerror=null;this.src='https://devpost-challengepost.netdna-ssl.com/assets/defaults/thumbnail-placeholder-42bcab8d8178b413922ae2877d8b0868.gif';" src="//challengepost-s3-challengepost.netdna-ssl.com/photos/production/software_photos/000/844/255/datas/gallery.jpg">
                        </a>
                        <span class="expand-tag">
                            <i class="fas fa-expand">
                            </i>
                        </span>
                        <p>
                            <i>
                                Logo
                            </i>
                        </p>
                    </li>
                    <li class="text-center">
                        <a data-lightbox="844339" data-title="BenchMarks" href="https://challengepost-s3-challengepost.netdna-ssl.com/photos/production/software_photos/000/844/339/datas/original.JPG">
                            <img alt="SpeedTorch &ndash; screenshot 10" class="software_photo_image image-replacement" onerror="this.onerror=null;this.src='https://devpost-challengepost.netdna-ssl.com/assets/defaults/thumbnail-placeholder-42bcab8d8178b413922ae2877d8b0868.gif';" src="//challengepost-s3-challengepost.netdna-ssl.com/photos/production/software_photos/000/844/339/datas/gallery.jpg">
                        </a>
                        <span class="expand-tag">
                            <i class="fas fa-expand">
                            </i>
                        </span>
                        <p>
                            <i>
                                BenchMarks
                            </i>
                        </p>
                    </li>
                    <li class="text-center">
                        <a data-lightbox="844340" data-title="Documentation" href="https://challengepost-s3-challengepost.netdna-ssl.com/photos/production/software_photos/000/844/340/datas/original.JPG">
                            <img alt="SpeedTorch &ndash; screenshot 11" class="software_photo_image image-replacement" onerror="this.onerror=null;this.src='https://devpost-challengepost.netdna-ssl.com/assets/defaults/thumbnail-placeholder-42bcab8d8178b413922ae2877d8b0868.gif';" src="//challengepost-s3-challengepost.netdna-ssl.com/photos/production/software_photos/000/844/340/datas/gallery.jpg">
                        </a>
                        <span class="expand-tag">
                            <i class="fas fa-expand">
                            </i>
                        </span>
                        <p>
                            <i>
                                Documentation
                            </i>
                        </p>
                    </li>
                </ul>
            </div>
            <div>
                <h2>
                    Inspiration
                </h2>
                <p>
                    Two of my past projects involved training large number of embeddings, and the GPU I was using was not able to hold these embeddings at the desired embedding dimension I wanted. I noticed that during each training step, only a small number of the total embeddings were updated; the rest are idle and could be kept off the GPU RAM when not in use.
                </p>
                <p>
                    For this I needed fast CPU &lt;-&gt; GPU transfer. Using a Pytorch pinned CPU tensor to a Pytorch Cuda Variable was decent enough, but the reverse was too slow for training in a reasonable amount of time, so I started looking at other options. In response to a StackOverflow question I asked [
                    <a href="https://stackoverflow.com/questions/57752516/how-to-use-cuda-pinned-zero-copy-memory-for-a-memory-mapped-file" rel="nofollow">
                        https://stackoverflow.com/questions/57752516/how-to-use-cuda-pinned-zero-copy-memory-for-a-memory-mapped-file
                    </a>
                    ], StackOverFlow user Robert Crovella developed a new type of Tensor (a Cupy Tensor with pinned CPU memory), which turned out to be very fast at transferring data to/from the CPU.
                </p>
                <h2>
                    What it does
                </h2>
                <p>
                    Fast CPU &lt;-&gt; GPU data transfer from/to Pytorch Cuda Variables. Applications are:
                </p>
                <ul>
                    <li>
                        <p>
                            Incorporate SpeedTorch into your data pipelines for fast data transfer to/from CPU &lt;-&gt; GPU
                        </p>
                    </li>
                    <li>
                        <p>
                            Augment training parameters via CPU storage.
                        </p>
                    </li>
                    <li>
                        <p>
                            Use Adadelta, Adamax, RMSprop, Rprop, ASGD, AdamW, and Adam optimizers for sparse embeddings training. Previously, only SpraseAdam, Adagrad, and SGD were suitable since only these directly support sprase gradients.
                        </p>
                    </li>
                </ul>
                <p>
                    Here are some quick getting started videos:
                </p>
                <p>
                    Using the dataGadget:
                    <a href="https://www.youtube.com/watch?v=ka4uoIkv0tA" rel="nofollow">
                        https://www.youtube.com/watch?v=ka4uoIkv0tA
                    </a>
                </p>
                <p>
                    Use in embeddings training:
                    <a href="https://www.youtube.com/watch?v=jKu7vCxFhUc" rel="nofollow">
                        https://www.youtube.com/watch?v=jKu7vCxFhUc
                    </a>
                </p>
                <h2>
                    How I built it
                </h2>
                <p>
                    With Pytorch, Numpy, and Cupy.
                </p>
                <h2>
                    Challenges I ran into
                </h2>
                <p>
                    I initially was looking for a way to store the embeddings onto the disk, and use memory mapping for fast storage and retrieval. I discovered Cupy memory maps and when I bench marked the speeds for word2vc training, they were amazing. I thought I discovered something huge, so I starting making a library around this.
                </p>
                <p>
                    A few weeks in, the library was nearly complete, and I wanted to test this on my larger embeddings datasets. But something was wrong, my system would keep crashing, due to out of memory errors. To my horror, I found out that even though memory maps were being used, it would still take up as much memory as using live tensors, which defeated the purpose of the library I created. If you look at the Github repo, it still contains the original memory map code [
                    <a href="https://github.com/Santosh-Gupta/SpeedTorch/blob/master/SpeedTorch/CPUCupyPinned.py" rel="nofollow">
                        https://github.com/Santosh-Gupta/SpeedTorch/blob/master/SpeedTorch/CPUCupyPinned.py
                    </a>
                    ], I still haven't had the heart to delete it haha.
                </p>
                <p>
                    I was pretty bummed out, and thought I had wasted a few weeks, and started shifting focus to a different project I could submit to the Pytorch hackathon; I still had 2 weeks. But I did remember that in some cases, for the Cupy memmaps, data transfer was actually fast than Pytorch tensors for transferring data to/from a Pytorch Cuda Variable.
                </p>
                <p>
                    I wondered if the same could be done with a Cupy tensor on pinned CPU memory, so I asked on StackOverFlow [
                    <a href="https://stackoverflow.com/questions/57752516/how-to-use-cuda-pinned-zero-copy-memory-for-a-memory-mapped-file" rel="nofollow">
                        https://stackoverflow.com/questions/57752516/how-to-use-cuda-pinned-zero-copy-memory-for-a-memory-mapped-file
                    </a>
                    ]. While such a method didn't officially exist, StackOverFlow user Robert Crovella created his own method.
                </p>
                <p>
                    When I did the speed benchmarks of this new tensor datatype, I couldn't believe some of the results. Robert Crovella created something amazing.
                </p>
                <h2>
                    Accomplishments that I'm proud of
                </h2>
                <p>
                    In addition to the library itself, I was able to use SpeedTorch to finally created a rare book recommender that I've been wanting to make for over a year now.
                </p>
                <p>
                    <a href="https://github.com/Santosh-Gupta/lit2vec2" rel="nofollow">
                        https://github.com/Santosh-Gupta/lit2vec2
                    </a>
                </p>
                <p>
                    The original version of this project [
                    <a href="https://github.com/Santosh-Gupta/lit2vec" rel="nofollow">
                        https://github.com/Santosh-Gupta/lit2vec
                    </a>
                    ] only contained 10,000 popular books, but I didn't really need a recommender for popular books; I wanted one for rare books. Thanks to SpeedTorch, I was able to create a 400 dimensional embedding for  2,829,853 books. I actually could have created larger embeddings, but I didn't have the Google Drive space (though much easier problem to solve).
                </p>
                <p>
                    There's also a similar case an updated for a research paper recommender I created last year
                </p>
                <p>
                    <a href="https://github.com/Santosh-Gupta/research2vec2" rel="nofollow">
                        https://github.com/Santosh-Gupta/research2vec2
                    </a>
                </p>
                <p>
                    For the original [
                    <a href="https://github.com/Santosh-Gupta/research2vec" rel="nofollow">
                        https://github.com/Santosh-Gupta/research2vec
                    </a>
                    ] I could only train 2-4 million research paper embeddings, at embedding sizes 64-80. I can now train 14,886,544 paper embeddings at an embedding size of 188.
                </p>
                <p>
                    Though these were partially due to the Google Colab upgrades, SpeedTorch allows to nearly double the parameters in Colab by allowing half to be hosted on the CPU using their 25 gb CPU instances.
                </p>
                <p>
                    As long as you have enough CPU RAM, you can host any number of embeddings without having to worry about the GPU RAM.
                </p>
                <h2>
                    What I learned
                </h2>
                <p>
                    I learned A LOT of Pytorch. A month and a half ago, I actually never used Pytorch. But I received an invite to an official Pytorch hackathon located at the Facebook headquarters in Menlo Park. It was an opportunity I couldn't pass up, so I spent the week before the hackathon learning about Pytorch. During the hackathon, I got to meet with other Pytorch users, and even some of the Pytorch developers, and I learned a lot about it.
                </p>
                <p>
                    My biggest takeaway was how pliable and Pythonic it was, and how easy it was to alter the weights of the model variables and optimizer, which led to my idea about a library for sparse training.
                </p>
                <h2>
                    What's next for SpeedTorch
                </h2>
                <p>
                    I'm sure that there are a lot of other applications that can be applied to SpeedTorch other than fast data transfer and embeddings training. If you have an idea, please post an issue on the project Github, or post in the Gitter [
                    <a href="https://gitter.im/SpeedTorch" rel="nofollow">
                        https://gitter.im/SpeedTorch
                    </a>
                    ], I would love to hear it!
                </p>
                <p>
                    <img alt="Alt text" data-canonical-url="https://i.imgur.com/6o8C1BP.gif" src="https://res.cloudinary.com/devpost/image/fetch/s--LvDjBhzo--/c_limit,f_auto,fl_lossy,q_auto:eco,w_900/https://i.imgur.com/6o8C1BP.gif">
                </p>
            </div>
            <div class="" id="built-with">
                <h2>
                    Built With
                </h2>
                <ul class="no-bullet inline-list">
                    <li>
                        <span class="cp-tag">
                            cupy
                        </span>
                    </li>
                    <li>
                        <span class="cp-tag recognized-tag">
                            <a href="https://devpost.com/software/built-with/numpy">
                                numpy
                            </a>
                        </span>
                    </li>
                    <li>
                        <span class="cp-tag recognized-tag">
                            <a href="https://devpost.com/software/built-with/python">
                                python
                            </a>
                        </span>
                    </li>
                    <li>
                        <span class="cp-tag recognized-tag">
                            <a href="https://devpost.com/software/built-with/pytorch">
                                pytorch
                            </a>
                        </span>
                    </li>
                </ul>
            </div>
            <nav class="app-links section">
                <h2>
                    Try it out
                </h2>
                <ul class="no-bullet" data-role="software-urls">
                    <li>
                        <a href="https://github.com/Santosh-Gupta/SpeedTorch" rel="nofollow" target="_blank" title="https://github.com/Santosh-Gupta/SpeedTorch">
                            <i class="ss-icon ss-link">
                            </i>
                            <span>
                                github.com
                            </span>
                        </a>
                    </li>
                </ul>
            </nav>
        </div>
    </body>
</html>
