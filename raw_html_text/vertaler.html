<html>
    <head>
    </head>
    <body>
        <div class="large-9 columns" id="app-details-left">
            <div>
                <h2>
                    Inspiration
                </h2>
                <p>
                    Initially what we wanted to do was create some sort of "bot" to have a conversation for around 20 minutes with however this proved to take more time than we expected so we decided to make something that just translates text into another language over the phone.
                </p>
                <p>
                    However since Google Cloud Speech doesn't like the recording Twillio is spitting out we had to lower to bar again.
                </p>
                <p>
                    And so at midnight we binned a lot of stuff and rewrote everything to get to the point where we are today.
                </p>
                <h2>
                    What it does
                </h2>
                <p>
                    Vertaler is a translator, but not just any translator. A translator you can text. A translator that'll call you back. A translator that might even text you back! That's what Vertaler is. Not just a translator but a companion.
                </p>
                <h2>
                    How we built it
                </h2>
                <p>
                    The whole api endpoint is built in Sinatra since Flask is too overused and Ruby is a nice and comfy language.
                </p>
                <p>
                    Using the Twilio and Google Cloud gem we were able to translate the phrase we wanted to translate and then either call or text back using Twillio.
                </p>
                <h2>
                    Challenges we ran into
                </h2>
                <p>
                    Google Cloud Speech.
                </p>
                <h2>
                    Accomplishments that we're proud of
                </h2>
                <p>
                    It works.
                </p>
                <h2>
                    What we learned
                </h2>
                <p>
                    How to use the Google Cloud API.
                </p>
                <h2>
                    What's next for Vertaler
                </h2>
                <p>
                    Speech to Speech support.
                </p>
                <h2>
                    Source Code
                </h2>
                <pre class="language-ruby"><code>require "sinatra"
require "twilio-ruby"
require "google/cloud"
require "unicode"
require "unidecoder"

accountSid = ENV['TWILLIO_SID']
authToken  = ENV['TWILLIO_AUTH']
apiKey     = ENV['GOOGLE_TRANSLATE']

gcloud  = Google::Cloud.new
twillio = Twilio::REST::Client.new accountSid, authToken

hashLanguages = {
'Afrikaans'           =&gt; 'af',
'Albanian'            =&gt; 'sq',
'Arabic'              =&gt; 'ar',
'Armenian'            =&gt; 'hy',
'Azerbaijani'         =&gt; 'az',
'Basque'              =&gt; 'eu',
'Belarusian'          =&gt; 'be',
'Bengali'             =&gt; 'bn',
'Bosnian'             =&gt; 'bs',
'Bulgarian'           =&gt; 'bg',
'Catalan'             =&gt; 'ca',
'Cebuano'             =&gt; 'ceb',
'Chichewa'            =&gt; 'ny',
'Chinese Simplified'  =&gt; 'zh-CN',
'Chinese Traditional' =&gt; 'zh-TW',
'Croatian'            =&gt; 'hr',
'Czech'               =&gt; 'cs',
'Danish'              =&gt; 'da',
'Dutch'               =&gt; 'nl',
'English'             =&gt; 'en',
'Esperanto'           =&gt; 'eo',
'Estonian'            =&gt; 'et',
'Filipino'            =&gt; 'tl',
'Finnish'             =&gt; 'fi',
'French'              =&gt; 'fr',
'Galician'            =&gt; 'gl',
'Georgian'            =&gt; 'ka',
'German'              =&gt; 'de',
'Greek'               =&gt; 'el',
'Gujarati'            =&gt; 'gu',
'Haitian Creole'      =&gt; 'ht',
'Hausa'               =&gt; 'ha',
'Hebrew'              =&gt; 'iw',
'Hindi'               =&gt; 'hi',
'Hmong'               =&gt; 'hmn',
'Hungarian'           =&gt; 'hu',
'Icelandic'           =&gt; 'is',
'Igbo'                =&gt; 'ig',
'Indonesian'          =&gt; 'id',
'Irish'               =&gt; 'ga',
'Italian'             =&gt; 'it',
'Japanese'            =&gt; 'ja',
'Javanese'            =&gt; 'jw',
'Kannada'             =&gt; 'kn',
'Kazakh'              =&gt; 'kk',
'Khmer'               =&gt; 'km',
'Korean'              =&gt; 'ko',
'Lao'                 =&gt; 'lo',
'Latin'               =&gt; 'la',
'Latvian'             =&gt; 'lv',
'Lithuanian'          =&gt; 'lt',
'Macedonian'          =&gt; 'mk',
'Malagasy'            =&gt; 'mg',
'Malay'               =&gt; 'ms',
'Malayalam'           =&gt; 'ml',
'Maltese'             =&gt; 'mt',
'Maori'               =&gt; 'mi',
'Marathi'             =&gt; 'mr',
'Mongolian'           =&gt; 'mn',
'Myanmar (Burmese)'   =&gt; 'my',
'Nepali'              =&gt; 'ne',
'Norwegian'           =&gt; 'no',
'Persian'             =&gt; 'fa',
'Polish'              =&gt; 'pl',
'Portuguese'          =&gt; 'pt',
'Punjabi'             =&gt; 'ma',
'Romanian'            =&gt; 'ro',
'Russian'             =&gt; 'ru',
'Serbian'             =&gt; 'sr',
'Sesotho'             =&gt; 'st',
'Sinhala'             =&gt; 'si',
'Slovak'              =&gt; 'sk',
'Slovenian'           =&gt; 'sl',
'Somali'              =&gt; 'so',
'Spanish'             =&gt; 'es',
'Sudanese'            =&gt; 'su',
'Swahili'             =&gt; 'sw',
'Swedish'             =&gt; 'sv',
'Tajik'               =&gt; 'tg',
'Tamil'               =&gt; 'ta',
'Telugu'              =&gt; 'te',
'Thai'                =&gt; 'th',
'Turkish'             =&gt; 'tr',
'Ukrainian'           =&gt; 'uk',
'Urdu'                =&gt; 'ur',
'Uzbek'               =&gt; 'uz',
'Vietnamese'          =&gt; 'vi',
'Welsh'               =&gt; 'cy',
'Yiddish'             =&gt; 'yi',
'Yoruba'              =&gt; 'yo',
'Zulu'                =&gt; 'zu'
}

hashLocales = {
'da' =&gt; "da-DK",
'de' =&gt; "de-DE",
'en' =&gt; "en-GB",
'ca' =&gt; "ca-ES",
'es' =&gt; "es-ES",
'fi' =&gt; "fi-FI",
'fr' =&gt; "fr-FR",
'it' =&gt; "it-IT",
'ja' =&gt; "ja-JP",
'ko' =&gt; "ko-KR",
'nb' =&gt; "nb-NO",
'nl' =&gt; "nl-NL",
'pl' =&gt; "pl-PL",
'pt' =&gt; "pt-PT",
'ru' =&gt; "ru-RU",
'sv' =&gt; "sv-SE",
'zh' =&gt; "zh-CN"
}

post '/' do
sender      = params['From'],
receiver    = params['To']
body        = params['Body']
arrBody     = /(.*) in (.*)/.match(body)
phrase      = arrBody[1]
language    = arrBody[2]
country     = hashLanguages[language]
locale      = hashLocales[country]
translate   = gcloud.translate apiKey
translation = translate.translate phrase, to: country
if locale.nil?
twillio.account.messages.create({
:from =&gt; receiver,
:to =&gt; sender,
:body =&gt; "The phrase '#{phrase}' in '#{language}' is '#{translation.text}'",
})
else
ascii_str = translation.text.to_ascii
puts ascii_str
ascii_str = ascii_str.gsub! ' ', '%20'
phrase_escaped = phrase.gsub! ' ', '%20'
call = twillio.account.calls.create(
:url  =&gt; "http://0cdef1d3.ngrok.io/voice?Text=#{ascii_str}&amp;Phrase=#{phrase_escaped}&amp;Country=#{translation.to}&amp;Locale=#{locale}&amp;Language=#{language}",
:to   =&gt; sender,
:from =&gt; receiver
)
end
Twilio::TwiML::Response.new do |r|
r.Message "Welcome to Vertaler, the SMS translation service. You've just asked me to translate the phrase '#{phrase}' into '#{language}'."
end.text
end
post '/voice' do
translation = params['Text']
country     = params['Country']
locale      = params['Locale']
phrase      = params['Phrase']
language    = params['Language']

Twilio::TwiML::Response.new do |r|
r.Say "The phrase #{phrase} in #{language} is", voice: 'alice'
r.Say translation, voice: 'alice', language: locale
r.Say "Good bye!"
end.text
end
</code></pre>
            </div>
            <div class="" id="built-with">
                <h2>
                    Built With
                </h2>
                <ul class="no-bullet inline-list">
                    <li>
                        <span class="cp-tag recognized-tag">
                            <a href="https://devpost.com/software/built-with/sinatra">
                                sinatra
                            </a>
                        </span>
                    </li>
                    <li>
                        <span class="cp-tag recognized-tag">
                            <a href="https://devpost.com/software/built-with/twilio">
                                twilio
                            </a>
                        </span>
                    </li>
                </ul>
            </div>
            <nav class="app-links section">
                <h2>
                    Try it out
                </h2>
                <ul class="no-bullet" data-role="software-urls">
                    <li>
                        <a href="https://github.com/KingNoosh/Vertaler" rel="nofollow" target="_blank" title="https://github.com/KingNoosh/Vertaler">
                            <i class="ss-icon ss-link">
                            </i>
                            <span>
                                github.com
                            </span>
                        </a>
                    </li>
                </ul>
            </nav>
        </div>
    </body>
</html>
