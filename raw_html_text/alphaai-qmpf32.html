<html>
    <head>
    </head>
    <body>
        <div class="large-9 columns" id="app-details-left">
            <div>
                <h2>
                    Inspiration
                </h2>
                <p>
                    Stock markets are complicated dynamic systems that are very sensitive to a multitude of factors. As
                    <strong>
                        math and science
                    </strong>
                    enthusiasts, my team has always been deeply interested in the behaviour of dynamical systems and the prediction of the properties of the dynamic systems. Traditionally, only methods of statistics and time series analysis was applied to the modelling of the stock market. However, with the advent of AI and machine learning, prediction of stock markets have increased in accuracy and efficiency. Having investigated time series analysis and stochastics before, my team decided to investigate the use of
                    <strong>
                        neural networks
                    </strong>
                    to predict the stock returns of various companies. Seeing that this has been done to quite an extent, we decided to improve on it by adding
                    <strong>
                        automated feature extraction
                    </strong>
                    . Furthermore, we are also working to develop a
                    <strong>
                        novel reinforcement learning
                    </strong>
                    model that will hopefully learn to trade on its own.
                </p>
                <h2>
                    Overview
                </h2>
                <p>
                    Our model pipeline is as follows:
                </p>
                <ol>
                    <li>
                        Acquire the stock price data - this is the primary data for our model.
                    </li>
                    <li>
                        Preprocess the data - denoise data with
                        <strong>
                            wavelet transform
                        </strong>
                        and make the train, test datasets for the stacked autoencoders.
                    </li>
                    <li>
                        Train the
                        <strong>
                            stacked autoencoder
                        </strong>
                        - this will give us our feature extractor.
                    </li>
                    <li>
                        Process the data - this will give us the
                        <strong>
                            features
                        </strong>
                        of our model, along with train, test datasets.
                    </li>
                    <li>
                        Use the
                        <strong>
                            LSTM neural network
                        </strong>
                        to learn from the training data.
                    </li>
                    <li>
                        Test the model with the testing set - this gives us a gauge of how good our model is.
                    </li>
                    <li>
                        Make stock price predictions
                    </li>
                    <li>
                        Use
                        <strong>
                            Reinforcement learning
                        </strong>
                        to come up with a trading agent.
                    </li>
                </ol>
                <p>
                    Our main innovations include: using
                    <strong>
                        wavelet transform
                    </strong>
                    to
                    <strong>
                        denoise
                    </strong>
                    the stock data, using
                    <strong>
                        stacked autoencoders
                    </strong>
                    for automated
                    <strong>
                        feature extraction
                    </strong>
                    , using
                    <strong>
                        LSTM neural network
                    </strong>
                    with
                    <strong>
                        Tikhonov regularisation
                    </strong>
                    and
                    <strong>
                        drop-outs
                    </strong>
                    to train on features, the use of
                    <strong>
                        online learning
                    </strong>
                    to continually train our model with usage and using a
                    <strong>
                        novel reinforcement learning
                    </strong>
                    method to create a trading bot.
                </p>
                <p>
                    Following this, we have scraped sentiment data for news and twitter about stocks, and are using it to develop a reinforcement learning model.
                </p>
                <p>
                    This is visually represented in the following flowchart.
                </p>
                <p>
                    <img alt="alt text" data-canonical-url="https://engfinance.files.wordpress.com/2018/10/alphaai_diagram_final.png" src="https://res.cloudinary.com/devpost/image/fetch/s--udVeZCfY--/c_limit,f_auto,fl_lossy,q_auto:eco,w_900/https://engfinance.files.wordpress.com/2018/10/alphaai_diagram_final.png" title="Pipeline Flowchart">
                </p>
                <h2>
                    How we built it
                </h2>
                <p>
                    We scraped over 25000 sets of stock price data from Yahoo Finance. We then used discrete wavelet transform, coupled with threshold to denoise the stock data. Subsequently, we trained the stacked autoencoder for over 1000 epochs and extracted the features from our stock price data. We used these features to train our LSTM model. Deliberate actions were taken to prevent overfitting of data, including using
                    <strong>
                        Tikhonov regularisation
                    </strong>
                    and adding
                    <strong>
                        drop-outs
                    </strong>
                    to make our model
                    <strong>
                        more robust
                    </strong>
                    . Hyperparameters were tuned by
                    <strong>
                        grid search
                    </strong>
                    , and the model was
                    <strong>
                        optimised for performance
                    </strong>
                    .
                </p>
                <p>
                    We scraped over 25000 sets of stock price data from Yahoo Finance. We then used discrete wavelet transform, coupled with threshold to denoise the stock data. Subsequently, we trained the stacked autoencoder for over 1000 epochs and extracted the features from our stock price data. We used these features to train our LSTM model. Deliberate actions were taken to prevent overfitting of data, including using Tikhonov regularisation and adding drop-outs to make our model more robust. Hyperparameters were tuned by grid search, and the model was optimised for performance.
                </p>
                <p>
                    Our Twitter data is pulled with Twitter API with the hashtag of the stock (#AAPL). The sentiment value is then calculated using TextBlob and a simple mean is calculated for the neural network.
                </p>
                <p>
                    By using Aylien's News API, we were able to scrape the web with more criteria and accuracy. 
They are:
                </p>
                <ul>
                    <li>
                        Limited to the category of finance, business and economic news
                    </li>
                    <li>
                        Refers to the stock company (Apple inc) using the specific dbpedia link
                    </li>
                    <li>
                        Refers to stock company (Apple) related articles with specific keywords such as 'Google' and 'Sony'
                    </li>
                    <li>
                        Filtered the top 150 Alexa websites only
                    </li>
                </ul>
                <p>
                    For our News articles, we decided to manually run it through a filter function we made which is designed to mimic how humans read articles. The sentiment score is not calculated with every word in the article as typically, people would only read an article for up to 15seconds. 
To counter that, we would place a higher weightage on the title as around 80% of the people who read the title do not read the body of the article. Also, there are various underlying trends in which people read the article such as the length of the words. After accounting for those factors, we would then calculate the sentiment value for the filtered article is then calculated with TextBlob and a exponentially weighted moving average is calculated for the neural network.
                </p>
                <p>
                    Finally, we used the twitter and news sentiment, coupled with our predicted stock prices to build an reinforcement learning model that gets better over iterations, achieving an annual return of 200%.
                </p>
                <h2>
                    Challenges we ran into
                </h2>
                <p>
                    The main issue was getting the News and Twitter API to work and get us sentiment values. In particular, some of the articles or tweets scraped by the API were irrelevant and sometimes even misleading. Hence, we had to place safeguards to make sure we isolate tweets and news articles that actually have an impact on the viewpoint of the reader.
                </p>
                <p>
                    Twitter API was also limited to 10 days while we could only get a few years of news using the news API, severely limiting the amount of data we could get.
                </p>
                <h2>
                    Main Results
                </h2>
                <p>
                    The main results are summarised in the following graphs:
                </p>
                <p>
                    <img alt="alt text" data-canonical-url="https://engfinance.files.wordpress.com/2018/10/msft-prices.png" src="https://res.cloudinary.com/devpost/image/fetch/s--BG1UZl-N--/c_limit,f_auto,fl_lossy,q_auto:eco,w_900/https://engfinance.files.wordpress.com/2018/10/msft-prices.png" title="MSFT Prediction">
                </p>
                <p>
                    Avg MSE: 0.01431
                </p>
                <p>
                    <img alt="alt text" data-canonical-url="https://engfinance.files.wordpress.com/2018/10/xom-prices.png" src="https://res.cloudinary.com/devpost/image/fetch/s--lqs9x0mC--/c_limit,f_auto,fl_lossy,q_auto:eco,w_900/https://engfinance.files.wordpress.com/2018/10/xom-prices.png" title="XOM Prediction">
                </p>
                <p>
                    Avg MSE: 0.0945
                    <img alt="alt text" data-canonical-url="https://engfinance.files.wordpress.com/2018/10/cvx-prices.png" src="https://res.cloudinary.com/devpost/image/fetch/s--RAhmjuMU--/c_limit,f_auto,fl_lossy,q_auto:eco,w_900/https://engfinance.files.wordpress.com/2018/10/cvx-prices.png" title="CVX Prediction">
                </p>
                <p>
                    Avg MSE: 2.11
                    <img alt="alt text" data-canonical-url="https://engfinance.files.wordpress.com/2018/10/aapl-prices.png" src="https://res.cloudinary.com/devpost/image/fetch/s--G1y-_U9g--/c_limit,f_auto,fl_lossy,q_auto:eco,w_900/https://engfinance.files.wordpress.com/2018/10/aapl-prices.png" title="AAPL Prediction">
                </p>
                <p>
                    Avg MSE: 9.49
                </p>
                <p>
                    For our reinforcement learning portfolio:
                    <img alt="alt text" data-canonical-url="https://engfinance.files.wordpress.com/2018/10/portfolio-vs-holding.png" src="https://res.cloudinary.com/devpost/image/fetch/s--RSXaezbY--/c_limit,f_auto,fl_lossy,q_auto:eco,w_900/https://engfinance.files.wordpress.com/2018/10/portfolio-vs-holding.png" title="Portfolio vs Holding">
                </p>
                <p>
                    We achieved a 200% yearly return using reinforcement learning on Microsoft stock.
                </p>
                <h2>
                    What we learned
                </h2>
                <p>
                    We have learned that AI is very powerful in learning highly nonlinear trends and its impact in quantitative trading models will not diminish anytime soon. Furthermore, we have also learnt the importance have quality data for our machine learning models as they improve the accuracy by magnitudes.
                </p>
                <h2>
                    What's next for AlphaAI
                </h2>
                <p>
                    We aim to make our reinforcement learning algorithm much more sophisticated by accounting various market factors such as dividend payouts, transaction fees and opening the agent up to the different types of orders. If possible, we would like to investigate the impact of market microstructure in setting up good trading bots.
                </p>
            </div>
            <div class="" id="built-with">
                <h2>
                    Built With
                </h2>
                <ul class="no-bullet inline-list">
                    <li>
                        <span class="cp-tag">
                            deep-learning
                        </span>
                    </li>
                    <li>
                        <span class="cp-tag">
                            keras
                        </span>
                    </li>
                    <li>
                        <span class="cp-tag">
                            lstm
                        </span>
                    </li>
                    <li>
                        <span class="cp-tag recognized-tag">
                            <a href="https://devpost.com/software/built-with/machine-learning">
                                machine-learning
                            </a>
                        </span>
                    </li>
                    <li>
                        <span class="cp-tag recognized-tag">
                            <a href="https://devpost.com/software/built-with/python">
                                python
                            </a>
                        </span>
                    </li>
                    <li>
                        <span class="cp-tag">
                            stacked-autoencoders
                        </span>
                    </li>
                    <li>
                        <span class="cp-tag">
                            wavelet-transform
                        </span>
                    </li>
                </ul>
            </div>
        </div>
    </body>
</html>
