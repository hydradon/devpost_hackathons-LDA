<html>
    <head>
    </head>
    <body>
        <div class="large-9 columns" id="app-details-left">
            <div id="gallery">
                <ul>
                    <li>
                        <div class="flex-video">
                            <iframe allowfullscreen="allowfullscreen" allowscriptaccess="always" class="video-embed" frameborder="0" height="371" mode="transparent" src="https://www.youtube.com/embed/bsf54phUltk?enablejsapi=1&amp;hl=en_US&amp;rel=0&amp;start=&amp;version=3&amp;wmode=transparent" type="text/html" webkitallowfullscreen="true" width="660" wmode="transparent">
                            </iframe>
                        </div>
                    </li>
                </ul>
            </div>
            <div>
                <h2>
                    Meet CLIve
                </h2>
                <p>
                    Hello world, meet CLIve, a serverless Slack bot for AWS. CLIve makes managing your AWS EC2 instances a doddle. He understands natural language, so you can just ask
                    <em>
                        @clive can you stop nginx?
                    </em>
                    and he&rsquo;ll go ahead and do it. It&rsquo;s that simple.
                </p>
                <p>
                    <img alt="Capture" data-canonical-url="https://s3-ap-southeast-2.amazonaws.com/www.clive.chat/slack/capture.gif" src="https://res.cloudinary.com/devpost/image/fetch/s--R_6KimoF--/c_limit,f_auto,fl_lossy,q_auto:eco,w_900/https://s3-ap-southeast-2.amazonaws.com/www.clive.chat/slack/capture.gif">
                </p>
                <p>
                    If one of your instances goes haywire, CLIve can give you a rundown on recent changes to that resource, or even on your entire account.
                </p>
                <p>
                    If you want to get creative, CLIve also supports custom notifications so you can integrate him into pretty much anything!
                </p>
                <p>
                    Go to
                    <a href="https://clive.chat" rel="nofollow">
                        https://clive.chat
                    </a>
                    , click on the 'Add to Slack' button to add CLIve to your team.
                </p>
                <h2>
                    Inspiration
                </h2>
                <p>
                    The AWS CLI is
                    <strong>
                        awesome
                    </strong>
                    ! I use it countless times a day, I can't recommend it enough. The problem? It's a CLI. For newcomers, there are the usual setup and configuration barriers, and then there's the new syntax to learn.
                </p>
                <p>
                    The CLI setup is not straightforward; there's the awkward permissions, user and access key creation dance to undertake. Then there's the configuration of the CLI itself with profiles and regions to navigate. Once complete, your CLI should be ready to run - but how do you start your IIS box?
                    <em>
                        aws start IIS
                    </em>
                    ? Nope. More like,
                </p>
                <blockquote>
                    <p>
                        instanceId=$(aws ec2 describe-instances --filters "Name=tag:Name,Values=IIS" | jq -r .Reservations[].Instances[].InstanceId) &amp;&amp; aws ec2 start-instances --instance-ids $instanceId; aws ec2 wait instance-running --instance-ids $instanceId; unset instanceId;
                    </p>
                </blockquote>
                <p>
                    Yikes!
                </p>
                <p>
                    Whilst the CLI is a necessity for AWS specialists, there's a large number of development and operations teams who require just EC2 start, stop and reboot to get their jobs done; and what's more, they're already getting their work done in Slack. That's the sweet spot where CLIve can help.
                </p>
                <p>
                    You see, there's no CLI in CLIve. Under the hood he's interacting with the same set of AWS APIs, but he's taking care of the setup and configuration, and removing the need for any special syntax. So you can ask something like
                    <em>
                        @clive please start IIS
                    </em>
                    , and he'll get to it!
                </p>
                <h2>
                    How does CLIve work?
                </h2>
                <p>
                    CLIve is serverless. AWS API Gateway and Lambda are CLIve's engine room, as such he uses Slack's Event API to interact with users (rather than Slack RTM).
                </p>
                <p>
                    When you message CLIve, he tries to make sense of what you said by leveraging Wit.ai's natural language processing capabilities. CLIve has been trained to recognise AWS concepts, such as instance state, whilst using everyday vocabulary. For example, you can ask CLIve to start an instance in many different ways, e.g. "start", "boot up", "load up", etc.
                </p>
                <p>
                    Once CLIve has worked out what you want him to do, he begins interacting with AWS APIs. He does this by assuming a role and invoking AWS JavaScript SDK functions with Lambda. CLIve takes care of orchestrating the various API calls. For example to start IIS (just as with the CLI); first he'll describe the instances, then he'll issue a start command, and then he'll wait for the instance to report that it's running.
                </p>
                <p>
                    But how does CLIve help you get setup? To start, there's no need to install any software, just add CLIve to your Slack team. For every chat CLIve is added to, he creates a custom CloudFormation template (to setup the permissions and role he needs to do his thing). Run this template in your AWS account and you're
                    <em>
                        5 clicks
                    </em>
                    away from being setup. The template also contains a custom resource to notify CLIve when you've run the template (so you don't have to copy/paste any CloudFormation outputs). He's not done yet though! Once he receives access to your account, CLIve checks each region for running instances to setup your default region automatically. That's it, not
                    <a href="http://docs.aws.amazon.com/cli/latest/userguide/cli-chap-getting-set-up.html" rel="nofollow">
                        3
                    </a>
                    <a href="http://docs.aws.amazon.com/cli/latest/userguide/installing.html" rel="nofollow">
                        pages
                    </a>
                    <a href="http://docs.aws.amazon.com/cli/latest/userguide/cli-chap-getting-started.html" rel="nofollow">
                        of
                    </a>
                    CLI setup, 5 clicks!
                </p>
                <h2>
                    How I built CLIve
                </h2>
                <p>
                    CLIve is a completely serverless bot. He leverages the following AWS services; Lambda, S3, CloudFront, DynamoDB, Route 53, CloudWatch, CloudFormation, CloudTrail, Config, IAM, Certificate Manager, Kinesis, SNS and API Gateway.
                </p>
                <p>
                    CLIve is built almost entirely from CloudFormation. The exception being Wit.ai.
                </p>
                <p>
                    CLIve was initially trained, by hand, using the Wit.ai web interface. Now that CLIve is integrated with Slack he learns from real user interactions.
                </p>
                <p>
                    The flow which is triggered when a user chats to CLIve on Slack is roughly as follows:
                </p>
                <ol>
                    <li>
                        Slack pushes an event to API Gateway
                    </li>
                    <li>
                        API Gateway triggers a Lambda function (event put)
                    </li>
                    <li>
                        The Lambda function (event put) puts a record onto a Kinesis stream
                    </li>
                    <li>
                        Another Lambda function (event get) reads the record from Kinesis and triggers the main Lambda function (core)
                    </li>
                    <li>
                        The Lambda function (core) gets operational data from DynamoDB and decrypts it with KMS
                    </li>
                    <li>
                        The Lambda function (core) sends the message to Wit.ai for processing
                    </li>
                    <li>
                        Wit.ai extracts any known entities from the message
                    </li>
                    <li>
                        The Lambda function (core) divines the requested action from the parsed entities and triggers downstream Lambda functions (actions)
                    </li>
                    <li>
                        When actions are complete the Lambda function (core) sends a message to Slack
                    </li>
                    <li>
                        Slack pushes the message to the user
                    </li>
                </ol>
                <p>
                    <img alt="Event flow" data-canonical-url="https://s3-ap-southeast-2.amazonaws.com/www.clive.chat/slack/event2.png" src="https://res.cloudinary.com/devpost/image/fetch/s--qKsLW_K7--/c_limit,f_auto,fl_lossy,q_auto:eco,w_900/https://s3-ap-southeast-2.amazonaws.com/www.clive.chat/slack/event2.png">
                </p>
                <p>
                    The setup flow is similar to the above, although slightly more complex, with a Lambda function (authorize) to handle OAuth and additional resources including SNS to handle per channel configuration.
                </p>
                <h2>
                    Challenges I ran into
                </h2>
                <p>
                    Natural language processing isn't ready, yet. CLIve does pretty well responding to expected behaviour. However, humans are mean, and they try to trick him, constantly. Wit.ai, out of the box, doesn't know what to do with completely random messages (more on this below), crazy slang or worse... emojis (which even I, a human, can't translate most of the time).
                </p>
                <p>
                    Of course there were the usual technical challenges too. Kinesis doesn't appear to like cold starts, and doubles up on some messages. The dreaded API rate limiting of course caused more than its fair share of problems - I mean one lookup a second, when the lookup only supports one event per call (despite being called LookupEvent*
                    <em>
                        s
                    </em>
                    *), argh!
                </p>
                <blockquote>
                    <p>
                        The rate of lookup requests is limited to one per second per account. If this limit is exceeded, a throttling error occurs.
                    </p>
                </blockquote>
                <p>
                    <a href="http://docs.aws.amazon.com/awscloudtrail/latest/APIReference/API_LookupEvents.html" rel="nofollow">
                        AWS CloudTrail LookupEvents
                    </a>
                </p>
                <p>
                    API Gateway doesn't (at the time of writing) support Certificate Manager, so I had to spend $$$ on a third party certificate... In truth, these are minor annoyances; it's pretty amazing how much CLIve can do, given he utilises no EC2 at all and costs the equivalent of a cup of coffee to run!
                </p>
                <h2>
                    What I learned
                </h2>
                <p>
                    People want to
                    <strong>
                        date
                    </strong>
                    my bot! Sure, the majority of Slackers use CLIve responsibly, but a significant percentage try to chat him up! It goes without saying that CLIve doesn't know how to respond to such advances. Similarly, users often send him gobbledygook, ask him to book a taxi or some other crazy request. Whilst natural language technology definitely has some way to go, it appears that humans also have a bit of growing up to do!
                </p>
                <h2>
                    What's next for CLIve, a serverless Slack bot for AWS
                </h2>
                <p>
                    There's still some tidying up to do! He could use a little bit of error handling TLC and refactoring (especially of the core function). There's also a list of feature requests I'm steadily working through. If you'd like to submit a bug report, or feature request, please do so here,
                    <a href="https://clive.zendesk.com/hc/en-us/requests/new" rel="nofollow">
                        https://clive.zendesk.com/hc/en-us/requests/new
                    </a>
                    .
                </p>
            </div>
            <div class="" id="built-with">
                <h2>
                    Built With
                </h2>
                <ul class="no-bullet inline-list">
                    <li>
                        <span class="cp-tag recognized-tag">
                            <a href="https://devpost.com/software/built-with/amazon-dynamodb">
                                amazon-dynamodb
                            </a>
                        </span>
                    </li>
                    <li>
                        <span class="cp-tag">
                            api-gateway
                        </span>
                    </li>
                    <li>
                        <span class="cp-tag">
                            kinesis
                        </span>
                    </li>
                    <li>
                        <span class="cp-tag">
                            kms
                        </span>
                    </li>
                    <li>
                        <span class="cp-tag">
                            lambda
                        </span>
                    </li>
                    <li>
                        <span class="cp-tag recognized-tag">
                            <a href="https://devpost.com/software/built-with/slack">
                                slack
                            </a>
                        </span>
                    </li>
                    <li>
                        <span class="cp-tag recognized-tag">
                            <a href="https://devpost.com/software/built-with/wit-ai">
                                wit.ai
                            </a>
                        </span>
                    </li>
                </ul>
            </div>
            <nav class="app-links section">
                <h2>
                    Try it out
                </h2>
                <ul class="no-bullet" data-role="software-urls">
                    <li>
                        <a href="https://clive.chat" rel="nofollow" target="_blank" title="https://clive.chat">
                            <i class="ss-icon ss-link">
                            </i>
                            <span>
                                clive.chat
                            </span>
                        </a>
                    </li>
                </ul>
            </nav>
        </div>
    </body>
</html>
