<html>
    <head>
    </head>
    <body>
        <div class="large-9 columns" id="app-details-left">
            <div id="gallery">
                <ul>
                    <li>
                        <div class="flex-video">
                            <iframe allowfullscreen="allowfullscreen" allowscriptaccess="always" class="video-embed" frameborder="0" height="371" mode="transparent" src="https://www.youtube.com/embed/yNmgKCNmmo8?enablejsapi=1&amp;hl=en_US&amp;rel=0&amp;start=&amp;version=3&amp;wmode=transparent" type="text/html" webkitallowfullscreen="true" width="660" wmode="transparent">
                            </iframe>
                        </div>
                    </li>
                    <li class="text-center">
                        <a data-lightbox="816010" href="https://challengepost-s3-challengepost.netdna-ssl.com/photos/production/software_photos/000/816/010/datas/original.png">
                            <img alt="LN Quake &ndash; screenshot 1" class="software_photo_image image-replacement" onerror="this.onerror=null;this.src='https://devpost-challengepost.netdna-ssl.com/assets/defaults/thumbnail-placeholder-42bcab8d8178b413922ae2877d8b0868.gif';" src="//challengepost-s3-challengepost.netdna-ssl.com/photos/production/software_photos/000/816/010/datas/gallery.jpg">
                        </a>
                        <span class="expand-tag">
                            <i class="fas fa-expand">
                            </i>
                        </span>
                        <p>
                            <i>
                            </i>
                        </p>
                    </li>
                    <li class="text-center">
                        <a data-lightbox="816011" href="https://challengepost-s3-challengepost.netdna-ssl.com/photos/production/software_photos/000/816/011/datas/original.png">
                            <img alt="LN Quake &ndash; screenshot 2" class="software_photo_image image-replacement" onerror="this.onerror=null;this.src='https://devpost-challengepost.netdna-ssl.com/assets/defaults/thumbnail-placeholder-42bcab8d8178b413922ae2877d8b0868.gif';" src="//challengepost-s3-challengepost.netdna-ssl.com/photos/production/software_photos/000/816/011/datas/gallery.jpg">
                        </a>
                        <span class="expand-tag">
                            <i class="fas fa-expand">
                            </i>
                        </span>
                        <p>
                            <i>
                            </i>
                        </p>
                    </li>
                    <li class="text-center">
                        <a data-lightbox="816012" href="https://challengepost-s3-challengepost.netdna-ssl.com/photos/production/software_photos/000/816/012/datas/original.png">
                            <img alt="LN Quake &ndash; screenshot 3" class="software_photo_image image-replacement" onerror="this.onerror=null;this.src='https://devpost-challengepost.netdna-ssl.com/assets/defaults/thumbnail-placeholder-42bcab8d8178b413922ae2877d8b0868.gif';" src="//challengepost-s3-challengepost.netdna-ssl.com/photos/production/software_photos/000/816/012/datas/gallery.jpg">
                        </a>
                        <span class="expand-tag">
                            <i class="fas fa-expand">
                            </i>
                        </span>
                        <p>
                            <i>
                            </i>
                        </p>
                    </li>
                    <li class="text-center">
                        <a data-lightbox="816013" href="https://challengepost-s3-challengepost.netdna-ssl.com/photos/production/software_photos/000/816/013/datas/original.png">
                            <img alt="LN Quake &ndash; screenshot 4" class="software_photo_image image-replacement" onerror="this.onerror=null;this.src='https://devpost-challengepost.netdna-ssl.com/assets/defaults/thumbnail-placeholder-42bcab8d8178b413922ae2877d8b0868.gif';" src="//challengepost-s3-challengepost.netdna-ssl.com/photos/production/software_photos/000/816/013/datas/gallery.jpg">
                        </a>
                        <span class="expand-tag">
                            <i class="fas fa-expand">
                            </i>
                        </span>
                        <p>
                            <i>
                            </i>
                        </p>
                    </li>
                </ul>
            </div>
            <div>
                <h1>
                    LN Quake
                </h1>
                <p>
                    LN Quake is a game based on QuakeJS, a port of ioquake to JS. LN Quake adds Lightning Network into the mix, by allowing players to battle with each other to win Satoshis. Just install Joule and get ready to win some #sats!
                </p>
                <p>
                    The idea of games where people can win Satoshis is not new, but what makes this project unique is the fact that none of the players have to deposit/withdraw money to/from a third party service: all the payments are made
                    <strong>
                        directly
                    </strong>
                    between the players, while the server sits in between just to coordinate and to choose which payments can go through and which cannot (while also, potentially, taking a fee for this service).
                </p>
                <p>
                    This is done thanks to the new "hooks" integrated in c-lightning that allow plugins to have a very precise control on which HTLCs can be routed through the node. Players will pay each other with routes that pass through one of the game's servers, so that the payments can be kept on hold until the game finishes.
                </p>
                <p>
                    The concept is very similar to a "2-of-3" escrow multisig, but since all of that happens on the Lightning Network, players can bet even very small amounts and the fact that the number of payments grows quadratically with the number of players becomes almost irrelevant. Moreover, players can participate with their own "normal" wallets, and there's no need to construct convoluted scripts and transactions, since Lightning handles all of that for you.
                </p>
                <p>
                    While this specific project is designed mostly to entertain people, I think the idea of having an "oracle" on the Lightning network could be very powerful, even for more complex or "serious" applications.
                </p>
                <h2>
                    Project Structure
                </h2>
                <p>
                    To speed up the development during the hackathon, the "C" part (the original ioq3 code) has almost been left untouched: this increased the complexity of the whole project a little bit, because instead of having one nice daemon running, there are now two daemons, where one is a "wrapper" over the other, and it is responsible to start and manage it.
                </p>
                <p>
                    So, the final structure is composed by:
                </p>
                <ul>
                    <li>
                        a
                        <code>
                            content
                        </code>
                        server, which acts as a "filesystem" for IOQ3 to download his files
                    </li>
                    <li>
                        a
                        <code>
                            web
                        </code>
                        server which servers the index web page
                    </li>
                    <li>
                        a
                        <code>
                            controller
                        </code>
                        made as c-lightning plugin (it is started by Lightningd)
                        <ul>
                            <li>
                                the original
                                <code>
                                    ioq3ded
                                </code>
                                which is started by the controller
                            </li>
                        </ul>
                    </li>
                </ul>
                <p>
                    This project is also loosely derived from
                    <a href="https://github.com/afilini/ln-auctions" rel="nofollow">
                        ln-auctions
                    </a>
                    , mostly for some low-level c-lightning plugin utils.
                </p>
                <h2>
                    How to run
                </h2>
                <p>
                    You should follow the instructions down below for a first run/setup (to accept the EULA, etc), and then you should be able to use
                    <code>
                        lnquake/index.js
                    </code>
                    as a c-lightning plugin to start the whole system. The code is setup to work on HTTPS, which means that you should replace the "official" content server with a proxy (you could setup your own or use mine at
                    <code>
                        https://quake-content.afilini.com
                    </code>
                    ).
                </p>
                <p>
                    Don't forget the two
                    <code>
                        npm install
                    </code>
                    s, one in the root and one in
                    <code>
                        lnquake/
                    </code>
                    .
                </p>
                <p>
                    Also, you should use a development version of c-lightning, specifically from the "htlc_accepted_hook" branch.
                </p>
                <h2>
                    How to build
                </h2>
                <p>
                    Well, that's a very good question. The "original" QuakeJS is pretty old and refuses to build with modern versions of Emscripten. There's a fork (the one on which I based my code) which was supposed to work with modern compilers, but I dind't have any luck with it: in particular, every time I tried to rebuild the client (
                    <code>
                        ioquake3.js
                    </code>
                    ) it would always crash with some GLSL exceptions, even if all the shaders were untouched! I ended up reusing the client from the GitHub repo (which also forced me to "wrap" some extra code around it, instead of just patching it).
                </p>
                <p>
                    The server (
                    <code>
                        ioq3ded.{js,wasm}
                    </code>
                    ) should compile with a modern toolchain (I personally used
                    <code>
                        emcc 1.38.34
                    </code>
                    ), but if you just want to play I strongly suggest to use the prebuilt files in
                    <code>
                        build/
                    </code>
                    . They should "Just Work" (TM).
                </p>
            </div>
            <div class="" id="built-with">
                <h2>
                    Built With
                </h2>
                <ul class="no-bullet inline-list">
                    <li>
                        <span class="cp-tag">
                            c+
                        </span>
                    </li>
                    <li>
                        <span class="cp-tag recognized-tag">
                            <a href="https://devpost.com/software/built-with/c--3">
                                c++
                            </a>
                        </span>
                    </li>
                    <li>
                        <span class="cp-tag recognized-tag">
                            <a href="https://devpost.com/software/built-with/html">
                                html
                            </a>
                        </span>
                    </li>
                    <li>
                        <span class="cp-tag recognized-tag">
                            <a href="https://devpost.com/software/built-with/javascript">
                                javascript
                            </a>
                        </span>
                    </li>
                    <li>
                        <span class="cp-tag">
                            lightning-joule-lnd
                        </span>
                    </li>
                    <li>
                        <span class="cp-tag recognized-tag">
                            <a href="https://devpost.com/software/built-with/node-js">
                                node.js
                            </a>
                        </span>
                    </li>
                </ul>
            </div>
            <nav class="app-links section">
                <h2>
                    Try it out
                </h2>
                <ul class="no-bullet" data-role="software-urls">
                    <li>
                        <a href="https://github.com/afilini/quakejs" rel="nofollow" target="_blank" title="https://github.com/afilini/quakejs">
                            <i class="ss-icon ss-link">
                            </i>
                            <span>
                                github.com
                            </span>
                        </a>
                    </li>
                </ul>
            </nav>
        </div>
    </body>
</html>
