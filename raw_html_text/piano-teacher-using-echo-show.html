<html>
    <head>
    </head>
    <body>
        <div class="large-9 columns" id="app-details-left">
            <div id="gallery">
                <ul>
                    <li>
                        <div class="flex-video">
                            <iframe allowfullscreen="allowfullscreen" allowscriptaccess="always" class="video-embed" frameborder="0" height="371" mode="transparent" src="https://www.youtube.com/embed/sgxsWNA_c8o?enablejsapi=1&amp;hl=en_US&amp;rel=0&amp;start=&amp;version=3&amp;wmode=transparent" type="text/html" webkitallowfullscreen="true" width="660" wmode="transparent">
                            </iframe>
                        </div>
                    </li>
                </ul>
            </div>
            <div>
                <h2>
                    How to Play
                </h2>
                <p>
                    This Alexa skill works for all devices, but it is optimized for the Echo Show.  Just use your voice, and ask how to play the piano.  There are different activities that are perfect for the beginner. With the Echo Show, the screen is used as a video player that shows animations of a piano keyboard with the notes highlighted for the student. This is paired with the audio experience of an Alexa to encourage and entertain the millions of children that study the piano every year.
                </p>
                <h2>
                    What it does
                </h2>
                <p>
                    Learning how to play the piano takes practice, and who has better patience when you are starting out than Alexa? Beginning to learn the Piano takes plenty of practice, and learning the basics, including how to read notes, and building the skills to hear them played correctly.  The Alexa skill does just that, with several features to help enable learning.
                </p>
                <p>
                    <strong>
                        Step 1 - Piano Basics
                    </strong>
                </p>
                <p>
                    There are some great beginner lessons that teach the basics, including how to recognize the notes on a scale, and learn foundational concepts like keys and chords. Alexa not only provides instruction with words, the skill uses recordings of a piano playing to immerse the student into the music.
                </p>
                <p>
                    <strong>
                        Step 2 - Learn how to recognize notes
                    </strong>
                </p>
                <p>
                    Within the skill is a simple, but fun game that teaches note recognition. Alexa will "play" individual notes, then provide the student the opportunity to guess which note was played. The game tracks how many correct guesses are made in a row, and encourages the student along the way.
                </p>
                <p>
                    <strong>
                        Step 3 - Learn how to play a Song
                    </strong>
                </p>
                <p>
                    Once the student has learned some basics, they can begin to learn some songs. Alexa uses both words, sound, and for those with an Echo Show - videos to instruct how to play classics like Twinkle Twinkle Little Star.
                </p>
                <h2>
                    How we built it
                </h2>
                <p>
                    There are two main components - the Alexa skill, as well as the content that the skill leverages.  The skill can be enabled for any Alexa, and uses the Natural Language processing of Alexa to determine the intent from voice requests that are received by the device.  There is an AWS Lambda function to handle the logic required to satisfy the intents.  For example, if the request is to "list songs" the function gathers the songs and forms the JSON response needed by the Alexa platform.  There is also an S3 bucket that is accessible through the internet that contains all of the multimedia that will be played by the Alexa device upon request.  Creating the content that is stored on S3 was a combination of mobile and desktop tools.
                </p>
                <p>
                    <img alt="" data-canonical-url="https://s3.amazonaws.com/pianoplayerskill/logos/pianoSkillArchitecture.png" src="https://res.cloudinary.com/devpost/image/fetch/s--sL7gNb_Z--/c_limit,f_auto,fl_lossy,q_auto:eco,w_900/https://s3.amazonaws.com/pianoplayerskill/logos/pianoSkillArchitecture.png">
                </p>
                <p>
                    The following goes through the details, and a link to the GitHub repo that this is contained in is attached to this writeup.
                </p>
                <p>
                    <strong>
                        The Alexa Skill
                    </strong>
                </p>
                <p>
                    The
                    <a href="https://www.amazon.com/Piano-Teacher-video-Echo-Show/dp/B078M9843X" rel="nofollow">
                        Piano Teacher Skill
                    </a>
                    has been published through the Alexa certification process.
                </p>
                <ul>
                    <li>
                        This is a custom skill that is published for users to enable onto their devices.  It is compatible with all of them, however with devices that have a video screen (the Echo Show and Spot), there are additional visual features.  Here's a screenshot from the skill.
                    </li>
                </ul>
                <p>
                    <img alt="" data-canonical-url="https://s3.amazonaws.com/pianoplayerskill/images/ScreenShotExample.png" src="https://res.cloudinary.com/devpost/image/fetch/s--vC3D8kaU--/c_limit,f_auto,fl_lossy,q_auto:eco,w_900/https://s3.amazonaws.com/pianoplayerskill/images/ScreenShotExample.png">
                </p>
                <ul>
                    <li>
                        <p>
                            The skill uses the most recent Alexa SDK for NodeJS. This can be found on the
                            <a href="https://github.com/alexa/alexa-skills-kit-sdk-for-nodejs" rel="nofollow">
                                Alexa organization
                            </a>
                            on GitHub.
                        </p>
                    </li>
                    <li>
                        <p>
                            The custom skill uses Video App Directives in the instruction of playing songs as well as some of the lessons. These directives enable rendering of a MP4 file onto the screen. Here is the code within the skill that enables this, along with the attribute in the NodeJS SDK that verifies that the requesting device has a screen. It is important to not provide these responses to all devices as it will throw exceptions.
                        </p>
                    </li>
                </ul>
                <pre class="language-nolang"><code>if (this.event.context.System.device.supportedInterfaces.VideoApp) {
                                                const videoClip = videoLoc + 'BasicScale.mp4';
            const metadata = {
            'title': 'Basic Note Drill'
            };
            this.response.playVideo(videoClip, metadata);
}
</code></pre>
                <ul>
                    <li>
                        The skill also uses Render Template Directives. This enables background images and lists to be rendered onto an Echo Show. Here is the code for rendering the initial background onto the device.
                    </li>
                </ul>
                <pre class="language-nolang"><code>// these are utility methods used throughout the skill
const makeImage     = Alexa.utils.ImageUtils.makeImage;
const makePlainText = Alexa.utils.TextUtils.makePlainText;

// this is the location of the background image in my S3 bucket
const musicBackground = 'https://s3.amazonaws.com/pianoplayerskill/logos/pianoKeyboard.jpg';

// these are the audio attributes passed in the response
const welcomeMessage = "Welcome to the piano teacher skill, your personal instructor. " +
"To get started, say 'List Lessons', 'List Songs', or 'Play musical note guessing game'.";
const repeatWelcomeMessage = "You are currently using the piano teacher skill. This skill is designed " +
"to teach beginner lessons on the piano. Say something like, Teach me how to play " +
"Mary Had a Little Lamb, to get started, or ask for help.";

// this is the code local to the function that renders the image
const builder = new Alexa.templateBuilders.BodyTemplate1Builder();
const imageLoc = musicBackground;
const template = builder.setTitle('Your Personal Instructor')
.setBackgroundImage(makeImage(imageLoc))
.setTextContent(makePlainText('Piano Teacher'))
.build();
this.response.speak(welcomeMessage).listen(repeatWelcomeMessage).renderTemplate(template);
this.emit(':responseReady');
</code></pre>
                <ul>
                    <li>
                        <p>
                            When rendering a video list, your skill must be able to handle the 'ElementSelected' event. This event gets triggered if the user taps on a song in the list rather than it coming through an utterance. When building the list, each item on the list will be given a unique token, then the token will be passed back in this event. For example, Mary Had a Little Lamb has the unique token "song002" that is tagged when building the list. If the student selects this song on the device screen, the token is passed in with the event, so the response can be to play this specific song.
                        </p>
                    </li>
                    <li>
                        <p>
                            When using these directives, you must indicate this within the Alexa developer console.  Here is a screenshot of the fields that need to be selected. This also requires additional intents to be supported.
                        </p>
                    </li>
                </ul>
                <p>
                    <img alt="" data-canonical-url="https://s3.amazonaws.com/pianoplayerskill/logos/setVideoDirective.png" src="https://res.cloudinary.com/devpost/image/fetch/s--7JjNCtnC--/c_limit,f_auto,fl_lossy,q_auto:eco,w_900/https://s3.amazonaws.com/pianoplayerskill/logos/setVideoDirective.png">
                </p>
                <ul>
                    <li>
                        The skill also uses SSML to incorporate more than just the Alexa voice. This requires control characters to be added similar to HTML. For example, a brief three second delay can be included by using the "break time" markup. The game also plays mp3 files which must marked up with the "audio src" markup. Here is a sample of how the markup looks within the Lambda function.
                    </li>
                </ul>
                <pre class="language-nolang"><code>const audioMessage = 'Okay, get ready to play the scale starting with the ' +
                                                                'middle C, then go up a white key until you hit the high C.' +
                '&lt;break time="3s"/&gt;' +
                '&lt;audio src=\"' + audioLoc + 'PianoScale.mp3\" /&gt;' +
                '&lt;break time="3s"/&gt;' +
                'Would you like to play again? If so, say, Play the scale. ' +
                'If you would like to play in reverse, say, Play scale in reverse.';
const repeatMessage = 'If you want to try again, say, Play the scale. ' +
'To play in reverse, say, Play scale in reverse.';

this.response.speak(audioMessage).listen(repeatMessage);
</code></pre>
                <ul>
                    <li>
                        To make the game more exciting, we are using interjections. This can be done through SSML using markup that looks like this.
                    </li>
                </ul>
                <pre class="language-nolang"><code>// this is added to the game response when the student has gotten multiple note guesses in a row correct.
musicGuessMessage = musicGuessMessage + "That makes " + numCorrect + " in a row. " +
"&lt;say-as interpret-as=\"interjection\"&gt;way to go!&lt;/say-as&gt;" +
"&lt;break time=\"1s\"/&gt;";
</code></pre>
                <p>
                    <strong>
                        The Piano Content
                    </strong>
                </p>
                <p>
                    Building the content was a project all by itself. As you get started, it's important to learn what the
                    <a href="https://developer.amazon.com/docs/custom-skills/videoapp-interface-reference.html" rel="nofollow">
                        standards
                    </a>
                    are for Alexa devices. It's important to note that your skill will just pass the endpoint for the MP4 file, the the device will handle the streaming. The maximum resolution is 1280x720, so don't attempt to use 4k videos (yet).
                </p>
                <p>
                    Similarly for the
                    <a href="https://developer.amazon.com/docs/custom-skills/speech-synthesis-markup-language-ssml-reference.html#audio" rel="nofollow">
                        audio files
                    </a>
                    . They must be in a MP3 format, and must not be longer than 90 seconds. The response objects will just provide the endpoint where the media is located on the internet, then the device will handle the streaming - not the skill. The files must also have a bit rate of 48 kbps, and the sample rate must be 16000 Hz.
                </p>
                <p>
                    1 - We started by selecting some basic songs from the public domain. Music has strong intellectual property rights, and its important to respect them. Music that has been around for a long time (i.e. &gt; 75 years) is a good place to start, so songs like "Twinkle Twinkle Little Star" are good.
                </p>
                <p>
                    2 - We then took pictures of a piano keyboard, and loaded them onto our computer.
                </p>
                <p>
                    3 - Next we recorded audio on a phone of us playing these songs on our piano. We then uploaded them onto our computer, and manipulated them using Audacity to meet the mp3 attributes required by Alexa (bit &amp; sample rates).
                </p>
                <p>
                    4 - Created an s3 bucket to store media used by the skill. I did this through the AWS Console.
                </p>
                <p>
                    5 - Uploaded the audio to the s3 bucket.
                </p>
                <p>
                    6 - Created mp4 files using Camtasia software on a computer. There are other software tools that you can use, and the important thing is to be able to produce the media that will teach the students which notes to play.
                </p>
                <p>
                    In creating these files, there is a concept of layers that allows combining the background images, audio files, and instructions on which note should be played. For each video, combined the audio with the photo of the piano keys, and added animation that highlighted which key should be played in synch with the music. Here is a screenshot of how these layers look (called tracks in the software).
                </p>
                <p>
                    <img alt="" data-canonical-url="https://s3.amazonaws.com/pianoplayerskill/logos/camtasia.png" src="https://res.cloudinary.com/devpost/image/fetch/s--nhJTJ-Ga--/c_limit,f_auto,fl_lossy,q_auto:eco,w_900/https://s3.amazonaws.com/pianoplayerskill/logos/camtasia.png">
                </p>
                <p>
                    7 - Once these files were created, the were uploaded to the same s3 bucket as the audio files, just into another folder.
                </p>
                <p>
                    8 - Within the Alexa skill is a
                    <a href="https://github.com/terrenjpeterson/pianoplayer/blob/master/data/songs.json" rel="nofollow">
                        json object
                    </a>
                    that contains the media object names that we uploaded into S3. The requestName matches the custom slot that we created within the skill, and the Lambda function does the matching based on the user request. This will allow us to continue to publish more content to the skill with minimal coding.
                </p>
                <pre class="language-nolang"><code>[
                {
                "requestName": "Silent Night",
                "listSong":true,
                "token":"song001",
                "difficulty":"Moderate",
                "videoObject": "SilentNight.mp4",
                "audioObject": "SilentNight.mp3"
    },
    {
    "requestName": "Mary Had a Little Lamb",
    "listSong":true,
    "token":"song002",
    "difficulty":"Easy",
    "videoObject": "MaryHadLittleLamb.mp4",
    "audioObject": "MaryHadLittleLamb.mp3"
    },
</code></pre>
                <h2>
                    Challenges we ran into
                </h2>
                <p>
                    The Echo Show has only been around for six months, so there aren't many skills yet that have incorporated its features. We wanted to make sure that the skill was compatible with all devices, so this made coding and testing the Alexa skill a little more challenging.
                </p>
                <h2>
                    Accomplishments that we're proud of
                </h2>
                <p>
                    The skill has been approved in the Alexa store, and is now being used by others to learn how to play the piano. Given that the piano is the most popular musical instrument to play, with an estimated 6 million students learning it in just the US, there is a huge market for those that can try this out.
                </p>
                <h2>
                    What we learned
                </h2>
                <p>
                    We learned that you can create an Alexa Skill that works just like your very own YouTube channel.  Before this project, we had not used the Video App Directives that are required for these features to work.  It also has been a great opportunity to improve our video content creation skills as every song took a few hours to create.
                </p>
                <h2>
                    What's next for Piano Teacher using Echo Show
                </h2>
                <p>
                    We are continuing to record more songs and upload them to be used by the Skill. If anyone has favorites, please let us know!
                </p>
            </div>
            <div class="" id="built-with">
                <h2>
                    Built With
                </h2>
                <ul class="no-bullet inline-list">
                    <li>
                        <span class="cp-tag recognized-tag">
                            <a href="https://devpost.com/software/built-with/amazon-alexa">
                                amazon-alexa
                            </a>
                        </span>
                    </li>
                    <li>
                        <span class="cp-tag recognized-tag">
                            <a href="https://devpost.com/software/built-with/camtasia">
                                camtasia
                            </a>
                        </span>
                    </li>
                    <li>
                        <span class="cp-tag">
                            echo-show
                        </span>
                    </li>
                    <li>
                        <span class="cp-tag">
                            lambda
                        </span>
                    </li>
                    <li>
                        <span class="cp-tag recognized-tag">
                            <a href="https://devpost.com/software/built-with/node-js">
                                node.js
                            </a>
                        </span>
                    </li>
                    <li>
                        <span class="cp-tag">
                            s3
                        </span>
                    </li>
                </ul>
            </div>
            <nav class="app-links section">
                <h2>
                    Try it out
                </h2>
                <ul class="no-bullet" data-role="software-urls">
                    <li>
                        <a href="https://github.com/terrenjpeterson/pianoplayer" rel="nofollow" target="_blank" title="https://github.com/terrenjpeterson/pianoplayer">
                            <i class="ss-icon ss-link">
                            </i>
                            <span>
                                github.com
                            </span>
                        </a>
                    </li>
                    <li>
                        <a href="https://www.amazon.com/Piano-Teacher-video-Echo-Show/dp/B078M9843X" rel="nofollow" target="_blank" title="https://www.amazon.com/Piano-Teacher-video-Echo-Show/dp/B078M9843X">
                            <i class="ss-icon ss-link">
                            </i>
                            <span>
                                www.amazon.com
                            </span>
                        </a>
                    </li>
                </ul>
            </nav>
        </div>
    </body>
</html>
