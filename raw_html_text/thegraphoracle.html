<html>
    <head>
    </head>
    <body>
        <div class="large-9 columns" id="app-details-left">
            <div id="gallery">
                <ul>
                    <li class="text-center">
                        <a data-lightbox="830261" href="https://challengepost-s3-challengepost.netdna-ssl.com/photos/production/software_photos/000/830/261/datas/original.png">
                            <img alt="The Graph Oracle &ndash; screenshot 1" class="software_photo_image image-replacement" onerror="this.onerror=null;this.src='https://devpost-challengepost.netdna-ssl.com/assets/defaults/thumbnail-placeholder-42bcab8d8178b413922ae2877d8b0868.gif';" src="//challengepost-s3-challengepost.netdna-ssl.com/photos/production/software_photos/000/830/261/datas/gallery.jpg">
                        </a>
                        <span class="expand-tag">
                            <i class="fas fa-expand">
                            </i>
                        </span>
                        <p>
                            <i>
                            </i>
                        </p>
                    </li>
                    <li class="text-center">
                        <a data-lightbox="830266" href="https://challengepost-s3-challengepost.netdna-ssl.com/photos/production/software_photos/000/830/266/datas/original.png">
                            <img alt="The Graph Oracle &ndash; screenshot 2" class="software_photo_image image-replacement" onerror="this.onerror=null;this.src='https://devpost-challengepost.netdna-ssl.com/assets/defaults/thumbnail-placeholder-42bcab8d8178b413922ae2877d8b0868.gif';" src="//challengepost-s3-challengepost.netdna-ssl.com/photos/production/software_photos/000/830/266/datas/gallery.jpg">
                        </a>
                        <span class="expand-tag">
                            <i class="fas fa-expand">
                            </i>
                        </span>
                        <p>
                            <i>
                            </i>
                        </p>
                    </li>
                    <li class="text-center">
                        <a data-lightbox="830280" href="https://challengepost-s3-challengepost.netdna-ssl.com/photos/production/software_photos/000/830/280/datas/original.png">
                            <img alt="The Graph Oracle &ndash; screenshot 3" class="software_photo_image image-replacement" onerror="this.onerror=null;this.src='https://devpost-challengepost.netdna-ssl.com/assets/defaults/thumbnail-placeholder-42bcab8d8178b413922ae2877d8b0868.gif';" src="//challengepost-s3-challengepost.netdna-ssl.com/photos/production/software_photos/000/830/280/datas/gallery.jpg">
                        </a>
                        <span class="expand-tag">
                            <i class="fas fa-expand">
                            </i>
                        </span>
                        <p>
                            <i>
                            </i>
                        </p>
                    </li>
                    <li class="text-center">
                        <a data-lightbox="830291" href="https://challengepost-s3-challengepost.netdna-ssl.com/photos/production/software_photos/000/830/291/datas/original.png">
                            <img alt="The Graph Oracle &ndash; screenshot 4" class="software_photo_image image-replacement" onerror="this.onerror=null;this.src='https://devpost-challengepost.netdna-ssl.com/assets/defaults/thumbnail-placeholder-42bcab8d8178b413922ae2877d8b0868.gif';" src="//challengepost-s3-challengepost.netdna-ssl.com/photos/production/software_photos/000/830/291/datas/gallery.jpg">
                        </a>
                        <span class="expand-tag">
                            <i class="fas fa-expand">
                            </i>
                        </span>
                        <p>
                            <i>
                            </i>
                        </p>
                    </li>
                </ul>
            </div>
            <div>
                <h1>
                    The Graph Oracle
                </h1>
                <p>
                    The Graph Oracle (TGO) provides an oracle that allows users to exploit the power of the Graph directly from their smart contracts.
                </p>
                <pre class="language-javascript"><code>// Define query
string memory _queryString = "{cryptoKitties(where:{birthTime_gte:1514761200,birthTime_lt:1519858800},first:10) {owner}}";
// Define call back function that would be called when the query is completed
bytes4 _callback = bytes4(keccak256("updateKittyOwner(address[])"));
// Execute the query
oracle.createQuery(_queryHash, _company, _product, _queryString, false, _callback);
</code></pre>
                <h2>
                    Inspiration
                </h2>
                <p>
                    Currently its not possible to do even simple queries on EThereum data  from smart contracts.
                </p>
                <blockquote>
                    <p>
                        Get the address of owners of crytokitties born in January
                    </p>
                    <p>
                        Get the last 5 domain names registred in ENS last month.
                    </p>
                </blockquote>
                <p>
                    If we can make queries like this from smart contracts we can build even more powerful applications on EThereum. So  we decided to solve this problem in the hackathon by builting an Oracle for The Graph.
                </p>
                <p>
                    <a href="https://www.mycryptopedia.com/blockchain-oracles-explained/" rel="nofollow">
                        Oracles
                    </a>
                    are a third-party information source that allow smart contracts to process data coming from the real world directly on the blockchain. They are based on trusted agents, off-chain entities that provide the data.
                </p>
                <p>
                    <a href="https://thegraph.com/" rel="nofollow">
                        The Graph
                    </a>
                    is a powerful tool that allows users to query data from leading decentralized projects using an
                    <em>
                        off-chain
                    </em>
                    API.
                </p>
                <p>
                    TGO is the last piece of the puzzle, bridging the Graph queries and making them available directly to the blockchain.
                </p>
                <p>
                    We leverage the capabilities of
                    <a href="https://skalelabs.com/" rel="nofollow">
                        Skale Sidechains
                    </a>
                    to have lightning fast oraclized Graph queries. Furthermore, using the Skale decentralized file storage API we store the result of queries of any level of complexity, returning their storage ID to retrieve them.
                </p>
                <p>
                    We wrote and deployed the
                    <a href="https://thegraph.com/explorer/subgraph/ricott1/the-graph-oracle" rel="nofollow">
                        the TGO subgraph
                    </a>
                    on ropsten, to get data on the oracle itself.
                </p>
                <h2>
                    How we built it
                </h2>
                <p>
                    The backbone of TGO is
                    <code>
                        theGraphOracle.sol
                    </code>
                    smart contract, written in solidity. The off-chain agent is a python script logging to the oracle events, performing the off-chain API calls and submitting the results. The TGO subgraph is built in graphql.
                </p>
                <h2>
                    How does it work
                </h2>
                <p>
                    TGO works as follows:
                </p>
                <ul>
                    <li>
                        A smart contract creates a query calling
                        <code>
                            createQuery
                        </code>
                        and passing the query company, product and string as parameters
                    </li>
                    <li>
                        <code>
                            theGraphOracle
                        </code>
                        emits a
                        <code>
                            QueryCreated
                        </code>
                        event, which the off-chain agent intercepts
                    </li>
                    <li>
                        The off-chain agent performs the query on the Graph API and returns the result (in array form) to the original querying contract by calling a callback function
                    </li>
                    <li>
                        If the query has the
                        <code>
                            _isStorage
                        </code>
                        flag, the agent stores the result in a file using the Skale storage API
                    </li>
                </ul>
                <p>
                    Query examples are provided by the
                    <code>
                        TestCase.sol
                    </code>
                    contract.
                </p>
                <h2>
                    Example query
                </h2>
                <p>
                    Call
                    <code>
                        queryENS()
                    </code>
                    in
                    <code>
                        TestCase.sol
                    </code>
                    on Ropsten. This creates a query that calls
                    <code>
                        createQuery()
                    </code>
                    in
                    <code>
                        theGraphOracle.sol
                    </code>
                    . In the
                    <a href="https://thegraph.com/explorer/subgraph/ricott1/the-graph-oracle" rel="nofollow">
                        subgraph
                    </a>
                    now displays the new query. When the agent calls
                    <code>
                        updateQuery()
                    </code>
                    , a result event will be emitted and the subgraph will display the result of the query.
                </p>
                <h2>
                    What's next
                </h2>
                <p>
                    Ideally we would like to provide users with more flexible queries, allowing them to get arbitrary JSON data instead of only arrays. To this goal, using the Skale sidechain to perform the on-chain computational intensive calls would avoid incurring into large gas costs. The message interface would then bridge calls from the mainchain to the oracle deployed on the Skal sidechain.
                </p>
                <h2>
                    Contracts
                </h2>
                <p>
                    Address of Oracle and test contract in Ropsten
                </p>
                <p>
                    oracle addr: 0x48e999889bc137bb4dcc2e28f9731ff9d5075084
testcase addr: 0xa87825c3c77dce3292eee1a0ab71e40557bd99ac
                </p>
            </div>
            <div class="" id="built-with">
                <h2>
                    Built With
                </h2>
                <ul class="no-bullet inline-list">
                    <li>
                        <span class="cp-tag">
                            graphql
                        </span>
                    </li>
                    <li>
                        <span class="cp-tag recognized-tag">
                            <a href="https://devpost.com/software/built-with/python">
                                python
                            </a>
                        </span>
                    </li>
                    <li>
                        <span class="cp-tag">
                            skale
                        </span>
                    </li>
                    <li>
                        <span class="cp-tag recognized-tag">
                            <a href="https://devpost.com/software/built-with/solidity">
                                solidity
                            </a>
                        </span>
                    </li>
                    <li>
                        <span class="cp-tag">
                            thegraph
                        </span>
                    </li>
                    <li>
                        <span class="cp-tag">
                            web3
                        </span>
                    </li>
                </ul>
            </div>
            <nav class="app-links section">
                <h2>
                    Try it out
                </h2>
                <ul class="no-bullet" data-role="software-urls">
                    <li>
                        <a href="https://github.com/ricott1/theGraphOracle" rel="nofollow" target="_blank" title="https://github.com/ricott1/theGraphOracle">
                            <i class="ss-icon ss-link">
                            </i>
                            <span>
                                github.com
                            </span>
                        </a>
                    </li>
                    <li>
                        <a href="https://thegraph.com/explorer/subgraph/ricott1/the-graph-oracle" rel="nofollow" target="_blank" title="https://thegraph.com/explorer/subgraph/ricott1/the-graph-oracle">
                            <i class="ss-icon ss-link">
                            </i>
                            <span>
                                thegraph.com
                            </span>
                        </a>
                    </li>
                </ul>
            </nav>
        </div>
    </body>
</html>
