<html>
    <head>
    </head>
    <body>
        <div class="large-9 columns" id="app-details-left">
            <div id="gallery">
                <ul>
                    <li class="text-center">
                        <a data-lightbox="769354" data-title="A label mask for training. " href="https://challengepost-s3-challengepost.netdna-ssl.com/photos/production/software_photos/000/769/354/datas/original.png">
                            <img alt="Mouse Brain Segmentation Using Unit Style ML Model &ndash; screenshot 1" class="software_photo_image image-replacement" onerror="this.onerror=null;this.src='https://devpost-challengepost.netdna-ssl.com/assets/defaults/thumbnail-placeholder-42bcab8d8178b413922ae2877d8b0868.gif';" src="//challengepost-s3-challengepost.netdna-ssl.com/photos/production/software_photos/000/769/354/datas/gallery.jpg">
                        </a>
                        <span class="expand-tag">
                            <i class="fas fa-expand">
                            </i>
                        </span>
                        <p>
                            <i>
                                A label mask for training.
                            </i>
                        </p>
                    </li>
                    <li class="text-center">
                        <a data-lightbox="769355" data-title="A picture of neurons in a mouse's brain. " href="https://challengepost-s3-challengepost.netdna-ssl.com/photos/production/software_photos/000/769/355/datas/original.png">
                            <img alt="Mouse Brain Segmentation Using Unit Style ML Model &ndash; screenshot 2" class="software_photo_image image-replacement" onerror="this.onerror=null;this.src='https://devpost-challengepost.netdna-ssl.com/assets/defaults/thumbnail-placeholder-42bcab8d8178b413922ae2877d8b0868.gif';" src="//challengepost-s3-challengepost.netdna-ssl.com/photos/production/software_photos/000/769/355/datas/gallery.jpg">
                        </a>
                        <span class="expand-tag">
                            <i class="fas fa-expand">
                            </i>
                        </span>
                        <p>
                            <i>
                                A picture of neurons in a mouse's brain.
                            </i>
                        </p>
                    </li>
                    <li class="text-center">
                        <a data-lightbox="769379" data-title="Unet Architecture" href="https://challengepost-s3-challengepost.netdna-ssl.com/photos/production/software_photos/000/769/379/datas/original.png">
                            <img alt="Mouse Brain Segmentation Using Unit Style ML Model &ndash; screenshot 3" class="software_photo_image image-replacement" onerror="this.onerror=null;this.src='https://devpost-challengepost.netdna-ssl.com/assets/defaults/thumbnail-placeholder-42bcab8d8178b413922ae2877d8b0868.gif';" src="//challengepost-s3-challengepost.netdna-ssl.com/photos/production/software_photos/000/769/379/datas/gallery.jpg">
                        </a>
                        <span class="expand-tag">
                            <i class="fas fa-expand">
                            </i>
                        </span>
                        <p>
                            <i>
                                Unet Architecture
                            </i>
                        </p>
                    </li>
                </ul>
            </div>
            <div>
                <h2>
                    U-Net with advanced encoder and decoder
                </h2>
                <p>
                    <strong>
                        Task
                    </strong>
                    <br>
                    We are tasked to provide the segmentation of cell boundaries within mouse brain by training a model on the dataset including fruit fly brain image.
                </p>
                <p>
                    <strong>
                        Data
                    </strong>
                    <br>
                    In this model, we trained on fruit fly images and mouse brain images found online and validated the model on the provided mouse brain images and masks to select the model and evaluate the performace of this model based in IOU metric, which is defined as
                </p>
                <p>
                    \begin{equation} true positive / (true positive + false positive + false negative) \end{equation}
                </p>
                <p>
                    <strong>
                        Training
                    </strong>
                </p>
                <ul>
                    <li>
                        Fruit fly image and segmentation mask pair
                        <br>
                    </li>
                </ul>
                <p>
                    <strong>
                        Data augmentation
                    </strong>
                    <br>
                    In order to generalize better, we applied data augmentation techniques, which are proven to be effective on biomedical image data.
                </p>
                <ul>
                    <li>
                        Random elastic deformation
                    </li>
                    <li>
                        Random shear (rotation, shifting and scaling)
                    </li>
                    <li>
                        Random contrast and brightness change
flip
Then, in order not to have blank space as a result of these transformation, we randomly cropped the images to 256 x 256.
                    </li>
                </ul>
                <p>
                    <strong>
                        Test and Validation
                    </strong>
                    <br>
                    mouse brain image
                    <br>
                    <strong>
                        Model
                    </strong>
                    <br>
                    As a baseline model, we adopted U-Net, which is characterized with encoder and decoder architecture, because this model is proven to be work well with biological images. The Intersection of Union metric was used to evaluate performance.
                </p>
                <p>
                    In order to improve the performance we incorporated couple of changes below.
                </p>
                <ul>
                    <li>
                        Modified the encoder to Deep Residual Pyramid Net
                    </li>
                    <li>
                        Incorporated spatial and channelwise squeeze and excitation block
                    </li>
                    <li>
                        Optional: shakedrop regularization technique to see if it generalizes well
                    </li>
                </ul>
                <p>
                    <strong>
                        Result
                    </strong>
                    <br>
                    The provided fruit fly data doesn't allow for effective generalization to the mouse data with this model. This was verified by training the model with different percentages of the mouse used as training data (and not used as validation data). Results including randomly selected samples can be seen below.
                </p>
                <p>
                    Best IOU: 70%
                </p>
                <p>
                    <strong>
                        Discussion
                    </strong>
                    <br>
                    While we have good result for training set, we did not see that the output on test images are good. This is presumably because the distribution of the dataset is so different.
                </p>
                <p>
                    Actually, we observed that when we included the test images in the training set, the performance improved dramatically.
                </p>
                <p>
                    We tried to address this issue by incorporating further regularization techniques, suchg as shakedrop architecture.
                </p>
                <p>
                    However, we did not observe significant improvement from there.
                </p>
                <p>
                    <strong>
                        Challenges and future direction
                    </strong>
                    <br>
                    The biggest challenge is the poor generalization.
                </p>
            </div>
            <div class="" id="built-with">
                <h2>
                    Built With
                </h2>
                <ul class="no-bullet inline-list">
                    <li>
                        <span class="cp-tag recognized-tag">
                            <a href="https://devpost.com/software/built-with/machine-learning">
                                machine-learning
                            </a>
                        </span>
                    </li>
                    <li>
                        <span class="cp-tag">
                            pil
                        </span>
                    </li>
                    <li>
                        <span class="cp-tag recognized-tag">
                            <a href="https://devpost.com/software/built-with/python">
                                python
                            </a>
                        </span>
                    </li>
                    <li>
                        <span class="cp-tag recognized-tag">
                            <a href="https://devpost.com/software/built-with/pytorch">
                                pytorch
                            </a>
                        </span>
                    </li>
                </ul>
            </div>
            <nav class="app-links section">
                <h2>
                    Try it out
                </h2>
                <ul class="no-bullet" data-role="software-urls">
                    <li>
                        <a href="https://github.com/rgreenblatt/brown-datathon" rel="nofollow" target="_blank" title="https://github.com/rgreenblatt/brown-datathon">
                            <i class="ss-icon ss-link">
                            </i>
                            <span>
                                github.com
                            </span>
                        </a>
                    </li>
                </ul>
            </nav>
        </div>
    </body>
</html>
