<html>
    <head>
    </head>
    <body>
        <div class="large-9 columns" id="app-details-left">
            <div id="gallery">
                <ul>
                    <li>
                        <div class="flex-video">
                            <iframe allowfullscreen="allowfullscreen" allowscriptaccess="always" class="video-embed" frameborder="0" height="371" mode="transparent" src="https://www.youtube.com/embed/aSdASB6y8z0?enablejsapi=1&amp;hl=en_US&amp;rel=0&amp;start=&amp;version=3&amp;wmode=transparent" type="text/html" webkitallowfullscreen="true" width="660" wmode="transparent">
                            </iframe>
                        </div>
                    </li>
                    <li class="text-center">
                        <a data-lightbox="507805" data-title="High Level Architecture" href="https://challengepost-s3-challengepost.netdna-ssl.com/photos/production/software_photos/000/507/805/datas/original.jpg">
                            <img alt="Smart Elephant &ndash; screenshot 1" class="software_photo_image image-replacement" onerror="this.onerror=null;this.src='https://devpost-challengepost.netdna-ssl.com/assets/defaults/thumbnail-placeholder-42bcab8d8178b413922ae2877d8b0868.gif';" src="//challengepost-s3-challengepost.netdna-ssl.com/photos/production/software_photos/000/507/805/datas/gallery.jpg">
                        </a>
                        <span class="expand-tag">
                            <i class="fas fa-expand">
                            </i>
                        </span>
                        <p>
                            <i>
                                High Level Architecture
                            </i>
                        </p>
                    </li>
                    <li class="text-center">
                        <a data-lightbox="508337" data-title="Example of how reminders are sent" href="https://challengepost-s3-challengepost.netdna-ssl.com/photos/production/software_photos/000/508/337/datas/original.png">
                            <img alt="Smart Elephant &ndash; screenshot 2" class="software_photo_image image-replacement" onerror="this.onerror=null;this.src='https://devpost-challengepost.netdna-ssl.com/assets/defaults/thumbnail-placeholder-42bcab8d8178b413922ae2877d8b0868.gif';" src="//challengepost-s3-challengepost.netdna-ssl.com/photos/production/software_photos/000/508/337/datas/gallery.jpg">
                        </a>
                        <span class="expand-tag">
                            <i class="fas fa-expand">
                            </i>
                        </span>
                        <p>
                            <i>
                                Example of how reminders are sent
                            </i>
                        </p>
                    </li>
                </ul>
            </div>
            <div>
                <h2>
                    Inspiration
                </h2>
                <p>
                    My kids have an uncanny ability to make requests of me at the most inconvenient times. They'll ask me to sign a permission slip while I'm washing dishes, talking with my wife, or walking in the door with a handful of groceries.
                </p>
                <p>
                    I decided to use Alexa to create very simple reminders for the times I was unable to manually enter a reminder into my phone's reminder app. I first looked using "native" Alexa functions.
                </p>
                <ul>
                    <li>
                        I started with to-do list functionality, but (a) there is no date/time associated with the action and (b) you have to remember to check your to-do list to see what's on it.
                    </li>
                    <li>
                        I also looked into using Alexa to create my reminders as calendar events. That works, but left my calendar cluttered with "events" that were "actions/reminders".
                    </li>
                </ul>
                <p>
                    I needed something simple that would:
                </p>
                <ul>
                    <li>
                        allow me to quickly (in one statement) record an action and a due date
                    </li>
                    <li>
                        remind me at the appropriate time
                    </li>
                    <li>
                        not clutter my work and personal calendars
                    </li>
                </ul>
                <p>
                    I didn't find an existing skill that met my need, so I built
                    <strong>
                        Smart Elephant
                    </strong>
                    .
                </p>
                <h2>
                    What it does
                </h2>
                <p>
                    Smart Elephant uses Alexa to send reminders to your mobile. You can tell it to "take out the trash at 6pm" and you'll receive an SMS at 6pm, telling you to take out the trash.
                </p>
                <p>
                    You can also make requests without referencing a specific time:
                </p>
                <ul>
                    <li>
                        Call the doctor this
                        <strong>
                            afternoon
                        </strong>
                    </li>
                    <li>
                        Buy milk
                        <strong>
                            tomorrow at 5PM
                        </strong>
                    </li>
                    <li>
                        Write the check
                        <strong>
                            next Monday at 8AM
                        </strong>
                    </li>
                </ul>
                <p>
                    You can delete reminders as well, by asking Alexa to delete the reminder ("Alexa, ask Smart Elephant to delete reminder to pick up the kids"). Finally, you can ask Smart Elephant to send your reminders to you by asking "list reminders".
                </p>
                <p>
                    A user has to provide two pieces of information in order to use Smart Elephant
                </p>
                <ul>
                    <li>
                        a US mobile number (at this point in time, this skill only works in the US)
                    </li>
                    <li>
                        a US Zip Code (used to determine the user's time zone)
                    </li>
                </ul>
                <h2>
                    How I built it
                </h2>
                <p>
                    There are a number of challenges that I faced when designing
                    <strong>
                        Smart Elephant
                    </strong>
                </p>
                <ol>
                    <li>
                        Time is absolute, but we talk about it in relative terms. 8AM in Dallas is 6AM in Los Angeles. I had to understand where the user was in order to convert their relative time request into an
                        <a href="https://en.wikipedia.org/wiki/Coordinated_Universal_Time" rel="nofollow">
                            "absolute" time
                        </a>
                        .
                    </li>
                    <li>
                        A user could request to be reminded of
                        <em>
                            anything
                        </em>
                        , so I needed to build the skill to take any string of words.
                    </li>
                    <li>
                        A user could request to be reminded at any time (5AM, 4:37PM, 2:23AM, etc), so I had to build a function that was always looking for reminders and sending them at the appropriate time.
                    </li>
                    <li>
                        I had to be conscious of cost and performance. I could write a function that would constantly read a database for reminders, but (a) performance would be impacted as more records were added and (b) it would not be cost effective (AWS charges for the number of reads and writes to a database).
                    </li>
                </ol>
                <p>
                    Given that, I built a the following three system architecture:
                    <img alt="Architecture" data-canonical-url="https://challengepost-s3-challengepost.netdna-ssl.com/photos/production/software_photos/000/507/805/datas/gallery.jpg" src="https://res.cloudinary.com/devpost/image/fetch/s--aTlgZ4sH--/c_limit,f_auto,fl_lossy,q_auto:eco,w_900/https://challengepost-s3-challengepost.netdna-ssl.com/photos/production/software_photos/000/507/805/datas/gallery.jpg">
                </p>
                <p>
                    <strong>
                        A: Main Lambda Function (triggered when the user invokes the skill through Alexa)
                    </strong>
                </p>
                <p>
                    This function's main purpose is to interpret the ask/request of the Alexa user and take action - typically: creating reminders and saving them to a DymanoDB table, or removing reminders. The process of adding and removing reminders required the special considerations listed below:
                </p>
                <p>
                    <strong>
                        Creating Reminders - Getting the Time Zone
                    </strong>
                </p>
                <p>
                    The lambda function uses Google Maps APIs to get the users timezone id. First, the user has to provide a valid zip code. This zip code is used to get the user's location (latitude and longitude) using the Geocode API. The Time Zone API uses the location coordinates to retrieve the timezone id.
                </p>
                <p>
                    <strong>
                        Creating Reminders - Converting to a Absolute Time
                    </strong>
                </p>
                <p>
                    As mentioned earlier, I needed to take the user's input (5AM) and convert it to a time that was universal. I used Moment.js for most of this work. Moment.timezone functions translate a datetime to UTC. From there, it was easy to convert the reminder datetime (in UTC) into the number of milliseconds since Jan 1, 2017 (similar to Unix epoch time).
                </p>
                <p>
                    <strong>
                        Deleting Reminders - Using fuzzy matching logic
                    </strong>
                </p>
                <p>
                    I needed the ability to delete reminders. Unfortunately, a simple database delete statement would not work (as the user might add the reminder as "take out trash" and request Alexa to delete " take out the trash". I needed logic that would find similar strings. I used the Fuse.js library for fuzzy search logic.
                </p>
                <p>
                    If the match is extremely close, then "Don't Forget" assumes the match is the same and deletes it. If it is a "near match", then "Smart Elephant asks the user to confirm the delete.
                </p>
                <p>
                    <strong>
                        B &amp; C: Second Lambda Function (runs every 15 mins to read reminders from DB and place into SQS Queue) and Python Script to read from Queue
                    </strong>
                </p>
                <p>
                    The reminders created by the main Lambda function are saved to a DynamoDB table. I needed to design a method to get the message and deliver them at the appropriate time. I felt that using a combination of a scheduled Lambda function, SQS, and SNS made the most sense. This Lambda function reads messages from the table, and if the message is scheduled to be delivered in 15 mins or less, adds it to the SQS queue. Each message is added with a delay seconds attribute, which allows the message to be make visible at the appropriate time to send.
                </p>
                <p>
                    The Python script constantly polls the queue for new messages. When one is found, it removes it from the queue and sends it via SMS.
                </p>
                <p>
                    See the diagram below for additional details.
                    <img alt="Example flow" data-canonical-url="https://challengepost-s3-challengepost.netdna-ssl.com/photos/production/software_photos/000/508/337/datas/gallery.jpg" src="https://res.cloudinary.com/devpost/image/fetch/s--PQpRjcBr--/c_limit,f_auto,fl_lossy,q_auto:eco,w_900/https://challengepost-s3-challengepost.netdna-ssl.com/photos/production/software_photos/000/508/337/datas/gallery.jpg">
                </p>
                <p>
                    <strong>
                        Notes
                    </strong>
                </p>
                <ol>
                    <li>
                        A queue message can only be delayed up to 15 mins, which is why the Lambda function only runs every 15 mins.
                    </li>
                    <li>
                        If a user created a reminder that is less than 15 minutes from delivery, then the reminder is directly added to the queue, with the appropriate delay seconds  (instead of being added to the DynamoDB table)
                    </li>
                    <li>
                        The skill was originally called "Don't Forget"; I changed to name to Smart Elephant it order to ensure that the skill was triggered, instead of Alexa "native" to-do functionality.
                    </li>
                </ol>
                <h2>
                    What's next for Smart Elephant
                </h2>
                <p>
                    Over time, I'd like to add new functionality:
                </p>
                <ol>
                    <li>
                        Option to "acknowledge" reminder once received, or push reminded to another date/time
                    </li>
                    <li>
                        Ability to edit reminders (right now, you can only add or delete.
                    </li>
                </ol>
            </div>
            <div class="" id="built-with">
                <h2>
                    Built With
                </h2>
                <ul class="no-bullet inline-list">
                    <li>
                        <span class="cp-tag recognized-tag">
                            <a href="https://devpost.com/software/built-with/amazon-alexa">
                                amazon-alexa
                            </a>
                        </span>
                    </li>
                    <li>
                        <span class="cp-tag recognized-tag">
                            <a href="https://devpost.com/software/built-with/amazon-web-services">
                                amazon-web-services
                            </a>
                        </span>
                    </li>
                    <li>
                        <span class="cp-tag recognized-tag">
                            <a href="https://devpost.com/software/built-with/moment-js">
                                moment.js
                            </a>
                        </span>
                    </li>
                    <li>
                        <span class="cp-tag recognized-tag">
                            <a href="https://devpost.com/software/built-with/node-js">
                                node.js
                            </a>
                        </span>
                    </li>
                </ul>
            </div>
            <nav class="app-links section">
                <h2>
                    Try it out
                </h2>
                <ul class="no-bullet" data-role="software-urls">
                    <li>
                        <a href="https://www.amazon.com/dp/B071DX3FZC/" rel="nofollow" target="_blank" title="https://www.amazon.com/dp/B071DX3FZC/">
                            <i class="ss-icon ss-link">
                            </i>
                            <span>
                                www.amazon.com
                            </span>
                        </a>
                    </li>
                </ul>
            </nav>
        </div>
    </body>
</html>
