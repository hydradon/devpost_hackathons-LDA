<html>
    <head>
    </head>
    <body>
        <div class="large-9 columns" id="app-details-left">
            <div id="gallery">
                <ul>
                    <li class="text-center">
                        <a data-lightbox="632137" data-title="Cloud synthesis for 452nm and 827nm bands." href="https://challengepost-s3-challengepost.netdna-ssl.com/photos/production/software_photos/000/632/137/datas/original.jpg">
                            <img alt="Kumo-san &ndash; screenshot 1" class="software_photo_image image-replacement" onerror="this.onerror=null;this.src='https://devpost-challengepost.netdna-ssl.com/assets/defaults/thumbnail-placeholder-42bcab8d8178b413922ae2877d8b0868.gif';" src="//challengepost-s3-challengepost.netdna-ssl.com/photos/production/software_photos/000/632/137/datas/gallery.jpg">
                        </a>
                        <span class="expand-tag">
                            <i class="fas fa-expand">
                            </i>
                        </span>
                        <p>
                            <i>
                                Cloud synthesis for 452nm and 827nm bands.
                            </i>
                        </p>
                    </li>
                    <li class="text-center">
                        <a data-lightbox="632187" data-title="Real cloud for 452nm and 827nm bands." href="https://challengepost-s3-challengepost.netdna-ssl.com/photos/production/software_photos/000/632/187/datas/original.jpg">
                            <img alt="Kumo-san &ndash; screenshot 2" class="software_photo_image image-replacement" onerror="this.onerror=null;this.src='https://devpost-challengepost.netdna-ssl.com/assets/defaults/thumbnail-placeholder-42bcab8d8178b413922ae2877d8b0868.gif';" src="//challengepost-s3-challengepost.netdna-ssl.com/photos/production/software_photos/000/632/187/datas/gallery.jpg">
                        </a>
                        <span class="expand-tag">
                            <i class="fas fa-expand">
                            </i>
                        </span>
                        <p>
                            <i>
                                Real cloud for 452nm and 827nm bands.
                            </i>
                        </p>
                    </li>
                    <li class="text-center">
                        <a data-lightbox="632026" data-title="Example of RGB enhanced real image with clouds" href="https://challengepost-s3-challengepost.netdna-ssl.com/photos/production/software_photos/000/632/026/datas/original.png">
                            <img alt="Kumo-san &ndash; screenshot 3" class="software_photo_image image-replacement" onerror="this.onerror=null;this.src='https://devpost-challengepost.netdna-ssl.com/assets/defaults/thumbnail-placeholder-42bcab8d8178b413922ae2877d8b0868.gif';" src="//challengepost-s3-challengepost.netdna-ssl.com/photos/production/software_photos/000/632/026/datas/gallery.jpg">
                        </a>
                        <span class="expand-tag">
                            <i class="fas fa-expand">
                            </i>
                        </span>
                        <p>
                            <i>
                                Example of RGB enhanced real image with clouds
                            </i>
                        </p>
                    </li>
                    <li class="text-center">
                        <a data-lightbox="631620" data-title="Example of synthesized cloud (452nm band)" href="https://challengepost-s3-challengepost.netdna-ssl.com/photos/production/software_photos/000/631/620/datas/original.jpg">
                            <img alt="Kumo-san &ndash; screenshot 4" class="software_photo_image image-replacement" onerror="this.onerror=null;this.src='https://devpost-challengepost.netdna-ssl.com/assets/defaults/thumbnail-placeholder-42bcab8d8178b413922ae2877d8b0868.gif';" src="//challengepost-s3-challengepost.netdna-ssl.com/photos/production/software_photos/000/631/620/datas/gallery.jpg">
                        </a>
                        <span class="expand-tag">
                            <i class="fas fa-expand">
                            </i>
                        </span>
                        <p>
                            <i>
                                Example of synthesized cloud (452nm band)
                            </i>
                        </p>
                    </li>
                </ul>
            </div>
            <div>
                <h2>
                    Inspiration
                </h2>
                <p>
                    As the amount of satellite images data increases, if finds numerous applications in areas such as natural environment monitoring, disaster response, transportation and infrastructure improvement, among many others. However...
                </p>
                <h3>
                    Cloudy is fuzzy
                </h3>
                <p>
                    Or worse, it obstructs the image. Clouds are a major issue with satellite images. Machine learning has only recently been applied to this task and the literature is boiling with excitement about its potential.
                </p>
                <h3>
                    Hyperspectral is not only fancy
                </h3>
                <p>
                    Instead of only 3 or 4 bands (RGBA, multispectral) in an image, we have many wavelengths available across the electromagnetic spectrum. So much for the storage space... but very helpful for data analysis and image processing purposes.
                </p>
                <h3>
                    What are GANs?
                </h3>
                <p>
                    Generative Adversarial Networks are a class of unsupervised deep learning architecture which is extremely successful for a wide variety of challenging tasks such as image synthesis, completion or coloring. The basic idea is to train one network - the
                    <strong>
                        generator
                    </strong>
                    - to generate an image looking like X, while another network - the
                    <strong>
                        discriminator
                    </strong>
                    - is trained to discriminate between real images of X and fake ones generated by the first network. It is thus a competition between two neural networks which, after a careful training, can yield surprisingly sharp and detailed 'fake' images.
                </p>
                <p>
                    In this project I focused on conditional GANs, you can see
                    <a href="https://phillipi.github.io/pix2pix/" rel="nofollow">
                        more examples like pix2pix here
                    </a>
                    .
                </p>
                <h3>
                    What can GANs do for us?
                </h3>
                <p>
                    The basic idea is: Since clouds become more transparent towards IR wavelengths, why don't we use this extra information and have GANs generate the missing patches from below the clouds? I could only find one very recent (Feb. 2018) paper which tackled this idea.
[1] showed that conditional GANs could be useful combined with 4-band images (RGBA). It is only natural to think that hyperspectral data should yield even better results.
                </p>
                <p>
                    Ideally we would like to have something that can
                </p>
                <ul>
                    <li>
                        detect clouds reliably
                    </li>
                    <li>
                        replace them with relevant pixels
                    </li>
                    <li>
                        run fast enough to be implemented up there in space!
                    </li>
                </ul>
                <h3>
                    But deep learning is a data ogre!
                </h3>
                <p>
                    Yes, deep learning usually requires huge datasets. We have 30 images from Satellogic hyperspectral dataset published for the datathon. Each image has 32 bands. Each band can be divided into 300~800 small images (256x256) depending on its size and orientation. That means we could reach a dataset of
                    <strong>
                        ~15k hyperspectral images
                    </strong>
                    . The pix2pix GAN reportedly can sometimes work with as few as several hundred images, thus we should not run into a major issue due to the dataset size.
                </p>
                <h2>
                    What it currently does
                </h2>
                <p>
                    "The two most powerful warriors are patience and time" Tolstoy
                </p>
                <p>
                    No, despite tremendous efforts, it does not yet run, so we cannot tell whether it does anything. Some pieces still need to be put together. :-(
                </p>
                <p>
                    Nonetheless
                    <strong>
                        what works
                    </strong>
                    can be summarized as everything up to the input of the GAN:
                </p>
                <ul>
                    <li>
                        Generation of 256x256 patches from Satellogic hyperspectral data
                    </li>
                    <li>
                        Cloud layer generation
                    </li>
                    <li>
                        Classification between cloudy/clear patches using Convolutional Neural Networks (CNNs)
                    </li>
                </ul>
                <h2>
                    How I built it
                </h2>
                <p>
                    With a bunch of Python scripts. My strategy was the following:
                </p>
                <ol>
                    <li>
                        Download rasters from Telluric Explorer.
                    </li>
                    <li>
                        Tile them: since rasters are always rotated (along mercator) and do not occupy all the image, slice it along a grid and extract as many square images size 256x256 as possible.
                    </li>
                    <li>
                        Take a subset of 800 images and label it (cloudy/clear) using
                        <a href="https://www.labelbox.io/" rel="nofollow">
                            Labelbox
                        </a>
                        for classification purpose.
                    </li>
                    <li>
                        Train a simple classification network based on
                        <a href="http://www.robots.ox.ac.uk/%7Evgg/research/very_deep/" rel="nofollow">
                            VGG
                        </a>
                        to discriminate between images with and without clouds.
                    </li>
                    <li>
                        Use this network to extract all non-cloudy images from the dataset. The cloudy images will form the testing dataset (to test the GANs performance).
                    </li>
                    <li>
                        Generate a cloud and its shadow using Perlin noise and some image processing.
                    </li>
                    <li>
                        Duplicate the dataset of non-cloudy images and add a cloudy layer on the duplicate dataset. We need the clear image as ground truth for the discriminator, the cloudy image will be the input of the generator.
                    </li>
                    <li>
                        Train the GAN.
                    </li>
                </ol>
                <h2>
                    Challenges I ran into
                </h2>
                <ul>
                    <li>
                        How to work on a dataset of images which are ~12Go each when your computer only has &lt;5Go free space left.
                    </li>
                    <li>
                        How to train a deep neural network without GPU? Or the struggle to get multiple GPU platforms to launch/install dependencies/run the code.
                    </li>
                </ul>
                <h2>
                    Accomplishments that I'm proud of
                </h2>
                <ul>
                    <li>
                        Labeling 800 images by hand to train the classification network
                    </li>
                    <li>
                        I ended up downloading, processing, classifying and implementing GAN on four different machines (with all the data uploading/downloading that this implies) which required treasures of organization and data management.
                    </li>
                    <li>
                        Figuring out and setting up the whole deep learning pipeline for this problem, from the dataset creation to the end training, in less than 24h.
                    </li>
                </ul>
                <h2>
                    What I learned
                </h2>
                <ul>
                    <li>
                        Had a wonderful time learning what GANs are, all the magical tasks they can accomplish as well as how they work and how to implement them.
                    </li>
                    <li>
                        The unsuspected power and importance of satellite data analysis for so many areas, not only earth science.
                    </li>
                    <li>
                        "Deep learning is all about data." 80% of the time will be spent on the dataset creation, processing, etc.
                    </li>
                </ul>
                <h2>
                    What's next for Kumo-san
                </h2>
                <ul>
                    <li>
                        Finding teammates? Never too late.
                    </li>
                    <li>
                        Patching pieces together and finally run it!
                    </li>
                    <li>
                        Compare its performance with multispectral images and simple RGB images to assess the advantage of having hyperspectral data.
                    </li>
                    <li>
                        Compare the performance with other cloud removal algorithms which do not rely on machine learning.
                    </li>
                </ul>
                <h2>
                    References
                </h2>
                <p>
                    [1] Filmy Cloud Removal on Satellite Imagery with Multispectral Conditional Generative Adversarial Nets. K.Enomoto et al. (arxiv:1710.04835)
                </p>
                <p>
                    <em>
                        'Kumo' is the Japanese word for 'cloud'.
                    </em>
                </p>
            </div>
            <div class="" id="built-with">
                <h2>
                    Built With
                </h2>
                <ul class="no-bullet inline-list">
                    <li>
                        <span class="cp-tag recognized-tag">
                            <a href="https://devpost.com/software/built-with/numpy">
                                numpy
                            </a>
                        </span>
                    </li>
                    <li>
                        <span class="cp-tag recognized-tag">
                            <a href="https://devpost.com/software/built-with/python">
                                python
                            </a>
                        </span>
                    </li>
                    <li>
                        <span class="cp-tag recognized-tag">
                            <a href="https://devpost.com/software/built-with/scipy">
                                scipy
                            </a>
                        </span>
                    </li>
                    <li>
                        <span class="cp-tag">
                            tensorflow
                        </span>
                    </li>
                </ul>
            </div>
        </div>
    </body>
</html>
