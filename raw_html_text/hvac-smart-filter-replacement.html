<html>
    <head>
    </head>
    <body>
        <div class="large-9 columns" id="app-details-left">
            <div id="gallery">
                <ul>
                    <li class="text-center">
                        <a data-lightbox="564466" data-title="SFR Architecture and workflow" href="https://challengepost-s3-challengepost.netdna-ssl.com/photos/production/software_photos/000/564/466/datas/original.jpg">
                            <img alt="HVAC Smart Filter Replacement &ndash; screenshot 1" class="software_photo_image image-replacement" onerror="this.onerror=null;this.src='https://devpost-challengepost.netdna-ssl.com/assets/defaults/thumbnail-placeholder-42bcab8d8178b413922ae2877d8b0868.gif';" src="//challengepost-s3-challengepost.netdna-ssl.com/photos/production/software_photos/000/564/466/datas/gallery.jpg">
                        </a>
                        <span class="expand-tag">
                            <i class="fas fa-expand">
                            </i>
                        </span>
                        <p>
                            <i>
                                SFR Architecture and workflow
                            </i>
                        </p>
                    </li>
                </ul>
            </div>
            <div>
                <h2>
                    The Why
                </h2>
                <h3>
                    Filthy air filters
                </h3>
                <p>
                    This is one of the most common problems (and one of the biggest threats) in ordinary HVAC systems. The traditional approach of changing it every X months is not only inconvenient but also
                    <strong>
                        highly inefficient
                    </strong>
                    because it doesn't take into consideration the many variables that influence the durability of the filter (overall degradation of the HVAC system itself, outside temperature, ambient dust, seasons, etc...)
                    <br>
                    This project attempted to develop a prototype of an system that can, in real time, detect anomalies with your Air Filter installation as well as give you advance notice of when you really need to change it.
                </p>
                <p>
                    Knowing when to change the filter right away has a direct impact in the utility bill by
                    <strong>
                        reducing the electricity consumed by the HVAC system
                    </strong>
                    in the generation air intake suction. It also would
                    <strong>
                        help you and your family to breath cleaner air
                    </strong>
                </p>
                <h2>
                    The How
                </h2>
                <h4>
                    Theory
                </h4>
                <ul>
                    <li>
                        <p>
                            Air flow across an HVAC Air Filter follows the
                            <a href="https://en.wikipedia.org/wiki/Bernoulli%27s_principle" rel="nofollow">
                                Bernoulli's principle
                            </a>
                            :
                            <br>
                            "...an increase in the speed of a fluid occurs simultaneously with a decrease in pressure or a decrease in the fluid's potential energy..."
                        </p>
                    </li>
                    <li>
                        <p>
                            Timing or visual inspection are not effective ways of knowing when to replace the filter. Detection of pressure drop across the filter is the accepted method:
                            <br>
                            <br>
                            "...Overall degradation of the HVAC system itself, outside temperature, ambient dust, seasons, etc... are variables that affect the filter selection and contribute to the problem of determining when a filter has reached the tolerable limit of its effective life span as a result of the accumulation of contaminants. Because of wide variation in contaminant load in the air being filtered, time is an uncertain measurement.
                            <strong>
                                Visual inspection of the condition of the filter tells little or nothing.
                            </strong>
                            The most widely used method of checking filter condition is to measure pressure drop across the filter..."
                            <a href="http://www.dwyer-inst.com/products/airfilterintroduction.cfm" rel="nofollow">
                                [1]
                            </a>
                        </p>
                        <p>
                            "...In the past, typical residential HVAC systems had ordinary thermostats with a &ldquo;timer,&rdquo; allowing users to select the filter change cycle length in days. Some companies use system run time as an indicator of when to change the filter.
                            <strong>
                                Unfortunately, these solutions neglect to address the rudimentary need for filter replacement &ndash; a decline in system efficiency
                            </strong>
                            ...."
                            <a href="https://e2e.ti.com/blogs_/b/industrial_strength/archive/2016/11/14/predictive-maintenance-solutions-for-hvac-filter-replacement-part-1" rel="nofollow">
                                [2]
                            </a>
                        </p>
                    </li>
                </ul>
                <h4>
                    Data generation (SFR-Device)
                </h4>
                <p>
                    A real implementation using a raspberry pi, connects two
                    <a href="http://a.co/fDYtNr3" rel="nofollow">
                        low pressure MS5540 sensors
                    </a>
                    to it and places each one on each side of the air filter to collect static pressure.
                    <br>
                    Let's consider this setup (raspberry pi + sensors) our
                    <strong>
                        SFR-Device
                    </strong>
                    <br>
                    For our demo, we are going to use the equation that derives from the
                    <a href="https://en.wikipedia.org/wiki/Bernoulli%27s_principle" rel="nofollow">
                        Bernoulli's principle
                    </a>
                    and reasonable assumptions as the basis for simulated pressure values. Details about the implementation of the Bernoulli's equation
                    <a href="https://github.com/mllanes/SFR-device/blob/master/lib/Bernoullis.js" rel="nofollow">
                        can be found in the Bernoullis class file
                    </a>
                    . The simulated values also take into consideration the progressive, delayed, non linear and asymptotic clogging of an HVAC Air Filter under normal conditions
                </p>
                <h4>
                    SFR-Device Onboarding
                </h4>
                <p>
                    A proposal for a real life IoT solution like this would require shipping the SFR-Device to customers. After the manufacturing phase, the device would be shipped with the
                    <a href="https://github.com/mllanes/SFR-device.git" rel="nofollow">
                        SFR-Device app
                    </a>
                    already deployed on it and a
                    <a href="https://github.com/mllanes/SFR-device/blob/master/on-boarding-config.json" rel="nofollow">
                        config file
                    </a>
                    with the customer Id its assigned to a it's serial number. With this information, the device would attempt to on-board itself the first time the
                    <a href="https://github.com/mllanes/SFR-device.git" rel="nofollow">
                        SFR-Device app
                    </a>
                    runs. This process happens via an Api endpoint (backed by a lambda function) provided by the
                    <a href="https://github.com/mllanes/SFR-lambda-data-access-provisioning.git" rel="nofollow">
                        SFR-lambda-data-access-provisioning app
                    </a>
                    service. The onboarding process validates the incoming customerId | serialNumber against a list of known devices an if good, provisions an
                    <strong>
                        IoT Thing and certificate
                    </strong>
                    for it.
                </p>
                <h4>
                    Data samples collection and processing
                </h4>
                <p>
                    After the automatic onboarding phase, the
                    <a href="https://github.com/mllanes/SFR-device.git" rel="nofollow">
                        SFR-Device
                    </a>
                    will use its certificate to send the pressure samples to app specific
                    <strong>
                        IoT Topic
                    </strong>
                    via MQTT protocol. This samples are pass through a catch all
                    <strong>
                        IoT Rule
                    </strong>
                    with two actions associated with it:
                </p>
                <ul>
                    <li>
                        Anomaly detection:
                    </li>
                </ul>
                <p>
                    Injects all the incoming samples into the
                    <strong>
                        Anomalies Kinesis stream
                    </strong>
                    for further processing
                </p>
                <ul>
                    <li>
                        <p>
                            General storage:
                        </p>
                        <p>
                            Stores all the incoming samples in a
                            <strong>
                                DynamoDb
                            </strong>
                            tables for further access via an Api endpoint (backed by Lambda) provided by the
                            <a href="https://github.com/mllanes/SFR-lambda-data-access-provisioning.git" rel="nofollow">
                                SFR-lambda-data-access-provisioning app
                            </a>
                        </p>
                    </li>
                </ul>
                <h4>
                    Anomaly detection
                </h4>
                <p>
                    Provided by the
                    <a href="https://github.com/mllanes/SFR-data-lambda-processing.git" rel="nofollow">
                        SFR-data-lambda-processing app
                    </a>
                    ; the
                    <strong>
                        Anomalies Kinesis stream
                    </strong>
                    is used as the input stream for the
                    <strong>
                        Real Time Anomaly detection Kinesis Analytics app
                    </strong>
                    which, by processing the incoming data samples in a time window, detects the following anomalies in the across Air Filter pressure:
                </p>
                <ul>
                    <li>
                        <p>
                            Drastically low pressure caused by:
                        </p>
                        <ul>
                            <li>
                                The air filter is letting almost no air to pass through.
                            </li>
                            <li>
                                The air duct is obstructed. The air filter might have been sucked into the duct.
                            </li>
                            <li>
                                If pressure = 0 the avg will quickly drop; it means that the sensor is broken; pressure = 0 its an absolute vacuum... not even in outer space :-)
                            </li>
                        </ul>
                    </li>
                    <li>
                        <p>
                            Pressure equalization with atmosphere:
                        </p>
                        <ul>
                            <li>
                                Atmospheric pressure is 10332 mmH20 so if this happens, there is no filter or the filter broke and the air if flowing directly without ALMOST ANY resistance
                            </li>
                        </ul>
                    </li>
                    <li>
                        <p>
                            Normal wear|degradation. The filter is almost exhausted:
                        </p>
                        <ul>
                            <li>
                                Filter need to be replaced when pressure drops under 10326.5 mmH2O but not less than 1000 mmH2O
                            </li>
                        </ul>
                    </li>
                </ul>
                <p>
                    When an anomaly is detected, the
                    <strong>
                        Real Time Anomaly detection Kinesis Analytics app
                    </strong>
                    injects the resulting samples into a
                    <strong>
                        Anomalies Output Kinesis Stream
                    </strong>
                    which in turns has the
                    <a href="https://github.com/mllanes/SFR-data-lambda-processing.git" rel="nofollow">
                        SFR-data-lambda-processing
                    </a>
                    lambda as a consumer and, upon receiving the anomaly records, will issue a SMS notification to the related customer via an
                    <strong>
                        SNS
                    </strong>
                    topic.
                </p>
                <h2>
                    The Future
                </h2>
                <p>
                    There are multiple additions that can be done to this project but were left out at this stage:
                </p>
                <ul>
                    <li>
                        Mobile app to present the data samples and to receive push notifications (instead of SMS) when an anomaly is detected
                    </li>
                    <li>
                        Custom domain name (with
                        <strong>
                            AWS ACM
                        </strong>
                        certificate) for data access and provisioning Api endpoints
                    </li>
                    <li>
                        Lambda service for getting the device's serial numbers and assigned customerId after coming out the manufacturing line
                    </li>
                    <li>
                        Lambda service for customer's info access (mobile phone in this case)
                    </li>
                    <li>
                        <a href="https://jwt.io/" rel="nofollow">
                            JWT tokens
                        </a>
                        for passing a full
                        <a href="https://github.com/mllanes/SFR-device.git" rel="nofollow">
                            SFR-device
                        </a>
                        profile during onboarding and for customer auth during access to the data samples
                    </li>
                    <li>
                        Clean up of unused
                        <strong>
                            IoT
                        </strong>
                        certificates
                    </li>
                </ul>
            </div>
            <div class="" id="built-with">
                <h2>
                    Built With
                </h2>
                <ul class="no-bullet inline-list">
                    <li>
                        <span class="cp-tag">
                            aws-api-gateway
                        </span>
                    </li>
                    <li>
                        <span class="cp-tag">
                            aws-cloudformation
                        </span>
                    </li>
                    <li>
                        <span class="cp-tag">
                            aws-dynamodb
                        </span>
                    </li>
                    <li>
                        <span class="cp-tag">
                            aws-iot
                        </span>
                    </li>
                    <li>
                        <span class="cp-tag">
                            aws-kinesis-analytics
                        </span>
                    </li>
                    <li>
                        <span class="cp-tag">
                            aws-kinesis-streams
                        </span>
                    </li>
                    <li>
                        <span class="cp-tag">
                            aws-lambda
                        </span>
                    </li>
                    <li>
                        <span class="cp-tag">
                            aws-sn
                        </span>
                    </li>
                    <li>
                        <span class="cp-tag recognized-tag">
                            <a href="https://devpost.com/software/built-with/node-js">
                                node.js
                            </a>
                        </span>
                    </li>
                </ul>
            </div>
            <nav class="app-links section">
                <h2>
                    Try it out
                </h2>
                <ul class="no-bullet" data-role="software-urls">
                    <li>
                        <a href="https://github.com/mllanes/SFR-lambda-data-access-provisioning" rel="nofollow" target="_blank" title="https://github.com/mllanes/SFR-lambda-data-access-provisioning">
                            <i class="ss-icon ss-link">
                            </i>
                            <span>
                                github.com
                            </span>
                        </a>
                    </li>
                    <li>
                        <a href="https://github.com/mllanes/SFR-lambda-data-processing" rel="nofollow" target="_blank" title="https://github.com/mllanes/SFR-lambda-data-processing">
                            <i class="ss-icon ss-link">
                            </i>
                            <span>
                                github.com
                            </span>
                        </a>
                    </li>
                    <li>
                        <a href="https://github.com/mllanes/SFR-device" rel="nofollow" target="_blank" title="https://github.com/mllanes/SFR-device">
                            <i class="ss-icon ss-link">
                            </i>
                            <span>
                                github.com
                            </span>
                        </a>
                    </li>
                </ul>
            </nav>
        </div>
    </body>
</html>
