<html>
    <head>
    </head>
    <body>
        <div class="large-9 columns" id="app-details-left">
            <div id="gallery">
                <ul>
                    <li>
                        <div class="flex-video">
                            <iframe allowfullscreen="allowfullscreen" allowscriptaccess="always" class="video-embed" frameborder="0" height="371" mode="transparent" src="https://www.youtube.com/embed/9y8p4Kio4UM?enablejsapi=1&amp;hl=en_US&amp;rel=0&amp;start=&amp;version=3&amp;wmode=transparent" type="text/html" webkitallowfullscreen="true" width="660" wmode="transparent">
                            </iframe>
                        </div>
                    </li>
                    <li class="text-center">
                        <a data-lightbox="772156" data-title="Main Enrichment Application" href="https://challengepost-s3-challengepost.netdna-ssl.com/photos/production/software_photos/000/772/156/datas/original.png">
                            <img alt="Microsoft Graph Security - Security Alerts Enrichment &ndash; screenshot 1" class="software_photo_image image-replacement" onerror="this.onerror=null;this.src='https://devpost-challengepost.netdna-ssl.com/assets/defaults/thumbnail-placeholder-42bcab8d8178b413922ae2877d8b0868.gif';" src="//challengepost-s3-challengepost.netdna-ssl.com/photos/production/software_photos/000/772/156/datas/gallery.jpg">
                        </a>
                        <span class="expand-tag">
                            <i class="fas fa-expand">
                            </i>
                        </span>
                        <p>
                            <i>
                                Main Enrichment Application
                            </i>
                        </p>
                    </li>
                    <li class="text-center">
                        <a data-lightbox="772144" data-title="VirusTotal Enrichment" href="https://challengepost-s3-challengepost.netdna-ssl.com/photos/production/software_photos/000/772/144/datas/original.png">
                            <img alt="Microsoft Graph Security - Security Alerts Enrichment &ndash; screenshot 2" class="software_photo_image image-replacement" onerror="this.onerror=null;this.src='https://devpost-challengepost.netdna-ssl.com/assets/defaults/thumbnail-placeholder-42bcab8d8178b413922ae2877d8b0868.gif';" src="//challengepost-s3-challengepost.netdna-ssl.com/photos/production/software_photos/000/772/144/datas/gallery.jpg">
                        </a>
                        <span class="expand-tag">
                            <i class="fas fa-expand">
                            </i>
                        </span>
                        <p>
                            <i>
                                VirusTotal Enrichment
                            </i>
                        </p>
                    </li>
                    <li class="text-center">
                        <a data-lightbox="772145" data-title="Hybrid Analysis Enrichment" href="https://challengepost-s3-challengepost.netdna-ssl.com/photos/production/software_photos/000/772/145/datas/original.png">
                            <img alt="Microsoft Graph Security - Security Alerts Enrichment &ndash; screenshot 3" class="software_photo_image image-replacement" onerror="this.onerror=null;this.src='https://devpost-challengepost.netdna-ssl.com/assets/defaults/thumbnail-placeholder-42bcab8d8178b413922ae2877d8b0868.gif';" src="//challengepost-s3-challengepost.netdna-ssl.com/photos/production/software_photos/000/772/145/datas/gallery.jpg">
                        </a>
                        <span class="expand-tag">
                            <i class="fas fa-expand">
                            </i>
                        </span>
                        <p>
                            <i>
                                Hybrid Analysis Enrichment
                            </i>
                        </p>
                    </li>
                    <li class="text-center">
                        <a data-lightbox="772146" href="https://challengepost-s3-challengepost.netdna-ssl.com/photos/production/software_photos/000/772/146/datas/original.png">
                            <img alt="Microsoft Graph Security - Security Alerts Enrichment &ndash; screenshot 4" class="software_photo_image image-replacement" onerror="this.onerror=null;this.src='https://devpost-challengepost.netdna-ssl.com/assets/defaults/thumbnail-placeholder-42bcab8d8178b413922ae2877d8b0868.gif';" src="//challengepost-s3-challengepost.netdna-ssl.com/photos/production/software_photos/000/772/146/datas/gallery.jpg">
                        </a>
                        <span class="expand-tag">
                            <i class="fas fa-expand">
                            </i>
                        </span>
                        <p>
                            <i>
                            </i>
                        </p>
                    </li>
                    <li class="text-center">
                        <a data-lightbox="772147" data-title="Maltiverse Enrichment" href="https://challengepost-s3-challengepost.netdna-ssl.com/photos/production/software_photos/000/772/147/datas/original.png">
                            <img alt="Microsoft Graph Security - Security Alerts Enrichment &ndash; screenshot 5" class="software_photo_image image-replacement" onerror="this.onerror=null;this.src='https://devpost-challengepost.netdna-ssl.com/assets/defaults/thumbnail-placeholder-42bcab8d8178b413922ae2877d8b0868.gif';" src="//challengepost-s3-challengepost.netdna-ssl.com/photos/production/software_photos/000/772/147/datas/gallery.jpg">
                        </a>
                        <span class="expand-tag">
                            <i class="fas fa-expand">
                            </i>
                        </span>
                        <p>
                            <i>
                                Maltiverse Enrichment
                            </i>
                        </p>
                    </li>
                    <li class="text-center">
                        <a data-lightbox="772148" data-title="ThreatMiner Enrichment" href="https://challengepost-s3-challengepost.netdna-ssl.com/photos/production/software_photos/000/772/148/datas/original.png">
                            <img alt="Microsoft Graph Security - Security Alerts Enrichment &ndash; screenshot 6" class="software_photo_image image-replacement" onerror="this.onerror=null;this.src='https://devpost-challengepost.netdna-ssl.com/assets/defaults/thumbnail-placeholder-42bcab8d8178b413922ae2877d8b0868.gif';" src="//challengepost-s3-challengepost.netdna-ssl.com/photos/production/software_photos/000/772/148/datas/gallery.jpg">
                        </a>
                        <span class="expand-tag">
                            <i class="fas fa-expand">
                            </i>
                        </span>
                        <p>
                            <i>
                                ThreatMiner Enrichment
                            </i>
                        </p>
                    </li>
                    <li class="text-center">
                        <a data-lightbox="772149" data-title="All Records from Graph Security API" href="https://challengepost-s3-challengepost.netdna-ssl.com/photos/production/software_photos/000/772/149/datas/original.png">
                            <img alt="Microsoft Graph Security - Security Alerts Enrichment &ndash; screenshot 7" class="software_photo_image image-replacement" onerror="this.onerror=null;this.src='https://devpost-challengepost.netdna-ssl.com/assets/defaults/thumbnail-placeholder-42bcab8d8178b413922ae2877d8b0868.gif';" src="//challengepost-s3-challengepost.netdna-ssl.com/photos/production/software_photos/000/772/149/datas/gallery.jpg">
                        </a>
                        <span class="expand-tag">
                            <i class="fas fa-expand">
                            </i>
                        </span>
                        <p>
                            <i>
                                All Records from Graph Security API
                            </i>
                        </p>
                    </li>
                    <li class="text-center">
                        <a data-lightbox="772150" data-title="VirusTotal Enrichment 2" href="https://challengepost-s3-challengepost.netdna-ssl.com/photos/production/software_photos/000/772/150/datas/original.png">
                            <img alt="Microsoft Graph Security - Security Alerts Enrichment &ndash; screenshot 8" class="software_photo_image image-replacement" onerror="this.onerror=null;this.src='https://devpost-challengepost.netdna-ssl.com/assets/defaults/thumbnail-placeholder-42bcab8d8178b413922ae2877d8b0868.gif';" src="//challengepost-s3-challengepost.netdna-ssl.com/photos/production/software_photos/000/772/150/datas/gallery.jpg">
                        </a>
                        <span class="expand-tag">
                            <i class="fas fa-expand">
                            </i>
                        </span>
                        <p>
                            <i>
                                VirusTotal Enrichment 2
                            </i>
                        </p>
                    </li>
                    <li class="text-center">
                        <a data-lightbox="772151" data-title="Enrichment Updated Phase" href="https://challengepost-s3-challengepost.netdna-ssl.com/photos/production/software_photos/000/772/151/datas/original.png">
                            <img alt="Microsoft Graph Security - Security Alerts Enrichment &ndash; screenshot 9" class="software_photo_image image-replacement" onerror="this.onerror=null;this.src='https://devpost-challengepost.netdna-ssl.com/assets/defaults/thumbnail-placeholder-42bcab8d8178b413922ae2877d8b0868.gif';" src="//challengepost-s3-challengepost.netdna-ssl.com/photos/production/software_photos/000/772/151/datas/gallery.jpg">
                        </a>
                        <span class="expand-tag">
                            <i class="fas fa-expand">
                            </i>
                        </span>
                        <p>
                            <i>
                                Enrichment Updated Phase
                            </i>
                        </p>
                    </li>
                    <li class="text-center">
                        <a data-lightbox="772152" data-title="Graph Security Alert Network Details" href="https://challengepost-s3-challengepost.netdna-ssl.com/photos/production/software_photos/000/772/152/datas/original.png">
                            <img alt="Microsoft Graph Security - Security Alerts Enrichment &ndash; screenshot 10" class="software_photo_image image-replacement" onerror="this.onerror=null;this.src='https://devpost-challengepost.netdna-ssl.com/assets/defaults/thumbnail-placeholder-42bcab8d8178b413922ae2877d8b0868.gif';" src="//challengepost-s3-challengepost.netdna-ssl.com/photos/production/software_photos/000/772/152/datas/gallery.jpg">
                        </a>
                        <span class="expand-tag">
                            <i class="fas fa-expand">
                            </i>
                        </span>
                        <p>
                            <i>
                                Graph Security Alert Network Details
                            </i>
                        </p>
                    </li>
                    <li class="text-center">
                        <a data-lightbox="772153" data-title="Graph Security Alert General Details" href="https://challengepost-s3-challengepost.netdna-ssl.com/photos/production/software_photos/000/772/153/datas/original.png">
                            <img alt="Microsoft Graph Security - Security Alerts Enrichment &ndash; screenshot 11" class="software_photo_image image-replacement" onerror="this.onerror=null;this.src='https://devpost-challengepost.netdna-ssl.com/assets/defaults/thumbnail-placeholder-42bcab8d8178b413922ae2877d8b0868.gif';" src="//challengepost-s3-challengepost.netdna-ssl.com/photos/production/software_photos/000/772/153/datas/gallery.jpg">
                        </a>
                        <span class="expand-tag">
                            <i class="fas fa-expand">
                            </i>
                        </span>
                        <p>
                            <i>
                                Graph Security Alert General Details
                            </i>
                        </p>
                    </li>
                    <li class="text-center">
                        <a data-lightbox="772154" data-title="Graph Security Alert File Details" href="https://challengepost-s3-challengepost.netdna-ssl.com/photos/production/software_photos/000/772/154/datas/original.png">
                            <img alt="Microsoft Graph Security - Security Alerts Enrichment &ndash; screenshot 12" class="software_photo_image image-replacement" onerror="this.onerror=null;this.src='https://devpost-challengepost.netdna-ssl.com/assets/defaults/thumbnail-placeholder-42bcab8d8178b413922ae2877d8b0868.gif';" src="//challengepost-s3-challengepost.netdna-ssl.com/photos/production/software_photos/000/772/154/datas/gallery.jpg">
                        </a>
                        <span class="expand-tag">
                            <i class="fas fa-expand">
                            </i>
                        </span>
                        <p>
                            <i>
                                Graph Security Alert File Details
                            </i>
                        </p>
                    </li>
                    <li class="text-center">
                        <a data-lightbox="772155" data-title="Extracted Records from Graph Security API" href="https://challengepost-s3-challengepost.netdna-ssl.com/photos/production/software_photos/000/772/155/datas/original.png">
                            <img alt="Microsoft Graph Security - Security Alerts Enrichment &ndash; screenshot 13" class="software_photo_image image-replacement" onerror="this.onerror=null;this.src='https://devpost-challengepost.netdna-ssl.com/assets/defaults/thumbnail-placeholder-42bcab8d8178b413922ae2877d8b0868.gif';" src="//challengepost-s3-challengepost.netdna-ssl.com/photos/production/software_photos/000/772/155/datas/gallery.jpg">
                        </a>
                        <span class="expand-tag">
                            <i class="fas fa-expand">
                            </i>
                        </span>
                        <p>
                            <i>
                                Extracted Records from Graph Security API
                            </i>
                        </p>
                    </li>
                </ul>
            </div>
            <div>
                <h2>
                    Inspiration
                </h2>
                <p>
                    Enrich Graph Security alerts to create a threat intelligence feed
                </p>
                <h2>
                    What it does
                </h2>
                <p>
                    By using the
                    <a href="https://swimlane.com/" rel="nofollow">
                        Swimlane
                    </a>
                    platform and our
                    <a href="https://apphub.swimlane.com/#/bundle/cjqrdhjm107wz0fliuao4f9o2" rel="nofollow">
                        Microsoft Graph Security API
                    </a>
                    bundle, we have created two applications that store all Graph Security alerts and automate the creation of a threat intelligence feed as well as performing remediation against on on-premises firewall appliance.
                </p>
                <p>
                    We have a scheduled process (every hour - but is configurable) to continually pull and either create new records or update existing records in our MS Graph Hackathon application.
                </p>
                <p>
                    The second application, called MS Graph Hackathon - IPs, Hashes, and URLs extracts all ip addresses, hashes, or urls from the Graph Security alerts and stores this information in a record in this new application.  We then perform enrichment from 5 different sources depending on the type of extracted value we are needing to enrich.
                </p>
                <p>
                    <em>
                        Note: as an example we are performing enrichment using 5 different sources but this application can have less, more or different enrichment sources based on an organizations needs
                    </em>
                </p>
                <p>
                    Once enrichment is complete, we generate a threat feed that is automatically posted to a private (internal) GitHub repository.  We also use GitHub pages to render this threat feed.
                </p>
                <p>
                    <em>
                        Please note, that we are using GitHub as an example but an organization could store this threat feed in a different location using a pre-built bundle or a custom integration.
                    </em>
                </p>
                <p>
                    This generated threat feed can be used to enhance an organizations threat hunting activities and provide context surrounding Graph Alerts.
                </p>
                <p>
                    Our application can also automatically (or manually) perform automated remediation by adding IPs or URLs to a Palo Alto Panorama firewall.
                </p>
                <h2>
                    How we built it
                </h2>
                <p>
                    We built these applications utilizing the
                    <a href="https://swimlane.com/" rel="nofollow">
                        Swimlane
                    </a>
                    platform.  We used
                    <a href="https://swimlane.com/" rel="nofollow">
                        Swimlane
                    </a>
                    built bundles/integrations to perform most of the actions within this application but we did also write custom integrations within the Swimlane platform by creating script tasks using Python.
                </p>
                <h2>
                    Challenges we ran into
                </h2>
                <p>
                    Our biggest challenges were extrapolating and understanding what would be valuable in a threat feed from a users perspective.  We did tons of research by looking at other threat feeds and determined the best information based on the enrichment sources.
                </p>
                <p>
                    Additional challenges included identifying the best way to score each enrichment source, since most enrichment sources do not provide a straightforward
                    <em>
                        threat score
                    </em>
                    so we wrote custom Python script tasks to determine threat scores.
                </p>
                <h2>
                    Accomplishments that we're proud of
                </h2>
                <p>
                    We think that we have created a great resource that shows the power of SOAR.  Additionally, we were able to provide a tool/resource that is able to generate a threat feed from already known data - we believe this area is lacking in the security space.
                </p>
                <h2>
                    What we learned
                </h2>
                <p>
                    We learned a lot about how Microsoft Graph API works, especially the in's and out's of the Graph Security API
                    <strong>
                        alerts
                    </strong>
                    endpoint.  We now know that there is a lot of great information within the Graph Security API, but we think that we have augmented this information by automating the enrichment and remediation of these alerts.
                </p>
                <h2>
                    What's next for Microsoft Graph Security - Security Alerts Enrichment
                </h2>
                <p>
                    We plan on adding many more enrichment sources and adding the ability to perform remediation across a multitude of application types in the near future (e.g. EDR, SIEM, etc.).
                </p>
            </div>
            <div class="" id="built-with">
                <h2>
                    Built With
                </h2>
                <ul class="no-bullet inline-list">
                    <li>
                        <span class="cp-tag recognized-tag">
                            <a href="https://devpost.com/software/built-with/python">
                                python
                            </a>
                        </span>
                    </li>
                    <li>
                        <span class="cp-tag">
                            swimlane
                        </span>
                    </li>
                </ul>
            </div>
        </div>
    </body>
</html>
