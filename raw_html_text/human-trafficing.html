<html>
    <head>
    </head>
    <body>
        <div class="large-9 columns" id="app-details-left">
            <div id="gallery">
                <ul>
                    <li>
                        <div class="flex-video">
                            <iframe allowfullscreen="allowfullscreen" allowscriptaccess="always" class="video-embed" frameborder="0" height="371" mode="transparent" src="https://www.youtube.com/embed/MRg4x9s84I8?enablejsapi=1&amp;hl=en_US&amp;rel=0&amp;start=&amp;version=3&amp;wmode=transparent" type="text/html" webkitallowfullscreen="true" width="660" wmode="transparent">
                            </iframe>
                        </div>
                    </li>
                    <li class="text-center">
                        <a data-lightbox="688921" data-title="Stop Human Trafficking" href="https://challengepost-s3-challengepost.netdna-ssl.com/photos/production/software_photos/000/688/921/datas/original.jpg">
                            <img alt="human-trafficing &ndash; screenshot 1" class="software_photo_image image-replacement" onerror="this.onerror=null;this.src='https://devpost-challengepost.netdna-ssl.com/assets/defaults/thumbnail-placeholder-42bcab8d8178b413922ae2877d8b0868.gif';" src="//challengepost-s3-challengepost.netdna-ssl.com/photos/production/software_photos/000/688/921/datas/gallery.jpg">
                        </a>
                        <span class="expand-tag">
                            <i class="fas fa-expand">
                            </i>
                        </span>
                        <p>
                            <i>
                                Stop Human Trafficking
                            </i>
                        </p>
                    </li>
                </ul>
            </div>
            <div>
                <h1>
                    Human Trafficking Index
                </h1>
                <p>
                    This AWS Serverless Application views of the people at risk of Human Trafficking  listed here and stores it in an Amazon DynamoDB Table.
                </p>
                <p>
                    This application was created as part of a demo for the "Build on Serverless | Alexa and Serverless Apps - How to Hack for Good"
                </p>
                <p>
                    NOTE: Per the license this code is meant as an example and carries no warranty. Please learn from it!
                </p>
                <p>
                    The subject of this code is based nodejs and python files have been converted but remain unused and untested and there for dependency purposes. This was built on a used account and AWS IAM Policies will need to added to the current non-root user account.
                </p>
                <p>
                    Do not be tempted to publish AWS Serverless using your root credentials make a new user in AWS IAM and add only those policys needed my attaching policy if you make a json inline policy begin the policy with AWS_IAM_*, like * is CreateRole
                </p>
                <p>
                    NOTE: Per the license this code is meant as an example and carries no warranty.
No responsibilty for security breach of doing an AWS configure using root credentials is accepted!!!
                </p>
                <p>
                    Please learn from it!
                </p>
                <h2>
                    How does it work?
                </h2>
                <p>
                    This code makes use of the claudiia
                    <a href="https://github.com/claudiajs/claudia" rel="nofollow">
                        https://github.com/claudiajs/claudia
                    </a>
                    package to digest the HTML content of a website and make it available as an object that can be parsed in JSON. The code then looks for all records from the index table processed and creates a JSON structure that can be inserted into DynamoDB.
                </p>
                <p>
                    The code is executed as part of an AWS Lambda function (
                    <a href="https://aws.amazon.com/lambda" rel="nofollow">
                        https://aws.amazon.com/lambda
                    </a>
                    ) which can be triggered manually probably via and Alexa SDK Endpoint if so desired. The Lambda function can be deployed via AWS Serverless Application Model (AWS SAM) templates JSON package.json (see template.yml for python) have been created.
                </p>
                <h2>
                    External dependencies
                </h2>
                <p>
                    This application makes use of a few 3rd party external dependencies:
                </p>
                <ul>
                    <li>
                        boto3 -
                        <a href="https://github.com/boto/boto3" rel="nofollow">
                            https://github.com/boto/boto3
                        </a>
                    </li>
                    <li>
                        requests -
                        <a href="https://github.com/requests/requests" rel="nofollow">
                            https://github.com/requests/requests
                        </a>
                    </li>
                    <li>
                        claudiia -
                        <a href="https://code.launchpad.net/claudiia" rel="nofollow">
                            https://code.launchpad.net/claudiia
                        </a>
                    </li>
                </ul>
                <p>
                    To install the dependencies, run the following command in the root directory of the code for python:
                </p>
                <pre class="language-bash"><code>pip install -r requirements.txt -t ./
</code></pre>
                <h1>
                    Creating the Human Trafficking Index table
                </h1>
                <p>
                    Open AWS-cli 
''' $ aws dynamodb create-table --table-name humantraffic   --attribute-definitions AttributeName=humantrafficid,AttributeType=S   --key-schema AttributeName=humantrafficid,KeyType=HASH   --provisioned-throughput ReadCapacityUnits=1,WriteCapacityUnits=1   --region us-east-1   --query TableDescription.TableArn --output text'''
                </p>
                <h2>
                    resulting dynamodb arn
                </h2>
                <p>
                    arn:aws:dynamodb:us-east-1:1234nnnnnn:table/humantraffic
                </p>
                <h2>
                    Deploying the Application
                </h2>
                <p>
                    There are three primary ways to deploy this application:
                </p>
                <ol>
                    <li>
                        Use claudia to Deploy Node.js projects to AWS Lambda and API Gateway easily using claudia.js which will make AWS IAM policy and AWS Lambda Function. Create claudia.js
in AWS-cli.
                    </li>
                </ol>
                <p>
                    $ claudia create --region us-east-1 --api-module index --policies policy
                </p>
                <ol>
                    <li>
                        Use the AWS SAM CLI -
                        <a href="https://github.com/awslabs/aws-sam-cli" rel="nofollow">
                            https://github.com/awslabs/aws-sam-cli
                        </a>
                        via python pip
                    </li>
                </ol>
                <p>
                    $ aws cloudformation package --template template.yml --s3-bucket humantraffic --output-template template-export.yml
                </p>
                <ol>
                    <li>
                        Deploy via the AWS Serverless Application repository:
                        <a href="https://aws.amazon.com/serverless/serverlessrepo/" rel="nofollow">
                            https://aws.amazon.com/serverless/serverlessrepo/
                        </a>
                    </li>
                </ol>
                <h1>
                    Creating and deploying
                </h1>
                <p>
                    $ claudia create --region us-east-1 --api-module index --policies policy
                </p>
                <p>
                    The resulting output is the api is below remember to add all AWS IAM Api policy to your user account or this will fail
                </p>
                <p>
                    apigateway.createDeployment     restApiId=3qt51ctp55
                    <br>
                    {
  "lambda": {
  "role": "human-Trafficking-executor",
  "name": "human-Trafficking",
  "region": "us-east-1"
  },
  "api": {
  "id": "3qt51ctp55",
  "module": "index",
  "url": "
                    <a href="https://3qt51ctp55.execute-api.us-east-1.amazonaws.com/latest/humantraffic" rel="nofollow">
                        https://3qt51ctp55.execute-api.us-east-1.amazonaws.com/latest/humantraffic
                    </a>
                    "
  }
}
                </p>
                <h1>
                    Cloud Formation State
                </h1>
                <p>
                    {
   "StackId": "arn:aws:cloudformation:us-east-1:549511673151:stack/aws-serverless-repository-alexa-skills-kit-nodejs-factskillhumantrafic/1f6c5910-cc04-11e8-8258-500c2893c036",
                </p>
                <p>
                    "StackName": "aws-serverless-repository-alexa-skills-kit-nodejs-factskillhumantrafic",
                </p>
                <p>
                    "TemplateDescription": "Demonstrate human traffic Index built with the ASK NodeJS SDK",
                </p>
                <p>
                    "CreationTime": "2018-10-09T20:44:31.505Z",
                </p>
                <p>
                    "LastUpdatedTime": "2018-10-09T20:44:39.011Z GMT `15:44:39.0112 EST" ,
                </p>
                <p>
                    "StackStatus": "CREATE_COMPLETE"
 }
                </p>
                <p>
                    In this case we use the curl package so we can log the output
                </p>
                <h1>
                    List all people
                </h1>
                <p>
                    output all items in the tracking data in human-Trafficking table
                </p>
                <p>
                    curl "
                    <a href="https://3qt51ctp55.execute-api.us-east-1.amazonaws.com/latest/humantraffic" rel="nofollow">
                        https://3qt51ctp55.execute-api.us-east-1.amazonaws.com/latest/humantraffic
                    </a>
                    "
                </p>
                <h1>
                    Add a person
                </h1>
                <p>
                    curl -H "Content-Type: application/json" -X POST -d '{"humantrafficId":"123", "name":"Rene Gujan"}'
                    <a href="https://3qt51ctp55.execute-api.us-east-1.amazonaws.com/latest/humantraffic" rel="nofollow">
                        https://3qt51ctp55.execute-api.us-east-1.amazonaws.com/latest/humantraffic
                    </a>
                </p>
                <h1>
                    Testing deployment in a browser
                </h1>
                <p>
                    This is really very simmple open the browser and list all the people
output all items in the tracking data in human-Trafficking table
                </p>
                <p>
                    curl  "
                    <a href="https://3qt51ctp55.execute-api.us-east-1.amazonaws.com/latest/humantraffic" rel="nofollow">
                        https://3qt51ctp55.execute-api.us-east-1.amazonaws.com/latest/humantraffic
                    </a>
                    "
                </p>
                <p>
                    Open a new tab in the browser paste the url, inside quotes.
                </p>
                <p>
                    <a href="https://3qt51ctp55.execute-api.us-east-1.amazonaws.com/latest/humantraffic" rel="nofollow">
                        https://3qt51ctp55.execute-api.us-east-1.amazonaws.com/latest/humantraffic
                    </a>
                </p>
                <p>
                    The initial output with one entry is 
[{"name":"Fernando","humantrafficid":"258"}]
                </p>
                <p>
                    When taking advantage of dynamoDB add an extra record to list any extra infomation we get, this is becomes humantraffic index table has been fully populated an item being shown below is the largest entry
                </p>
                <p>
                    [{"name":"Fernando","humantrafficid":"258"},{"humantrafficid":"128","name":"Rene","Street":"Spilsby Road","lastName":"Gujaran","town":"Boston","Country birth":"Mexico","building":"The Mill Apartments","zip code":"MA1 234","state":"MA"}]
                </p>
                <p>
                    Now anyone through out the world can read this in a browser, but only you can update this table with curl command above from the AWS-cli. The generated code is protected by using a non-root credentials.
                </p>
                <h1>
                    Add a person
                </h1>
                <p>
                    curl -H "Content-Type: application/json" -X POST -d '{"humantrafficId":"123", "name":"Rene Gujan"}'
                    <a href="https://3qt51ctp55.execute-api.us-east-1.amazonaws.com/latest/humantraffic" rel="nofollow">
                        https://3qt51ctp55.execute-api.us-east-1.amazonaws.com/latest/humantraffic
                    </a>
                </p>
                <h1>
                    Alexa connection
                </h1>
                <p>
                    The files to deploy the alexa Lambda have been added, but the linking to the Alexa Lambda is incomplete due to the lack of time
                </p>
                <p>
                    ==============================================
                </p>
                <p>
                    Copyright 2018 Amazon.com, Inc. or its affiliates. All Rights Reserved.
                </p>
                <p>
                    SPDX-License-Identifier: MIT-0
                </p>
            </div>
            <div class="" id="built-with">
                <h2>
                    Built With
                </h2>
                <ul class="no-bullet inline-list">
                    <li>
                        <span class="cp-tag recognized-tag">
                            <a href="https://devpost.com/software/built-with/javascript">
                                javascript
                            </a>
                        </span>
                    </li>
                </ul>
            </div>
            <nav class="app-links section">
                <h2>
                    Try it out
                </h2>
                <ul class="no-bullet" data-role="software-urls">
                    <li>
                        <a href="https://3qt51ctp55.execute-api.us-east-1.amazonaws.com/latest/humantraffic" rel="nofollow" target="_blank" title="https://3qt51ctp55.execute-api.us-east-1.amazonaws.com/latest/humantraffic">
                            <i class="ss-icon ss-link">
                            </i>
                            <span>
                                3qt51ctp55.execute-api.us-east-1.amazonaws.com
                            </span>
                        </a>
                    </li>
                </ul>
            </nav>
        </div>
    </body>
</html>
