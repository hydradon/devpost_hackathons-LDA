<html>
    <head>
    </head>
    <body>
        <div class="large-9 columns" id="app-details-left">
            <div id="gallery">
                <ul>
                    <li>
                        <div class="flex-video">
                            <iframe allowfullscreen="allowfullscreen" allowscriptaccess="always" class="video-embed" frameborder="0" height="371" mode="transparent" src="https://www.youtube.com/embed/HmiJHnkubPw?enablejsapi=1&amp;hl=en_US&amp;rel=0&amp;start=&amp;version=3&amp;wmode=transparent" type="text/html" webkitallowfullscreen="true" width="660" wmode="transparent">
                            </iframe>
                        </div>
                    </li>
                    <li class="text-center">
                        <a data-lightbox="671719" data-title="screenshot test send mails" href="https://challengepost-s3-challengepost.netdna-ssl.com/photos/production/software_photos/000/671/719/datas/original.png">
                            <img alt="OutlookActivities &ndash; screenshot 1" class="software_photo_image image-replacement" onerror="this.onerror=null;this.src='https://devpost-challengepost.netdna-ssl.com/assets/defaults/thumbnail-placeholder-42bcab8d8178b413922ae2877d8b0868.gif';" src="//challengepost-s3-challengepost.netdna-ssl.com/photos/production/software_photos/000/671/719/datas/gallery.jpg">
                        </a>
                        <span class="expand-tag">
                            <i class="fas fa-expand">
                            </i>
                        </span>
                        <p>
                            <i>
                                screenshot test send mails
                            </i>
                        </p>
                    </li>
                    <li class="text-center">
                        <a data-lightbox="671720" data-title="screenshot test split mails" href="https://challengepost-s3-challengepost.netdna-ssl.com/photos/production/software_photos/000/671/720/datas/original.png">
                            <img alt="OutlookActivities &ndash; screenshot 2" class="software_photo_image image-replacement" onerror="this.onerror=null;this.src='https://devpost-challengepost.netdna-ssl.com/assets/defaults/thumbnail-placeholder-42bcab8d8178b413922ae2877d8b0868.gif';" src="//challengepost-s3-challengepost.netdna-ssl.com/photos/production/software_photos/000/671/720/datas/gallery.jpg">
                        </a>
                        <span class="expand-tag">
                            <i class="fas fa-expand">
                            </i>
                        </span>
                        <p>
                            <i>
                                screenshot test split mails
                            </i>
                        </p>
                    </li>
                </ul>
            </div>
            <div>
                <h2>
                    Inspiration
                </h2>
                <p>
                    I wanted to use UIPath to create a mail merge with customized attachments, but I had some shortcomings when I wanted to change the number of attachments dynamically as well if I wanted to send from a shared mailbox.
Once this was built a new Idea came along to make an outlook activity to follow up if mails are replied yet. This can be used by a lot of support and help desk departments.
                </p>
                <h2>
                    What it does
                </h2>
                <ol>
                    <li>
                        It starts from your active outlook client and create an email (mailItem). This is similar to the standard 'send outlook mail message'. I added the feature of adding a collection of attachments to the mail as well as the possibility to send from a shared mailbox (
                        <a href="https://www.sherweb.com/blog/wp-content/uploads/Outlook-Shared-Mailboxes-How-to-Use-and-Configure-Them-Delegate-Access-Data-File-Properties.png" rel="nofollow">
                            like a company helpdesk account
                        </a>
                        ). I know you can also do this using the smtp component, but in a lot of companies the business users are not allowed to send directly using the smtp server due to security policies.
                    </li>
                    <li>
                        Here you start from a mail folder from which you want a list of mails that are replied yet and the once that still waits on a reply
                    </li>
                </ol>
                <h2>
                    How I built it
                </h2>
                <p>
                    Starting from the UIPath tutorial, I create a code activity based on the outlook .net class. I made a test console to test the .net functionality and later on a test module to invoke a workflow.
                </p>
                <h2>
                    Challenges I ran into
                </h2>
                <ol>
                    <li>
                        The Standard UIPath mail activities use the mailmessage object. This was however not suitable for the solution, because for example there is no standard shared mailbox property. Outlook have its own more elaborated object mailItem, which a lot of extra properties. Running through the outlook mail folders was somewhat challenging, some recursive approach was necessary.
/li&gt;
                    </li>
                    <li>
                        The most difficult thing in the second activity was figuring out how to link to messages as reply on each other. I found out that Microsoft has introduced a conversation feature for this.
                    </li>
                </ol>
                <h2>
                    Accomplishments that I'm proud of
                </h2>
                <p>
                    I used this component at my company and created in 3 minutes 200 mails with customized attachment from a shared mailbox. It was used in a
                    <b>
                        demo presented by to the CEO of KBC AM
                    </b>
                    <a href="https://www.bloomberg.com/quote/KBC:LI" rel="nofollow">
                        link
                    </a>
                    . 
This was more robust and much faster than using the outlook GUI and create new mail with copy and paste.
I added the component to the uipath gallery and I'm proud it is
                    <b>
                        the most downloaded
                    </b>
                    <a href="https://gallery.uipath.com/" rel="nofollow">
                        custom components
                    </a>
                    .
                </p>
                <h2>
                    What I learned
                </h2>
                <p>
                    I discovered a part of the .net technology behind the UIPath suite, the windows workflow which is very interesting.
In my opinion it is better to declare the booleans as inarguments so you can attach a variable to it in the UIstudio, instead of using the tick boxes.  For example if you want to test you program you can set 'isDraft' by a variable instead of the tick box. This would allow you to make test xamls for some standard workflows.
                </p>
                <h2>
                    What's next for OutlookActivities
                </h2>
                <p>
                    I Want to create a native component as container of my code activities and look into a limited GUI to for example select the mail folder. 
As a further step I also want to resend a mailItem object directly once for example when it is detected as not yet responded in time. 
And I was thinking of creating a component to send out calendar invites.
                </p>
                <h2>
                    Demo's
                </h2>
                <p>
                    demo: send mail with dynamic number of attachments and move mail automatically to an arbitrary folder
                    <a href="https://www.youtube.com/watch?v=hjZD8U2eJ_w" rel="nofollow">
                        link
                    </a>
                    .
                </p>
                <p>
                    demo: split mails into list of replied and unreplied mails
                    <a href="https://www.youtube.com/watch?v=_78ktX--b4c" rel="nofollow">
                        link
                    </a>
                </p>
            </div>
            <div class="" id="built-with">
                <h2>
                    Built With
                </h2>
                <ul class="no-bullet inline-list">
                    <li>
                        <span class="cp-tag recognized-tag">
                            <a href="https://devpost.com/software/built-with/net">
                                .net
                            </a>
                        </span>
                    </li>
                    <li>
                        <span class="cp-tag recognized-tag">
                            <a href="https://devpost.com/software/built-with/c--2">
                                c#
                            </a>
                        </span>
                    </li>
                </ul>
            </div>
            <nav class="app-links section">
                <h2>
                    Try it out
                </h2>
                <ul class="no-bullet" data-role="software-urls">
                    <li>
                        <a href="https://bitbucket.org/tomdhaene/uipath_outlook_activities/src/master/" rel="nofollow" target="_blank" title="https://bitbucket.org/tomdhaene/uipath_outlook_activities/src/master/">
                            <i class="ss-icon ss-link">
                            </i>
                            <span>
                                bitbucket.org
                            </span>
                        </a>
                    </li>
                    <li>
                        <a href="https://gallery.uipath.com/packages/OutlookActivities/" rel="nofollow" target="_blank" title="https://gallery.uipath.com/packages/OutlookActivities/">
                            <i class="ss-icon ss-link">
                            </i>
                            <span>
                                gallery.uipath.com
                            </span>
                        </a>
                    </li>
                </ul>
            </nav>
        </div>
    </body>
</html>
