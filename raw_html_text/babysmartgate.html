<html>
    <head>
    </head>
    <body>
        <div class="large-9 columns" id="app-details-left">
            <div id="gallery">
                <ul>
                    <li>
                        <div class="flex-video">
                            <iframe allowfullscreen="allowfullscreen" allowscriptaccess="always" class="video-embed" frameborder="0" height="371" mode="transparent" src="https://player.vimeo.com/video/227374685?byline=0&amp;portrait=0&amp;title=0#t=" type="text/html" webkitallowfullscreen="true" width="660" wmode="transparent">
                            </iframe>
                        </div>
                    </li>
                    <li class="text-center">
                        <a data-lightbox="522948" data-title="Presenting... The Baby SmartGate!" href="https://challengepost-s3-challengepost.netdna-ssl.com/photos/production/software_photos/000/522/948/datas/original.jpg">
                            <img alt="Baby SmartGate &ndash; screenshot 1" class="software_photo_image image-replacement" onerror="this.onerror=null;this.src='https://devpost-challengepost.netdna-ssl.com/assets/defaults/thumbnail-placeholder-42bcab8d8178b413922ae2877d8b0868.gif';" src="//challengepost-s3-challengepost.netdna-ssl.com/photos/production/software_photos/000/522/948/datas/gallery.jpg">
                        </a>
                        <span class="expand-tag">
                            <i class="fas fa-expand">
                            </i>
                        </span>
                        <p>
                            <i>
                                Presenting... The Baby SmartGate!
                            </i>
                        </p>
                    </li>
                    <li class="text-center">
                        <a data-lightbox="522946" data-title="Closed - Green light." href="https://challengepost-s3-challengepost.netdna-ssl.com/photos/production/software_photos/000/522/946/datas/original.JPG">
                            <img alt="Baby SmartGate &ndash; screenshot 2" class="software_photo_image image-replacement" onerror="this.onerror=null;this.src='https://devpost-challengepost.netdna-ssl.com/assets/defaults/thumbnail-placeholder-42bcab8d8178b413922ae2877d8b0868.gif';" src="//challengepost-s3-challengepost.netdna-ssl.com/photos/production/software_photos/000/522/946/datas/gallery.jpg">
                        </a>
                        <span class="expand-tag">
                            <i class="fas fa-expand">
                            </i>
                        </span>
                        <p>
                            <i>
                                Closed - Green light.
                            </i>
                        </p>
                    </li>
                    <li class="text-center">
                        <a data-lightbox="522941" data-title="Open - Red light." href="https://challengepost-s3-challengepost.netdna-ssl.com/photos/production/software_photos/000/522/941/datas/original.JPG">
                            <img alt="Baby SmartGate &ndash; screenshot 3" class="software_photo_image image-replacement" onerror="this.onerror=null;this.src='https://devpost-challengepost.netdna-ssl.com/assets/defaults/thumbnail-placeholder-42bcab8d8178b413922ae2877d8b0868.gif';" src="//challengepost-s3-challengepost.netdna-ssl.com/photos/production/software_photos/000/522/941/datas/gallery.jpg">
                        </a>
                        <span class="expand-tag">
                            <i class="fas fa-expand">
                            </i>
                        </span>
                        <p>
                            <i>
                                Open - Red light.
                            </i>
                        </p>
                    </li>
                    <li class="text-center">
                        <a data-lightbox="522943" data-title="Reed switch and magnet install." href="https://challengepost-s3-challengepost.netdna-ssl.com/photos/production/software_photos/000/522/943/datas/original.JPG">
                            <img alt="Baby SmartGate &ndash; screenshot 4" class="software_photo_image image-replacement" onerror="this.onerror=null;this.src='https://devpost-challengepost.netdna-ssl.com/assets/defaults/thumbnail-placeholder-42bcab8d8178b413922ae2877d8b0868.gif';" src="//challengepost-s3-challengepost.netdna-ssl.com/photos/production/software_photos/000/522/943/datas/gallery.jpg">
                        </a>
                        <span class="expand-tag">
                            <i class="fas fa-expand">
                            </i>
                        </span>
                        <p>
                            <i>
                                Reed switch and magnet install.
                            </i>
                        </p>
                    </li>
                    <li class="text-center">
                        <a data-lightbox="522942" data-title="Shock and movement insulated." href="https://challengepost-s3-challengepost.netdna-ssl.com/photos/production/software_photos/000/522/942/datas/original.JPG">
                            <img alt="Baby SmartGate &ndash; screenshot 5" class="software_photo_image image-replacement" onerror="this.onerror=null;this.src='https://devpost-challengepost.netdna-ssl.com/assets/defaults/thumbnail-placeholder-42bcab8d8178b413922ae2877d8b0868.gif';" src="//challengepost-s3-challengepost.netdna-ssl.com/photos/production/software_photos/000/522/942/datas/gallery.jpg">
                        </a>
                        <span class="expand-tag">
                            <i class="fas fa-expand">
                            </i>
                        </span>
                        <p>
                            <i>
                                Shock and movement insulated.
                            </i>
                        </p>
                    </li>
                    <li class="text-center">
                        <a data-lightbox="522947" data-title="Overview of the circuit.  Note the low power sleep mode." href="https://challengepost-s3-challengepost.netdna-ssl.com/photos/production/software_photos/000/522/947/datas/original.png">
                            <img alt="Baby SmartGate &ndash; screenshot 6" class="software_photo_image image-replacement" onerror="this.onerror=null;this.src='https://devpost-challengepost.netdna-ssl.com/assets/defaults/thumbnail-placeholder-42bcab8d8178b413922ae2877d8b0868.gif';" src="//challengepost-s3-challengepost.netdna-ssl.com/photos/production/software_photos/000/522/947/datas/gallery.jpg">
                        </a>
                        <span class="expand-tag">
                            <i class="fas fa-expand">
                            </i>
                        </span>
                        <p>
                            <i>
                                Overview of the circuit.  Note the low power sleep mode.
                            </i>
                        </p>
                    </li>
                </ul>
            </div>
            <div>
                <h2>
                    Inspiration
                </h2>
                <p>
                    We have an 8 month old daughter who just started to crawl so I installed a baby gate at the top of our stairs to prevent falls.  The problem is, making sure it's always properly closed can be difficult, especially for new parents like us.  You can forget to close it because you are in a hurry or not bother closing it because "I'll just be gone for a second".  And sometimes you think you closed it but it didn't latch properly.  I designed the Baby SmartGate to solve these issues and increase the safety of our home!
                </p>
                <h2>
                    What it does
                </h2>
                <p>
                    The Baby SmartGate uses a reed switch to detect if the gate is opened or closed.  Once the gate has been opened it turns on a red LED and starts a timer.  If the gate hasn't been closed in the allotted time (in this case, 10 seconds) it starts a procedure to alert those nearby.  For 8 seconds it starts beeping and increases the LED brightness.  Then for another 8 seconds it further increases the LED brightness and beeping intensity.  Finally the LED starts flashing and the buzzer is at full blast.  Hopefully an adult will notice and close the gate!
                </p>
                <p>
                    When the gate is closed it briefly turns on a green LED to let the parent know it is secure and then goes back to sleep.
                </p>
                <p>
                    The idea is that the alerting will help "train" the parents to always close the gate and make it a habit.  Without an alert it would be easier to become lazy with the gate, which is often what results in accidents.
                </p>
                <h2>
                    How I built it
                </h2>
                <p>
                    The design was fairly simple.  I opened up the latching parts of the gate and found that a cylindrical reed switch fit perfectly into both sides.  The magnet part of the switch fits in the swinging gate and thus doesn't require a power source.  The other side of the switch connects to the Arduino 101 which has a rising edge interrupt setup on the pin.  I also connected an RGB LED and active buzzer for visual and auditory alerts and a button to allow me to mute the buzzer if I need the gate opened for an extended period of time.
                </p>
                <p>
                    When the reed switch is closed I put the Arduino 101 (Curie) into a sleep state to conserve power.  When the switch is opened it fires the interrupt which starts my state machine to go through the various alert levels.  I also used the CurieTimerOne to create an interrupt driven PWM on the buzzer pin to simplify my beeping routines.
                </p>
                <h2>
                    Challenges I ran into
                </h2>
                <p>
                    There weren't many challenges with the core design but I did run into issues when trying to improve it.  First the library I used for the Curie sleep and interrupts is not "official" yet and has some issues.  I wanted to use PM.sleep(x) durations for my alert level timers to conserve more power but they were causing weird behavior.  Also, to eliminate the need for constantly checking the state of the switch in the state machine I tried to use normal interrupts but was having issues with detaching and reattaching the Curie sleep interrupts.
                </p>
                <p>
                    I also experimented with adding the CurieBLE library to send a message to the user's phone when the gate was opened but the connection would always get lost when I put the Curie to sleep even though the Curie datasheet says BLE should be able to operate when the SoC is sleeping.  The firmware for Curie seems to still be in development in this area so I dropped this idea as I wanted this to be a battery powered device and needed the sleep state to work.
                </p>
                <h2>
                    Accomplishments that I'm proud of
                </h2>
                <p>
                    Mainly I'm just happy that this project helped improve the safety of my home for my newborn daughter.  A recent study showed that every 5 minutes a child in the US falls down the stairs and is sent to the emergency room*.  If something like this could help prevent just one child from falling down the stairs it would be worth the incremental cost to existing baby gates.
                </p>
                <h2>
                    What I learned
                </h2>
                <p>
                    I hadn't used interrupts or state machines before in Arduino code so that was a good learning experience.  Also, I'm happy to have learned just how low Curie's power consumption is while in sleep which gives me ideas for a number of future battery driven projects.
                </p>
                <h2>
                    What's next for Baby SmartGate
                </h2>
                <p>
                    I need to do power calculations to see how long it could last on a battery as it would not be feasible to have this plugged in.  Also, I would need to find a Curie board with a smaller footprint than the Arduino 101 so I can mount it easier, preferably inside the existing gate, or the whole thing should be put in some type of enclosure for safety and aesthetics.  I'd also like to get the BLE working with the sleep states and find a cheap BLE gateway it could communicate with to connect to the internet and send text messages when the gate has been opened for too long.
                </p>
                <p>
                    I'd also like to look into a simplified version of this using just a 555 CMOS timer.  The core functionality of this project quite honestly does not require a microcontroller.
                </p>
                <p>
                    *
                    <a href="http://pediatrics.aappublications.org/content/early/2012/03/07/peds.2011-2314" rel="nofollow">
                        http://pediatrics.aappublications.org/content/early/2012/03/07/peds.2011-2314
                    </a>
                </p>
            </div>
            <div class="" id="built-with">
                <h2>
                    Built With
                </h2>
                <ul class="no-bullet inline-list">
                    <li>
                        <span class="cp-tag">
                            arduino-101
                        </span>
                    </li>
                    <li>
                        <span class="cp-tag">
                            intel-curie
                        </span>
                    </li>
                    <li>
                        <span class="cp-tag">
                            reed-switch
                        </span>
                    </li>
                </ul>
            </div>
        </div>
    </body>
</html>
