<html>
    <head>
    </head>
    <body>
        <div class="large-9 columns" id="app-details-left">
            <div id="gallery">
                <ul>
                    <li class="text-center">
                        <a data-lightbox="638748" href="https://challengepost-s3-challengepost.netdna-ssl.com/photos/production/software_photos/000/638/748/datas/original.png">
                            <img alt="Mar.AI &ndash; screenshot 1" class="software_photo_image image-replacement" onerror="this.onerror=null;this.src='https://devpost-challengepost.netdna-ssl.com/assets/defaults/thumbnail-placeholder-42bcab8d8178b413922ae2877d8b0868.gif';" src="//challengepost-s3-challengepost.netdna-ssl.com/photos/production/software_photos/000/638/748/datas/gallery.jpg">
                        </a>
                        <span class="expand-tag">
                            <i class="fas fa-expand">
                            </i>
                        </span>
                        <p>
                            <i>
                            </i>
                        </p>
                    </li>
                    <li class="text-center">
                        <a data-lightbox="638721" data-title="Our AI is trained in Time-Trial mode, but can still race in Grand Prix mode." href="https://challengepost-s3-challengepost.netdna-ssl.com/photos/production/software_photos/000/638/721/datas/original.png">
                            <img alt="Mar.AI &ndash; screenshot 2" class="software_photo_image image-replacement" onerror="this.onerror=null;this.src='https://devpost-challengepost.netdna-ssl.com/assets/defaults/thumbnail-placeholder-42bcab8d8178b413922ae2877d8b0868.gif';" src="//challengepost-s3-challengepost.netdna-ssl.com/photos/production/software_photos/000/638/721/datas/gallery.jpg">
                        </a>
                        <span class="expand-tag">
                            <i class="fas fa-expand">
                            </i>
                        </span>
                        <p>
                            <i>
                                Our AI is trained in Time-Trial mode, but can still race in Grand Prix mode.
                            </i>
                        </p>
                    </li>
                    <li class="text-center">
                        <a data-lightbox="638739" data-title="A demonstration of the search process. The AI simulates the outcomes of 11 angles, choosing the angle yielding the greatest progress." href="https://challengepost-s3-challengepost.netdna-ssl.com/photos/production/software_photos/000/638/739/datas/original.png">
                            <img alt="Mar.AI &ndash; screenshot 3" class="software_photo_image image-replacement" onerror="this.onerror=null;this.src='https://devpost-challengepost.netdna-ssl.com/assets/defaults/thumbnail-placeholder-42bcab8d8178b413922ae2877d8b0868.gif';" src="//challengepost-s3-challengepost.netdna-ssl.com/photos/production/software_photos/000/638/739/datas/gallery.jpg">
                        </a>
                        <span class="expand-tag">
                            <i class="fas fa-expand">
                            </i>
                        </span>
                        <p>
                            <i>
                                A demonstration of the search process. The AI simulates the outcomes of 11 angles, choosing the angle yielding the greatest progress.
                            </i>
                        </p>
                    </li>
                    <li class="text-center">
                        <a data-lightbox="638722" data-title="The paths that the kart takes using the DAGGER approach (Green Lines). The blue line shows the path of the CNN AI playing in real-time." href="https://challengepost-s3-challengepost.netdna-ssl.com/photos/production/software_photos/000/638/722/datas/original.png">
                            <img alt="Mar.AI &ndash; screenshot 4" class="software_photo_image image-replacement" onerror="this.onerror=null;this.src='https://devpost-challengepost.netdna-ssl.com/assets/defaults/thumbnail-placeholder-42bcab8d8178b413922ae2877d8b0868.gif';" src="//challengepost-s3-challengepost.netdna-ssl.com/photos/production/software_photos/000/638/722/datas/gallery.jpg">
                        </a>
                        <span class="expand-tag">
                            <i class="fas fa-expand">
                            </i>
                        </span>
                        <p>
                            <i>
                                The paths that the kart takes using the DAGGER approach (Green Lines). The blue line shows the path of the CNN AI playing in real-time.
                            </i>
                        </p>
                    </li>
                    <li class="text-center">
                        <a data-lightbox="638720" data-title="A visualization of the first layer activation functions for a single input image." href="https://challengepost-s3-challengepost.netdna-ssl.com/photos/production/software_photos/000/638/720/datas/original.png">
                            <img alt="Mar.AI &ndash; screenshot 5" class="software_photo_image image-replacement" onerror="this.onerror=null;this.src='https://devpost-challengepost.netdna-ssl.com/assets/defaults/thumbnail-placeholder-42bcab8d8178b413922ae2877d8b0868.gif';" src="//challengepost-s3-challengepost.netdna-ssl.com/photos/production/software_photos/000/638/720/datas/gallery.jpg">
                        </a>
                        <span class="expand-tag">
                            <i class="fas fa-expand">
                            </i>
                        </span>
                        <p>
                            <i>
                                A visualization of the first layer activation functions for a single input image.
                            </i>
                        </p>
                    </li>
                </ul>
            </div>
            <div>
                <h2>
                    Inspiration
                </h2>
                <h2>
                    What it does
                </h2>
                <p>
                    Mar.AI is an AI in Mario Kart 64 for the BizHawk emulator. Essentially the game is run using the bizhawk emulator and a python server with the model is started which interacts with the emulator through a lua script.
                </p>
                <h2>
                    How I built it
                </h2>
                <p>
                    This was built using Keras with a Tensorflow backend due to time constraints using NVidia's CNN Architecture. I then used weatherton's lua scripts to read some the the input from the memory rather than determining where all the values are stored. Afterwards, it was simply a matter of connecting the systems (done through a local server) and training the AI.
                </p>
                <h2>
                    Challenges I ran into
                </h2>
                <p>
                    The biggest challenge I ran into was configuring the entire ecosystem. The neural network model was built, however I still had to determine what types of input and output I would be able to use. I decided on image input which could be read from the game memory rather than the computer screen so that the size of the window did not matter. Then to simplify the game, only steering output was determined which made the process a lot easier.
                </p>
                <h2>
                    Accomplishments that I'm proud of
                </h2>
                <p>
                    I am proud of creating an RL algorithm which was sped up using the DAGGER search algorithm to determine a decent solution which was then imporved through the use of a CNN
                </p>
                <h2>
                    What I learned
                </h2>
                <p>
                    I learned a lot more about Imitation Learning and how using that process in addition to a CNN, would allow me to actually improve the system alot. Rather than simply calculating all the possible Q-values from the map, or simply estimating it, I calculated a smaller portion, learned, predicted, and kept iterating.
                </p>
                <h2>
                    References
                </h2>
                <p>
                    TensorKart - The first MarioKart deep learning project, which was used for inspiration.
                </p>
                <p>
                    Deep Learning for Real-Time Atari Game Play Using Offline Monte-Carlo Tree Search Planning - The idea for using a search-based AI for teaching the Convnet AI came from this paper.
                </p>
                <p>
                    A Reduction of Imitation Learning and Structured Prediction to No-Regret Online Learning - The DAGGER algorithm was first introduced in this paper.
                </p>
                <p>
                    MarioKart 64 NEAT - This AI uses the NEAT algorithm to genetically evolve a shallow neural network
                </p>
                <p>
                    weatherton/BizHawkMarioKart64 - Some MarioKart 64 scripts which we used as a reference for memory read/write locations
                </p>
            </div>
            <div class="" id="built-with">
                <h2>
                    Built With
                </h2>
                <ul class="no-bullet inline-list">
                    <li>
                        <span class="cp-tag">
                            ai
                        </span>
                    </li>
                    <li>
                        <span class="cp-tag">
                            bizhawk
                        </span>
                    </li>
                    <li>
                        <span class="cp-tag">
                            keras
                        </span>
                    </li>
                    <li>
                        <span class="cp-tag recognized-tag">
                            <a href="https://devpost.com/software/built-with/lua">
                                lua
                            </a>
                        </span>
                    </li>
                    <li>
                        <span class="cp-tag recognized-tag">
                            <a href="https://devpost.com/software/built-with/machine-learning">
                                machine-learning
                            </a>
                        </span>
                    </li>
                    <li>
                        <span class="cp-tag">
                            matplotlib
                        </span>
                    </li>
                    <li>
                        <span class="cp-tag recognized-tag">
                            <a href="https://devpost.com/software/built-with/python">
                                python
                            </a>
                        </span>
                    </li>
                    <li>
                        <span class="cp-tag">
                            tensorflow
                        </span>
                    </li>
                </ul>
            </div>
            <nav class="app-links section">
                <h2>
                    Try it out
                </h2>
                <ul class="no-bullet" data-role="software-urls">
                    <li>
                        <a href="https://github.com/bayoumi17m/Mar.AI" rel="nofollow" target="_blank" title="https://github.com/bayoumi17m/Mar.AI">
                            <i class="ss-icon ss-link">
                            </i>
                            <span>
                                github.com
                            </span>
                        </a>
                    </li>
                </ul>
            </nav>
        </div>
    </body>
</html>
