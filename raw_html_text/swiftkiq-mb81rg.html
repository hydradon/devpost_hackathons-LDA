<html>
    <head>
    </head>
    <body>
        <div class="large-9 columns" id="app-details-left">
            <div>
                <h2>
                    Inspiration
                </h2>
                <ul>
                    <li>
                        Swift can be done all your tasks.  - Swiftがすべての仕事を終わらせてくれる
                    </li>
                    <li>
                        Run swift on your powerful servers as you like. - 最強のマシンの上で好きなだけSwiftを働かせよう
                    </li>
                </ul>
                <h2>
                    What it does
                </h2>
                <ul>
                    <li>
                        Swiftkiq is the framework for job queue system.
                    </li>
                    <li>
                        Work your swift code on distributed environment as job queue system
                        <ul>
                            <li>
                                manage job's retry flow
                            </li>
                            <li>
                                manage threads
                            </li>
                            <li>
                                manage process as daemon
                            </li>
                        </ul>
                    </li>
                </ul>
                <h3>
                    Samples
                </h3>
                <p>
                    here is runnable example
                    <a href="https://github.com/ainame/Swiftkiq/tree/master/Examples" rel="nofollow">
                        https://github.com/ainame/Swiftkiq/tree/master/Examples
                    </a>
                </p>
                <p>
                    worker
                </p>
                <pre class="language-swift"><code>  import Swiftkiq

        class EchoWorker: Worker {
        struct Args: Argument {
        public var message: String
        public func toDictionary() -&gt; [String: Any] {
        return ["message": message]
        }

        static func from(_ dictionary: Dictionary&lt;String, Any&gt;) -&gt; Args {
        return Args(message: dictionary["message"] as! String)
        }
        }
        var processorId: Int?
        var jid: String?
        var queue: Queue?
        var retry: Int?

        required init() {}

        func perform(_ args: Args) throws {
        print(args.message)
        }
  }
</code></pre>
                <p>
                    run script
                </p>
                <pre class="language-swift"><code>  import Foundation
        import Swiftkiq

  let router = Router()
  let options = LaunchOptions(
  concurrency: 25,
  queues: [Queue(rawValue: "default"), Queue(rawValue: "other")],
  router: router,
  daemonize: false
  )

  let launcher = Launcher(options: options)
  launcher.run()
  while true {
  sleep(1)
  }
</code></pre>
                <ul>
                    <li>
                        <a href="https://github.com/ainame/Swiftkiq" rel="nofollow">
                            https://github.com/ainame/Swiftkiq
                        </a>
                    </li>
                    <li>
                        <a href="https://github.com/ainame/Daemon" rel="nofollow">
                            https://github.com/ainame/Daemon
                        </a>
                    </li>
                    <li>
                        <a href="https://github.com/ainame/Kitura-redis/commit/ac2ced28f46a2657b836310eee21b94faca8350b" rel="nofollow">
                            https://github.com/ainame/Kitura-redis/commit/ac2ced28f46a2657b836310eee21b94faca8350b
                        </a>
                    </li>
                </ul>
                <h2>
                    How I built it
                </h2>
                <ul>
                    <li>
                        port Sidekiq on Ruby to Swift
                    </li>
                    <li>
                        build demo application
                    </li>
                </ul>
                <p>
                    demo application is here
                    <a href="https://github.com/radioboo/Scraper" rel="nofollow">
                        https://github.com/radioboo/Scraper
                    </a>
                </p>
                <h2>
                    Challenges I ran into
                </h2>
                <h3>
                    Different from ruby's implementation
                </h3>
                <ul>
                    <li>
                        type safe arguments
                    </li>
                    <li>
                        can run native built code
                    </li>
                    <li>
                        can use multi core cpu
                        <ul>
                            <li>
                                ruby is stricted by GIL(global interpreter lock)
                            </li>
                        </ul>
                    </li>
                </ul>
                <h3>
                    Swift's problem
                </h3>
                <ul>
                    <li>
                        Dynamic dispatching workers from string
                        <ul>
                            <li>
                                use
                                <code>
                                    krzysztofzablocki/Sourcery
                                </code>
                                to generate routing table for workers
                            </li>
                        </ul>
                    </li>
                    <li>
                        Can't use thread local storage with GCD
                        <ul>
                            <li>
                                make instance cache be thread safety
                            </li>
                        </ul>
                    </li>
                    <li>
                        There is no perfect Redis client.
                        <ul>
                            <li>
                                Patch to Kitsure-redis
                            </li>
                        </ul>
                    </li>
                </ul>
                <h2>
                    Accomplishments that I'm proud of
                </h2>
                <ul>
                    <li>
                        no error
                    </li>
                </ul>
                <h2>
                    What I learned
                </h2>
                <ul>
                    <li>
                        Thread safe is very difficult.
                    </li>
                </ul>
                <h2>
                    What's next for Swiftkiq
                </h2>
                <ul>
                    <li>
                        implement retry routine
                    </li>
                </ul>
            </div>
            <div class="" id="built-with">
                <h2>
                    Built With
                </h2>
                <ul class="no-bullet inline-list">
                    <li>
                        <span class="cp-tag">
                            swif
                        </span>
                    </li>
                </ul>
            </div>
            <nav class="app-links section">
                <h2>
                    Try it out
                </h2>
                <ul class="no-bullet" data-role="software-urls">
                    <li>
                        <a href="https://github.com/ainame/Swiftkiq" rel="nofollow" target="_blank" title="https://github.com/ainame/Swiftkiq">
                            <i class="ss-icon ss-link">
                            </i>
                            <span>
                                github.com
                            </span>
                        </a>
                    </li>
                </ul>
            </nav>
        </div>
    </body>
</html>
