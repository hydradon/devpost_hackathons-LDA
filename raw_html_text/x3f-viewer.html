<html>
    <head>
    </head>
    <body>
        <div class="large-9 columns" id="app-details-left">
            <div id="gallery">
                <ul>
                    <li class="text-center">
                        <a data-lightbox="484284" data-title="Screen Shot" href="https://challengepost-s3-challengepost.netdna-ssl.com/photos/production/software_photos/000/484/284/datas/original.png">
                            <img alt="x3f viewer &ndash; screenshot 1" class="software_photo_image image-replacement" onerror="this.onerror=null;this.src='https://devpost-challengepost.netdna-ssl.com/assets/defaults/thumbnail-placeholder-42bcab8d8178b413922ae2877d8b0868.gif';" src="//challengepost-s3-challengepost.netdna-ssl.com/photos/production/software_photos/000/484/284/datas/gallery.jpg">
                        </a>
                        <span class="expand-tag">
                            <i class="fas fa-expand">
                            </i>
                        </span>
                        <p>
                            <i>
                                Screen Shot
                            </i>
                        </p>
                    </li>
                </ul>
            </div>
            <div>
                <h2>
                    Inspiration
                </h2>
                <p>
                    SIGMAのカメラのRawデータフォーマットであるx3fファイルを一覧するMacアプリを作ります。
                </p>
                <h2>
                    What it does
                </h2>
                <p>
                    SIGMAのカメラのRawデータフォーマットのx3fは特殊なため、直接Photoshopなどで読み込むことができません。
SIGMAが公式で提供している現像ソフトSIGMA Photo Proで読み込みTIFFやJpegに書き出すことができますが、かなり動作が重かったり使い勝手が悪いので、できれば使いたくありません。
                </p>
                <p>
                    幸い、x3fファイルをdngに変換するプログラムを公開しているプロジェクトがあります。
                </p>
                <p>
                    <a href="https://github.com/Kalpanika/x3f" rel="nofollow">
                        https://github.com/Kalpanika/x3f
                    </a>
                </p>
                <p>
                    変換操作をGUIで行えるx3f_wrapperというプロジェクトも用意されていますが、画像を見ながら変換したいファイルを選択することができません。変換処理もバックグラウンドで行ってくれないため、これもまた使い勝手の問題があります。
                </p>
                <p>
                    将来的には、x3fの画像を確認しながら選択しdngへ変換することのできるアプリを作りたいですが、今日の時間ではまずx3f内にJpegで保存されているサムネイル画像をリスト表示できるところまで進めたいと思います。
                </p>
                <h2>
                    How I built it
                </h2>
                <p>
                    まずはKalpanika/x3fのリポジトリをforkしました。コードはC言語です。
                </p>
                <p>
                    x3fファイルにはサムネイル画像の表示用にJpegデータも含まれています。これを読み込めば簡単に画像が表示できます。
                </p>
                <p>
                    x3fからサムネイル画像を取得するのに必要な最低限のC言語のコードを、SwiftベースのXcodeプロジェクトにインポートします。
                </p>
                <p>
                    ファイルパスを渡すとx3fのJpegデータをNSDataで取得する関数をC言語で作っておき、Swiftから呼び出せるようにしました。
                </p>
                <p>
                    それができればあとは普通のMacアプリなので、NSTableViewにファイルのリストを表示してNSImageViewに画像を表示できるようにしました。
                </p>
                <p>
                    今回追加したXcodeのプロジェクトはGithubリポジトリの中のx3f_mac_viewerのフォルダの中にあります。さらにその中のSample x3f filesというフォルダの中に、サンプルとして一つだけx3fファイルを入れてあります。（1ファイルで50MBを超えて大きいので一つのみです）
                </p>
                <h2>
                    Challenges I ran into
                </h2>
                <p>
                    普段SwiftもMacのCocoaアプリも書いていないので、１行１行のコードをドキュメントやネットで調べながら書かなくてはいけませんでした。数時間で最低限動く形にしたいこともあって、改善の余地の多いコードやUIになっていると思います。
                </p>
                <h2>
                    Accomplishments that I'm proud of
                </h2>
                <p>
                    二ヶ月くらい前からやりたいことではありましたが後回しにしていたので、手をつけられて良かったのではないかと思います。
                </p>
                <h2>
                    What I learned
                </h2>
                <h2>
                    What's next for x3f viewer
                </h2>
                <p>
                    選択したx3fファイルのdngへの変換処理と、変換処理やJpeg読み込みのバックグラウンド動作。Kalpanika/x3fのコードリーディング。
                </p>
            </div>
            <nav class="app-links section">
                <h2>
                    Try it out
                </h2>
                <ul class="no-bullet" data-role="software-urls">
                    <li>
                        <a href="https://github.com/objective-audio/x3f" rel="nofollow" target="_blank" title="https://github.com/objective-audio/x3f">
                            <i class="ss-icon ss-link">
                            </i>
                            <span>
                                github.com
                            </span>
                        </a>
                    </li>
                </ul>
            </nav>
        </div>
    </body>
</html>
