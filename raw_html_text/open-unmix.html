<html>
    <head>
    </head>
    <body>
        <div class="large-9 columns" id="app-details-left">
            <div id="gallery">
                <ul>
                    <li>
                        <div class="flex-video">
                            <iframe allowfullscreen="allowfullscreen" allowscriptaccess="always" class="video-embed" frameborder="0" height="371" mode="transparent" src="https://www.youtube.com/embed/u3vXKeaEOqE?enablejsapi=1&amp;hl=en_US&amp;rel=0&amp;start=&amp;version=3&amp;wmode=transparent" type="text/html" webkitallowfullscreen="true" width="660" wmode="transparent">
                            </iframe>
                        </div>
                    </li>
                    <li class="text-center">
                        <a data-lightbox="844809" data-title="end-to-end source separation with Pytorch" href="https://challengepost-s3-challengepost.netdna-ssl.com/photos/production/software_photos/000/844/809/datas/original.jpg">
                            <img alt="Open-Unmix &ndash; screenshot 1" class="software_photo_image image-replacement" onerror="this.onerror=null;this.src='https://devpost-challengepost.netdna-ssl.com/assets/defaults/thumbnail-placeholder-42bcab8d8178b413922ae2877d8b0868.gif';" src="//challengepost-s3-challengepost.netdna-ssl.com/photos/production/software_photos/000/844/809/datas/gallery.jpg">
                        </a>
                        <span class="expand-tag">
                            <i class="fas fa-expand">
                            </i>
                        </span>
                        <p>
                            <i>
                                end-to-end source separation with Pytorch
                            </i>
                        </p>
                    </li>
                    <li class="text-center">
                        <a data-lightbox="844811" data-title="The kind of results we obtain when demixing music" href="https://challengepost-s3-challengepost.netdna-ssl.com/photos/production/software_photos/000/844/811/datas/original.png">
                            <img alt="Open-Unmix &ndash; screenshot 2" class="software_photo_image image-replacement" onerror="this.onerror=null;this.src='https://devpost-challengepost.netdna-ssl.com/assets/defaults/thumbnail-placeholder-42bcab8d8178b413922ae2877d8b0868.gif';" src="//challengepost-s3-challengepost.netdna-ssl.com/photos/production/software_photos/000/844/811/datas/gallery.jpg">
                        </a>
                        <span class="expand-tag">
                            <i class="fas fa-expand">
                            </i>
                        </span>
                        <p>
                            <i>
                                The kind of results we obtain when demixing music
                            </i>
                        </p>
                    </li>
                </ul>
            </div>
            <div>
                <h2>
                    Inspiration
                </h2>
                <p>
                    In our team at Inria, we are working on
                    <strong>
                        music unmixing
                    </strong>
                    . This means getting back the individual instruments from any stereo recording, like the vocals, the drums, the bass, etc. Music unmixing has many applications, especially for the music lovers that want to make covers of their favorite tracks!
                </p>
                <p>
                    We've been working on it for quite a while now, and thanks to deep learning, great progress has been made in music unmixing and Pytorch is the framework we use daily for our research because it allows great flexibility, is powerful and is just a pleasure to work with.
                </p>
                <p>
                    Recently, we published an MIT-license project called
                    <a href="https://github.com/sigsep/open-unmix-pytorch" rel="nofollow">
                        open-unmix
                    </a>
                    that is fully written in torch and that brings state-of-the-art separation to our fellow researchers as well as to the (geeky for now) users.
                </p>
                <p>
                    We are very happy with this recent release, but
                    <strong>
                        it had several drawbacks
                    </strong>
                    , that can be summarized as some signal processing parts were written in
                    <code>
                        numpy
                    </code>
                    , because torch does not (yet?) support complex algebra natively.
                </p>
                <p>
                    However, we had the pleasure to see that the pytorch dev team takes audio
                    <em>
                        very seriously
                    </em>
                    and the whole
                    <code>
                        torchaudio
                    </code>
                    library now brings audio to pytorch users. Also, the amazing
                    <code>
                        torch.hub
                    </code>
                    makes it possible to load our models in one line of code. However, the process was still cumbersome, because not the whole pipeline was in pytorch, due to the numpy parts.
                </p>
                <h2>
                    What it does
                </h2>
                <p>
                    For the hackathon, we implemented in Pytorch the whole signal processing pipeline doing the delicate filtering of audio to get the actual separated waveforms. To do this, we exploited recently proposed features from
                    <code>
                        torchaudio
                    </code>
                    to go back to the separated signals directly and implemented the rest ourselves.
                </p>
                <p>
                    As a result, we are happy to release a new
                    <code>
                        torch.Module
                    </code>
                    called the
                    <code>
                        Separator
                    </code>
                    , that:
                </p>
                <ul>
                    <li>
                        encapsulates everything needed to separate audio signals
                    </li>
                    <li>
                        is differentiable, so that we can do training directly in the time domain! We believe this opens up very nice research directions.
                    </li>
                </ul>
                <h2>
                    How we built it
                </h2>
                <p>
                    <code>
                        Open-unmix
                    </code>
                    has been a very hard work to release, notably because we had to do some research on how to fight overfit and tune our models. 
Still, we were lucky we chose Pytorch for this because it significantly accelerated the whole process.
                </p>
                <p>
                    Now, the
                    <code>
                        torchfilters
                    </code>
                    branch of
                    <code>
                        Open-unmix
                    </code>
                    , which is the object of this submission to the hackathon, exploits many remarkable features of Pytorch:
                </p>
                <ul>
                    <li>
                        <code>
                            torchaudio
                        </code>
                        very effective dataloaders, inverse STFT and resampler.
                    </li>
                    <li>
                        The flawless implementations of the classical BLSTM recurrent layers.
                    </li>
                    <li>
                        Many off-the-shelf optimization algorithms and training tricks, as well as the straightforward way you implement training loops which you can debug.
                    </li>
                    <li>
                        <code>
                            torch.hub
                        </code>
                        is an extraordinary attempt at promoting reproducible research. Since it was pretty easy to setup, we added a hub support to our new
                        <code>
                            Separator
                        </code>
                        module.
                    </li>
                </ul>
                <h2>
                    Challenges we ran into
                </h2>
                <p>
                    The hardest part of going end-to-end in Pytorch was to implement the complicated stereo Wiener filtering and Expectation-Maximization algorithms that are necessary to obtain state-of-the-art performance. While we made them all available for the users in a
                    <a href="https://github.com/sigsep/norbert" rel="nofollow">
                        dedicated numpy toolbox
                    </a>
                    , implementing the most delicate parts in torch was not easy. This is mainly because these all operations are performed on complex numbers, and torch does not yet support complex algebra natively.
                </p>
                <p>
                    However, thanks to the way you build a Pytorch application, we could debug every part of it and optimize the code to finally even get smaller memory usage and faster computations than with the
                    <code>
                        numpy
                    </code>
                    version.
                </p>
                <h2>
                    Accomplishments that we're proud of
                </h2>
                <p>
                    We believe that the coolest part of our submission is that everything about the system is full-torch, which means we can benefit for the great production features that the Pytorch dev team has already created (notably
                    <code>
                        torch.hub
                    </code>
                    ) but also any other one that may come in the future.
                </p>
                <h2>
                    What we learned
                </h2>
                <p>
                    Pytorch is a community-based thing, and we are glad that the audio people got into it by creating the features of
                    <code>
                        torchaudio
                    </code>
                    .
                </p>
                <p>
                    The take-home message for us is that taking action in this and contributing through our somehow narrow expertise on audio processing can have an impact in the larger plan of a big-sized project like Pytorch, and we are happy about it.
                </p>
                <h2>
                    What's next for Open-Unmix
                </h2>
                <p>
                    We hope that the end-to-end separation system we come up with through this submission will:
                </p>
                <ul>
                    <li>
                        raise some interest for this fascinating topic of source separation and what we believe are its extraordinary applications in terms of artistic creativity.
                    </li>
                    <li>
                        raise new interesting research questions. In particular, having a module that's an end-to-end differentiable separator makes it possible to directly train models in the time domain. Then, if the objective is to plug some other process down the line of the
                        <code>
                            Separator
                        </code>
                        (such as lyrics recognition or polyphonic transcription networks), an end-to-end training may be imagined where separation is also trained on the way.
                    </li>
                </ul>
            </div>
            <div class="" id="built-with">
                <h2>
                    Built With
                </h2>
                <ul class="no-bullet inline-list">
                    <li>
                        <span class="cp-tag recognized-tag">
                            <a href="https://devpost.com/software/built-with/pytorch">
                                pytorch
                            </a>
                        </span>
                    </li>
                    <li>
                        <span class="cp-tag">
                            torchaudio
                        </span>
                    </li>
                    <li>
                        <span class="cp-tag">
                            torchhub
                        </span>
                    </li>
                </ul>
            </div>
            <nav class="app-links section">
                <h2>
                    Try it out
                </h2>
                <ul class="no-bullet" data-role="software-urls">
                    <li>
                        <a href="https://frama.link/torchmeup" rel="nofollow" target="_blank" title="https://frama.link/torchmeup">
                            <i class="ss-icon ss-link">
                            </i>
                            <span>
                                frama.link
                            </span>
                        </a>
                    </li>
                    <li>
                        <a href="https://github.com/sigsep/open-unmix-pytorch/tree/torchfilters" rel="nofollow" target="_blank" title="https://github.com/sigsep/open-unmix-pytorch/tree/torchfilters">
                            <i class="ss-icon ss-link">
                            </i>
                            <span>
                                github.com
                            </span>
                        </a>
                    </li>
                    <li>
                        <a href="https://open.unmix.app" rel="nofollow" target="_blank" title="https://open.unmix.app">
                            <i class="ss-icon ss-link">
                            </i>
                            <span>
                                open.unmix.app
                            </span>
                        </a>
                    </li>
                    <li>
                        <a href="https://colab.research.google.com/drive/1YlIrJ7kVFJlnyPW7IgWOhKt824kPGRqo" rel="nofollow" target="_blank" title="https://colab.research.google.com/drive/1YlIrJ7kVFJlnyPW7IgWOhKt824kPGRqo">
                            <i class="ss-icon ss-link">
                            </i>
                            <span>
                                colab.research.google.com
                            </span>
                        </a>
                    </li>
                </ul>
            </nav>
        </div>
    </body>
</html>
