[
    {
        "url": "https://api.github.com/repos/curiousYi/globalhack6/pulls/comments/84587602",
        "pull_request_review_id": 5358373,
        "id": 84587602,
        "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDg0NTg3NjAy",
        "diff_hunk": "@@ -0,0 +1,229 @@\n+var pdfFillForm = require('pdf-fill-form');\n+var fs = require('fs');\n+var pdfFillObj = {};\n+var clientObj;\n+var xlsx = require('xlsx');\n+\n+// var db = require('./server/models/index').db;\n+// var Client = require('./server/models/index').Client;\n+\n+var workbook = xlsx.readFile('sd.xlsx');\n+\n+var allClientData = xlsx.utils.sheet_to_json(workbook.Sheets[workbook.SheetNames[0]], {raw: true});\n+\n+\n+function getJsDateFromExcel(excelDate) {\n+\n+// JavaScript dates can be constructed by passing milliseconds\n+// since the Unix epoch (January 1, 1970) example: new Date(12312512312);\n+\n+// 1. Subtract number of days between Jan 1, 1900 and Jan 1, 1970, plus 1 (Google \"excel leap year bug\")\n+// 2. Convert to milliseconds.\n+\n+return new Date((excelDate - (25567 + 2))*86400*1000);\n+\n+}\n+\n+\n+// console.log(allClientData);\n+// get Client UUID\n+// look up data via UUID\n+// hard code 90077 for now\n+allClientData.forEach(client => {\n+  if(client.UUID == 90077){\n+    clientObj = client;\n+    // console.log(client);\n+  }\n+})\n+console.log(clientObj);\n+\n+// reading data\n+pdfFillForm.read('birthdeathwithTextFields.pdf')\n+.then(res => {\n+  console.log(res);\n+  res.forEach(field => {\n+    console.log(field);\n+    // for each field in the pdf form, look in the database to see if there's relevant info\n+        if(field.name.toLowerCase() === 'undefined'){\n+          pdfFillObj[field.name] = true;\n+        }\n+        else if(field.name.toLowerCase() === 'number of copies'){\n+          pdfFillObj[field.name] = 1;\n+        }\n+        else if(field.name.toLowerCase() === 'full name on certificate'){\n+            pdfFillObj[field.name] = clientObj.First_Name + ' ' + clientObj.Middle_Name + ' ' + clientObj.Last_Name;\n+        }\n+        else if(field.name.toLowerCase() === 'date of birth'){\n+            var clientDOB = new Date(getJsDateFromExcel(clientObj.DOB)).toISOString()\n+            pdfFillObj[field.name] = clientDOB.slice(5, 7) + '/' + clientDOB.slice(8, 10) +  '/' + clientDOB.slice(0, 4);\n+        }\n+        else if(field.name.toLowerCase() === 'place of birth county state'){\n+          if(clientObj.Birth_City && clientObj.Birth_State){\n+            pdfFillObj[field.name] = clientObj.Birth_City + ', ' +  clientObj.Birth_State\n+          }\n+        }\n+        else if(field.name.toLowerCase() === 'sex'){\n+            if(clientObj.Gender === 0 && field.id === 65545){\n+                pdfFillObj[field.name] = true;\n+            }else if(clientObj.Gender === 1 && field.id === 65546){\n+                pdfFillObj[field.name] = true;\n+            }\n+        }\n+        else if(field.name.toLowerCase() === 'applicants name'){\n+            pdfFillObj[field.name] = clientObj.First_Name + ' ' + clientObj.Middle_Name + ' ' + clientObj.Last_Name;\n+        }\n+        //Using the St. Patrick address for now update/change as necessary Yi Chao\n+        else if(field.name.toLowerCase() === 'applicants street address'){\n+            pdfFillObj[field.name] = '800 N. Tucker Blvd.'\n+        }\n+        else if(field.name.toLowerCase() === 'applicants citytown'){\n+            pdfFillObj[field.name] = 'St. Louis'\n+        }\n+        else if(field.name.toLowerCase() === 'state'){\n+            pdfFillObj[field.name] = 'MO'\n+        }\n+        else if(field.name.toLowerCase() === 'zip'){\n+            pdfFillObj[field.name] = '63101'\n+        }\n+        else if(field.name.toLowerCase() === 'purpose for certificate request'){\n+            pdfFillObj[field.name] = 'Job-hunting'\n+        }\n+        else if(field.name.toLowerCase() === 'date'){\n+            var currentDate = new Date(new Date.getTIme() + 24* 60*60*1000);\n+            pdfFillObj[field.name] = currentDate.getMonth() + 1 + '/' + currentDate.getDate() + '/' + currentDate.getFullYear();\n+        }\n+\n+",
        "path": "birthCertificate.js",
        "position": null,
        "original_position": 96,
        "commit_id": "d885876bd032c7b7f6c5825b4d7804ea9667c100",
        "original_commit_id": "9fda55c5aa9acd0a2136be66b9c3909082a0b928",
        "user": {
            "login": "wjrhee",
            "id": 6262300,
            "node_id": "MDQ6VXNlcjYyNjIzMDA=",
            "avatar_url": "https://avatars3.githubusercontent.com/u/6262300?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/wjrhee",
            "html_url": "https://github.com/wjrhee",
            "followers_url": "https://api.github.com/users/wjrhee/followers",
            "following_url": "https://api.github.com/users/wjrhee/following{/other_user}",
            "gists_url": "https://api.github.com/users/wjrhee/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/wjrhee/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/wjrhee/subscriptions",
            "organizations_url": "https://api.github.com/users/wjrhee/orgs",
            "repos_url": "https://api.github.com/users/wjrhee/repos",
            "events_url": "https://api.github.com/users/wjrhee/events{/privacy}",
            "received_events_url": "https://api.github.com/users/wjrhee/received_events",
            "type": "User",
            "site_admin": false
        },
        "body": "delete the commented code\n",
        "created_at": "2016-10-23T00:14:44Z",
        "updated_at": "2016-10-23T00:33:18Z",
        "html_url": "https://github.com/curiousYi/globalhack6/pull/7#discussion_r84587602",
        "pull_request_url": "https://api.github.com/repos/curiousYi/globalhack6/pulls/7",
        "author_association": "COLLABORATOR",
        "_links": {
            "self": {
                "href": "https://api.github.com/repos/curiousYi/globalhack6/pulls/comments/84587602"
            },
            "html": {
                "href": "https://github.com/curiousYi/globalhack6/pull/7#discussion_r84587602"
            },
            "pull_request": {
                "href": "https://api.github.com/repos/curiousYi/globalhack6/pulls/7"
            }
        }
    }
]