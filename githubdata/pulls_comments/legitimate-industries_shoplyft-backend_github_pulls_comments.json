[
    {
        "url": "https://api.github.com/repos/Legitimate-Industries/shoplyft-backend/pulls/comments/226851315",
        "pull_request_review_id": 166773779,
        "id": 226851315,
        "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIyNjg1MTMxNQ==",
        "diff_hunk": "@@ -1,7 +1,24 @@\n package com.legindus.shoplyft;\n \n+import com.legindus.shoplyft.firebase.FirebaseRegistry;\n+\n public class Main {\n-    public static void main(String[] args) {\n-        \n+    private FirebaseRegistry registry;\n+\n+    public final static Object lock = new Object();\n+    public static volatile boolean die = false;\n+\n+    public Main() throws InterruptedException {\n+        registry = new FirebaseRegistry();\n+\n+        while (!die) {\n+            synchronized (lock) {\n+                lock.wait();\n+            }\n+        }\n+    }\n+\n+    public static void main(String[] args) throws InterruptedException {\n+        new Main();",
        "path": "src/main/java/com/legindus/shoplyft/Main.java",
        "position": null,
        "original_position": 24,
        "commit_id": "1e3a4c72ee622d655e987c388592340a2e39cfa9",
        "original_commit_id": "1cf2eb30c03659c596df1a70f2aaf37bbb817edd",
        "user": {
            "login": "kirbyquerby",
            "id": 6455350,
            "node_id": "MDQ6VXNlcjY0NTUzNTA=",
            "avatar_url": "https://avatars3.githubusercontent.com/u/6455350?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/kirbyquerby",
            "html_url": "https://github.com/kirbyquerby",
            "followers_url": "https://api.github.com/users/kirbyquerby/followers",
            "following_url": "https://api.github.com/users/kirbyquerby/following{/other_user}",
            "gists_url": "https://api.github.com/users/kirbyquerby/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/kirbyquerby/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/kirbyquerby/subscriptions",
            "organizations_url": "https://api.github.com/users/kirbyquerby/orgs",
            "repos_url": "https://api.github.com/users/kirbyquerby/repos",
            "events_url": "https://api.github.com/users/kirbyquerby/events{/privacy}",
            "received_events_url": "https://api.github.com/users/kirbyquerby/received_events",
            "type": "User",
            "site_admin": false
        },
        "body": "Can't you just put the main method code in here?",
        "created_at": "2018-10-21T07:24:07Z",
        "updated_at": "2018-10-21T08:04:59Z",
        "html_url": "https://github.com/Legitimate-Industries/shoplyft-backend/pull/5#discussion_r226851315",
        "pull_request_url": "https://api.github.com/repos/Legitimate-Industries/shoplyft-backend/pulls/5",
        "author_association": "COLLABORATOR",
        "_links": {
            "self": {
                "href": "https://api.github.com/repos/Legitimate-Industries/shoplyft-backend/pulls/comments/226851315"
            },
            "html": {
                "href": "https://github.com/Legitimate-Industries/shoplyft-backend/pull/5#discussion_r226851315"
            },
            "pull_request": {
                "href": "https://api.github.com/repos/Legitimate-Industries/shoplyft-backend/pulls/5"
            }
        }
    },
    {
        "url": "https://api.github.com/repos/Legitimate-Industries/shoplyft-backend/pulls/comments/226851358",
        "pull_request_review_id": 166773779,
        "id": 226851358,
        "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIyNjg1MTM1OA==",
        "diff_hunk": "@@ -0,0 +1,106 @@\n+package com.legindus.shoplyft.firebase;\n+\n+import com.google.firebase.database.DataSnapshot;\n+import com.google.firebase.database.DatabaseError;\n+import com.google.firebase.database.DatabaseReference;\n+import com.google.firebase.database.ValueEventListener;\n+import com.legindus.shoplyft.firebase.database.Firebase;\n+import com.legindus.shoplyft.firebase.listeners.ChildAddedListener;\n+import com.legindus.shoplyft.firebase.models.CategoryDocument;\n+import com.legindus.shoplyft.firebase.models.Query;\n+import org.slf4j.Logger;\n+import org.slf4j.LoggerFactory;\n+\n+import javax.annotation.Nullable;\n+import java.util.ArrayList;\n+import java.util.List;\n+import java.util.concurrent.CompletableFuture;\n+import java.util.concurrent.ExecutionException;\n+import java.util.concurrent.atomic.AtomicInteger;\n+\n+public class FirebaseRegistry {\n+    private Logger LOG = LoggerFactory.getLogger(FirebaseRegistry.class);\n+    private Firebase firebase;\n+\n+    public FirebaseRegistry() {\n+        firebase = new Firebase();\n+    }\n+\n+    @Nullable\n+    public List<CategoryDocument> getDocs() throws ExecutionException, InterruptedException {\n+        List<CategoryDocument> docs = new ArrayList<>();\n+\n+        CompletableFuture<Integer> count = new CompletableFuture<>();\n+        firebase.getFDatabase().getReference().child(\"numCategories\").addListenerForSingleValueEvent(new ValueEventListener() {\n+            @Override\n+            public void onDataChange(DataSnapshot snapshot) {\n+                int ct = snapshot.getValue(Integer.class);\n+                count.complete(ct);\n+            }\n+\n+            @Override\n+            public void onCancelled(DatabaseError error) {\n+                LOG.error(\"Firebase grab cancelled: \", error);\n+            }\n+        });\n+\n+        int ct = count.get();\n+        CompletableFuture<List<CategoryDocument>> listFuture = new CompletableFuture<>();\n+        AtomicInteger numReceived = new AtomicInteger(0);\n+        firebase.getFDatabase().getReference(\"categories\").addChildEventListener(new ChildAddedListener() {\n+            @Override\n+            public void onChildAdded(DataSnapshot snapshot, String previousChildName) {\n+                CategoryDocument document = snapshot.getValue(CategoryDocument.class);\n+                int res = numReceived.incrementAndGet();\n+                docs.add(document);\n+\n+                if (res == ct)\n+                    listFuture.complete(docs);\n+            }\n+        });\n+\n+        return listFuture.get();\n+    }\n+\n+    @Nullable\n+    public Query getQuery(String id) throws ExecutionException, InterruptedException {\n+        CompletableFuture<Query> future = new CompletableFuture<>();\n+        firebase.getFDatabase().getReference(\"queries\").addChildEventListener(new ChildAddedListener() {\n+            @Override\n+            public void onChildAdded(DataSnapshot snapshot, String previousChildName) {\n+                if (snapshot.getKey().equals(id))\n+                    future.complete(snapshot.getValue(Query.class));\n+            }\n+        });\n+\n+        return future.get();\n+    }\n+\n+    public void newQuery(Query query, String id) {\n+        firebase.getFDatabase().getReference(\"queries\").child(id).setValueAsync(query);\n+    }\n+\n+    public void updateQuery(Query newQuery, String id) {",
        "path": "src/main/java/com/legindus/shoplyft/firebase/FirebaseRegistry.java",
        "position": 128,
        "original_position": 83,
        "commit_id": "1e3a4c72ee622d655e987c388592340a2e39cfa9",
        "original_commit_id": "1cf2eb30c03659c596df1a70f2aaf37bbb817edd",
        "user": {
            "login": "kirbyquerby",
            "id": 6455350,
            "node_id": "MDQ6VXNlcjY0NTUzNTA=",
            "avatar_url": "https://avatars3.githubusercontent.com/u/6455350?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/kirbyquerby",
            "html_url": "https://github.com/kirbyquerby",
            "followers_url": "https://api.github.com/users/kirbyquerby/followers",
            "following_url": "https://api.github.com/users/kirbyquerby/following{/other_user}",
            "gists_url": "https://api.github.com/users/kirbyquerby/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/kirbyquerby/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/kirbyquerby/subscriptions",
            "organizations_url": "https://api.github.com/users/kirbyquerby/orgs",
            "repos_url": "https://api.github.com/users/kirbyquerby/repos",
            "events_url": "https://api.github.com/users/kirbyquerby/events{/privacy}",
            "received_events_url": "https://api.github.com/users/kirbyquerby/received_events",
            "type": "User",
            "site_admin": false
        },
        "body": "Can you add javadoc to these methods?",
        "created_at": "2018-10-21T07:26:21Z",
        "updated_at": "2018-10-21T08:04:59Z",
        "html_url": "https://github.com/Legitimate-Industries/shoplyft-backend/pull/5#discussion_r226851358",
        "pull_request_url": "https://api.github.com/repos/Legitimate-Industries/shoplyft-backend/pulls/5",
        "author_association": "COLLABORATOR",
        "_links": {
            "self": {
                "href": "https://api.github.com/repos/Legitimate-Industries/shoplyft-backend/pulls/comments/226851358"
            },
            "html": {
                "href": "https://github.com/Legitimate-Industries/shoplyft-backend/pull/5#discussion_r226851358"
            },
            "pull_request": {
                "href": "https://api.github.com/repos/Legitimate-Industries/shoplyft-backend/pulls/5"
            }
        }
    },
    {
        "url": "https://api.github.com/repos/Legitimate-Industries/shoplyft-backend/pulls/comments/226851449",
        "pull_request_review_id": 166773779,
        "id": 226851449,
        "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIyNjg1MTQ0OQ==",
        "diff_hunk": "@@ -0,0 +1,7 @@\n+package com.legindus.shoplyft.firebase.utils;\n+\n+public class Status {",
        "path": "src/main/java/com/legindus/shoplyft/firebase/utils/Status.java",
        "position": 3,
        "original_position": 3,
        "commit_id": "1e3a4c72ee622d655e987c388592340a2e39cfa9",
        "original_commit_id": "1cf2eb30c03659c596df1a70f2aaf37bbb817edd",
        "user": {
            "login": "kirbyquerby",
            "id": 6455350,
            "node_id": "MDQ6VXNlcjY0NTUzNTA=",
            "avatar_url": "https://avatars3.githubusercontent.com/u/6455350?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/kirbyquerby",
            "html_url": "https://github.com/kirbyquerby",
            "followers_url": "https://api.github.com/users/kirbyquerby/followers",
            "following_url": "https://api.github.com/users/kirbyquerby/following{/other_user}",
            "gists_url": "https://api.github.com/users/kirbyquerby/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/kirbyquerby/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/kirbyquerby/subscriptions",
            "organizations_url": "https://api.github.com/users/kirbyquerby/orgs",
            "repos_url": "https://api.github.com/users/kirbyquerby/repos",
            "events_url": "https://api.github.com/users/kirbyquerby/events{/privacy}",
            "received_events_url": "https://api.github.com/users/kirbyquerby/received_events",
            "type": "User",
            "site_admin": false
        },
        "body": "consider using an enum",
        "created_at": "2018-10-21T07:29:39Z",
        "updated_at": "2018-10-21T08:04:59Z",
        "html_url": "https://github.com/Legitimate-Industries/shoplyft-backend/pull/5#discussion_r226851449",
        "pull_request_url": "https://api.github.com/repos/Legitimate-Industries/shoplyft-backend/pulls/5",
        "author_association": "COLLABORATOR",
        "_links": {
            "self": {
                "href": "https://api.github.com/repos/Legitimate-Industries/shoplyft-backend/pulls/comments/226851449"
            },
            "html": {
                "href": "https://github.com/Legitimate-Industries/shoplyft-backend/pull/5#discussion_r226851449"
            },
            "pull_request": {
                "href": "https://api.github.com/repos/Legitimate-Industries/shoplyft-backend/pulls/5"
            }
        }
    }
]